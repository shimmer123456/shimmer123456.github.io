<!DOCTYPE html><html lang="zh"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>W4ntY0u每日训练 | shimmer's blog</title><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"键入以继续","blurHolder":"数据检索","noResult":"无 $0 相关数据"},"code":{"codeInfo":"$0 共 $1 行","copy":"复制","copyFinish":"完成","expand":"展开"}}</script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><script>mermaid.initialize({
 startOnLoad: true
 , theme: 'dark'
});</script><link rel="stylesheet" href="/css/arknights.css"><link rel="stylesheet" href="//unpkg.com/@highlightjs/cdn-assets@11.6.0/styles/atom-one-dark-reasonable.min.css"><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><meta name="generator" content="Hexo 6.3.0"></head><body style="background-image:url(https://cn.bing.com/images/search?view=detailV2&amp;ccid=TVpjI8NL&amp;id=D2C1633A096C6B1388F0875A2B98B2AF9425B113&amp;thid=OIP.TVpjI8NL0wfxmT4_2OKOAAHaEK&amp;mediaurl=https%3a%2f%2fimg-u-0.51miz.com%2fVideo%2f2017%2f08%2f07%2f17%2f20170807173546_V106868_c06717c6.jpg&amp;exph=963&amp;expw=1712&amp;q=%e5%9b%bd%e6%97%97%e5%9b%be%e7%89%87&amp;simid=608006342772601379&amp;FORM=IRPRST&amp;ck=C52811B75274FAD8DA77029CE3C38AE5&amp;selectedIndex=21&amp;ajaxhist=0&amp;ajaxserp=0);"><main><header class="closed"><nav><div class="navBtn hide"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><ol class="navContent"><li class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="数据检索" spellcheck="false" maxlength="50" type="text" id="search-input"></span></li><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li></ol></nav><div class="search-popup"><div id="search-result"></div></div></header><article><div id="post-bg"><div id="post-title"><h1>W4ntY0u每日训练</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2023-05-03T00:03:12.000Z" id="date"> 2023-05-03</time></div></span><br><span>Last Update: <div class="control"><time datetime="2023-06-23T12:35:49.557Z" id="updated"> 2023-06-23</time></div></span></div></div><hr><div id="post-content"><h3 id="5-3"><a href="#5-3" class="headerlink" title="5.3"></a>5.3</h3><h4 id="xctf：流浪者"><a href="#xctf：流浪者" class="headerlink" title="xctf：流浪者"></a>xctf：流浪者</h4><p>一道mfc的逆向，ida打开，利用字符串定位关键函数</p>
<p><img src="https://raw.githubusercontent.com/shimmer123456/img/main/img/202305032022463.png" alt="image-20230503202224316"></p>
<p>定位到sub_4017F0函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">sub_4017F0</span><span class="hljs-params">(<span class="hljs-type">int</span> a1)</span><br>&#123;<br>  <span class="hljs-type">char</span> Str1[<span class="hljs-number">28</span>]; <span class="hljs-comment">// [esp+D8h] [ebp-24h] BYREF</span><br>  <span class="hljs-type">int</span> v3; <span class="hljs-comment">// [esp+F4h] [ebp-8h]</span><br>  <span class="hljs-type">int</span> v4; <span class="hljs-comment">// [esp+F8h] [ebp-4h]</span><br><br>  v4 = <span class="hljs-number">0</span>;<br>  v3 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">while</span> ( *(a1 + <span class="hljs-number">4</span> * v4) &lt;= <span class="hljs-number">0x3D</span>u )<br>  &#123;<br>    Str1[v4] = aAbcdefghiabcde[*(a1 + <span class="hljs-number">4</span> * v4)];<br>    ++v4;<br>  &#125;<br>  Str1[v4] = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">strcmp</span>(Str1, <span class="hljs-string">&quot;KanXueCTF2019JustForhappy&quot;</span>) )<br>    <span class="hljs-keyword">return</span> sub_401770();<br>  <span class="hljs-keyword">else</span><br>    <span class="hljs-keyword">return</span> sub_4017B0();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>主要逻辑就是一个置换加密，再交叉引用查看谁调用了他</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __thiscall <span class="hljs-title function_">sub_401890</span><span class="hljs-params">(CWnd *this)</span><br>&#123;<br>  CWnd *DlgItem; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v2; <span class="hljs-comment">// eax</span><br>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">CString</span> *<span class="hljs-title">v4</span>;</span> <span class="hljs-comment">// [esp-4h] [ebp-C4h]</span><br>  <span class="hljs-type">int</span> v5[<span class="hljs-number">26</span>]; <span class="hljs-comment">// [esp+4Ch] [ebp-74h] BYREF</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [esp+B4h] [ebp-Ch]</span><br>  <span class="hljs-type">char</span> *Str; <span class="hljs-comment">// [esp+B8h] [ebp-8h]</span><br>  CWnd *v8; <span class="hljs-comment">// [esp+BCh] [ebp-4h]</span><br><br>  v8 = this;<br>  v4 = (this + <span class="hljs-number">100</span>);<br>  DlgItem = CWnd::GetDlgItem(this, <span class="hljs-number">1002</span>);<br>  CWnd::GetWindowTextA(DlgItem, v4);<br>  v2 = sub_401A30(v8 + <span class="hljs-number">100</span>);<br>  Str = CString::GetBuffer((v8 + <span class="hljs-number">100</span>), v2);<br>  <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">strlen</span>(Str) )<br>    <span class="hljs-keyword">return</span> CWnd::MessageBoxA(v8, &amp;byte_4035DC, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; Str[i]; ++i )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( Str[i] &gt; <span class="hljs-string">&#x27;9&#x27;</span> || Str[i] &lt; <span class="hljs-string">&#x27;0&#x27;</span> )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( Str[i] &gt; <span class="hljs-string">&#x27;z&#x27;</span> || Str[i] &lt; <span class="hljs-string">&#x27;a&#x27;</span> )<br>      &#123;<br>        <span class="hljs-keyword">if</span> ( Str[i] &gt; <span class="hljs-string">&#x27;Z&#x27;</span> || Str[i] &lt; <span class="hljs-string">&#x27;A&#x27;</span> )<br>          sub_4017B0();<br>        <span class="hljs-keyword">else</span><br>          v5[i] = Str[i] - <span class="hljs-string">&#x27;\x1D&#x27;</span>;<br>      &#125;<br>      <span class="hljs-keyword">else</span><br>      &#123;<br>        v5[i] = Str[i] - <span class="hljs-string">&#x27;W&#x27;</span>;<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      v5[i] = Str[i] - <span class="hljs-string">&#x27;0&#x27;</span>;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> sub_4017F0(v5);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>可以看到对输入的字符进行了三次判断，如果不在该判断范围内，直接错误</p>
<p>那么逆向脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python">KanXue = <span class="hljs-string">&quot;KanXueCTF2019JustForhappy&quot;</span><br>abcdef = <span class="hljs-string">&quot;abcdefghiABCDEFGHIJKLMNjklmn0123456789opqrstuvwxyzOPQRSTUVWXYZ&quot;</span><br>SomeDwordArray = []<br>Key = <span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(KanXue)):<br>    SomeDwordArray.append(abcdef.find(KanXue[i]))<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;SomeDwordArray =&quot;</span>, SomeDwordArray)<br><br><span class="hljs-keyword">for</span> dw <span class="hljs-keyword">in</span> SomeDwordArray:<br>    <span class="hljs-keyword">if</span> dw &lt;= <span class="hljs-number">9</span> <span class="hljs-keyword">and</span> dw &gt;= <span class="hljs-number">0</span>:<br>        Key += <span class="hljs-built_in">chr</span>(dw + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;0&#x27;</span>))<br>    <span class="hljs-keyword">elif</span> dw + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;W&#x27;</span>) &gt;= <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>) <span class="hljs-keyword">and</span> dw + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;W&#x27;</span>) &lt;= <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;z&#x27;</span>):<br>        Key += <span class="hljs-built_in">chr</span>(dw + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;W&#x27;</span>))<br>    <span class="hljs-keyword">else</span>:<br>        Key += <span class="hljs-built_in">chr</span>(dw + <span class="hljs-number">0x1D</span>)<br><br><span class="hljs-built_in">print</span>(Key)<br><span class="hljs-comment">#j0rXI4bTeustBiIGHeCF70DDM</span><br></code></pre></td></tr></table></figure>

<h4 id="re2-cpp-is-awesome"><a href="#re2-cpp-is-awesome" class="headerlink" title="re2-cpp-is-awesome"></a>re2-cpp-is-awesome</h4><p>main函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> a1, <span class="hljs-type">char</span> **a2, <span class="hljs-type">char</span> **a3)</span><br>&#123;<br>  <span class="hljs-type">char</span> *v3; <span class="hljs-comment">// rbx</span><br>  __int64 v4; <span class="hljs-comment">// rax</span><br>  __int64 v5; <span class="hljs-comment">// rdx</span><br>  __int64 v6; <span class="hljs-comment">// rax</span><br>  __int64 v7; <span class="hljs-comment">// rdx</span><br>  _BYTE *v8; <span class="hljs-comment">// rax</span><br>  __int64 v10[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+10h] [rbp-60h] BYREF</span><br>  <span class="hljs-type">char</span> v11[<span class="hljs-number">47</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-50h] BYREF</span><br>  <span class="hljs-type">char</span> v12; <span class="hljs-comment">// [rsp+4Fh] [rbp-21h] BYREF</span><br>  __int64 v13; <span class="hljs-comment">// [rsp+50h] [rbp-20h] BYREF</span><br>  <span class="hljs-type">int</span> v14; <span class="hljs-comment">// [rsp+5Ch] [rbp-14h]</span><br><br>  <span class="hljs-keyword">if</span> ( a1 != <span class="hljs-number">2</span> )<br>  &#123;<br>    v3 = *a2;<br>    v4 = <span class="hljs-built_in">std</span>::operator&lt;&lt;&lt;<span class="hljs-built_in">std</span>::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;(&amp;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span>, <span class="hljs-string">&quot;Usage: &quot;</span>, a3);<br>    v6 = <span class="hljs-built_in">std</span>::operator&lt;&lt;&lt;<span class="hljs-built_in">std</span>::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;(v4, v3, v5);<br>    <span class="hljs-built_in">std</span>::operator&lt;&lt;&lt;<span class="hljs-built_in">std</span>::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;(v6, <span class="hljs-string">&quot; flag\n&quot;</span>, v7);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>  &#125;<br>  <span class="hljs-built_in">std</span>::allocator&lt;<span class="hljs-type">char</span>&gt;::allocator(&amp;v12, a2, a3);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::basic_string(v11, a2[<span class="hljs-number">1</span>], &amp;v12);<br>  <span class="hljs-built_in">std</span>::allocator&lt;<span class="hljs-type">char</span>&gt;::~allocator(&amp;v12);<br>  v14 = <span class="hljs-number">0</span>;<br>  v10[<span class="hljs-number">0</span>] = <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::begin(v11);<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    v13 = <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::end(v11);<br>    <span class="hljs-keyword">if</span> ( !sub_400D3D(v10, &amp;v13) )<br>      <span class="hljs-keyword">break</span>;<br>    v8 = sub_400D9A(v10);<br>    <span class="hljs-keyword">if</span> ( *v8 != off_6020A0[dword_6020C0[v14]] )<br>      sub_400B56();<br>    ++v14;<br>    sub_400D7A(v10);<br>  &#125;<br>  sub_400B73();<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::~<span class="hljs-built_in">string</span>(v11);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>前面的逻辑还算不少，但是关键是最后的比较，直接用了明文，所以前面就都不用管了，直接逆向最后的比较</p>
<p>先idc爬数据：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-keyword">auto</span> addr = <span class="hljs-number">0x00006020C0</span>;<br><span class="hljs-keyword">auto</span> i = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span>(i; addr+i &lt; <span class="hljs-number">0x060213C</span>; i = i+<span class="hljs-number">4</span>)<br>&#123;<br>	<span class="hljs-built_in">Message</span>(<span class="hljs-string">&quot;%d,&quot;</span>,<span class="hljs-built_in">Byte</span>(addr+i));<br>	<span class="hljs-comment">//PatchByte(addr+i,Byte());</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>脚本：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-type">char</span> a[] = <span class="hljs-string">&quot;L3t_ME_T3ll_Y0u_S0m3th1ng_1mp0rtant_A_&#123;FL4G&#125;_W0nt_b3_3X4ctly_th4t_345y_t0_c4ptur3_H0wev3r_1T_w1ll_b3_C00l_1F_Y0u_g0t_1t&quot;</span>;<br>	<span class="hljs-type">int</span> b[] = &#123; <span class="hljs-number">36</span>,<span class="hljs-number">0</span>,<span class="hljs-number">5</span>,<span class="hljs-number">54</span>,<span class="hljs-number">101</span>,<span class="hljs-number">7</span>,<span class="hljs-number">39</span>,<span class="hljs-number">38</span>,<span class="hljs-number">45</span>,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">0</span>,<span class="hljs-number">13</span>,<span class="hljs-number">86</span>,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">101</span>,<span class="hljs-number">3</span>,<span class="hljs-number">45</span>,<span class="hljs-number">22</span>,<span class="hljs-number">2</span>,<span class="hljs-number">21</span>,<span class="hljs-number">3</span>,<span class="hljs-number">101</span>,<span class="hljs-number">0</span>,<span class="hljs-number">41</span>,<span class="hljs-number">68</span>,<span class="hljs-number">68</span>,<span class="hljs-number">1</span>,<span class="hljs-number">68</span>,<span class="hljs-number">43</span>, &#125;;<br>	<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">31</span>; ++i)<br>	&#123;<br>		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, a[b[i]]);<br>	&#125;<br>	<span class="hljs-keyword">return</span>  <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="5-4"><a href="#5-4" class="headerlink" title="5.4"></a>5.4</h3><h4 id="whats-the-hell-500"><a href="#whats-the-hell-500" class="headerlink" title="whats-the-hell-500"></a>whats-the-hell-500</h4><p>题目直接给了源码了，vs打开：（真抽象）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;somelib.hxx&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdlib&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">error</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;Wrong password&quot;</span> &lt;&lt; std::endl;<br>    std::<span class="hljs-built_in">exit</span>(<span class="hljs-number">-1</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">pow</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> n)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">ret</span><span class="hljs-params">(<span class="hljs-number">1</span>)</span></span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i)<br>        ret *= x;<br>    <span class="hljs-keyword">return</span> ret;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">check_password</span><span class="hljs-params">(std::string&amp; p)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (p.<span class="hljs-built_in">size</span>() != <span class="hljs-number">13</span>)<br>    &#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Password must be 13 characters&quot;</span> &lt;&lt; std::endl;<br>        std::<span class="hljs-built_in">exit</span>(<span class="hljs-number">-1</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">0</span>]+p[<span class="hljs-number">1</span>] != <span class="hljs-built_in">pow</span>(I-----I,<span class="hljs-number">2</span>) * <span class="hljs-built_in">pow</span>(I-----------I,<span class="hljs-number">2</span>) + (I---I)) <span class="hljs-built_in">error</span>();<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">1</span>]+p[<span class="hljs-number">2</span>] != <span class="hljs-built_in">pow</span>(I-------I,<span class="hljs-number">2</span>) * <span class="hljs-built_in">pow</span>(I-----I,<span class="hljs-number">4</span>) - (I---I)) <span class="hljs-built_in">error</span>();<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">0</span>]*p[<span class="hljs-number">2</span>] != (<span class="hljs-built_in">pow</span>(<span class="hljs-built_in">pow</span>(I-------I,<span class="hljs-number">2</span>) * <span class="hljs-built_in">pow</span>(I-----I,<span class="hljs-number">3</span>) - (I---I),<span class="hljs-number">2</span>) - (I-----I)*(I-------I))) <span class="hljs-built_in">error</span>();<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">3</span>]+p[<span class="hljs-number">5</span>] != <span class="hljs-built_in">pow</span>((o-------o<br>                          |       !<br>                          !       !<br>                          !       !<br>                          o-------o).A,<span class="hljs-number">2</span>) * (I-----I)+(I---I)) <span class="hljs-built_in">error</span>();<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">3</span>]+p[<span class="hljs-number">4</span>] != <span class="hljs-built_in">pow</span>((o-----------o<br>                          |           !<br>                          !           !<br>                          !           !<br>                          o-----------o).A,<span class="hljs-number">2</span>)+(I---I)) <span class="hljs-built_in">error</span>();<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">4</span>]*p[<span class="hljs-number">5</span>] != (<span class="hljs-built_in">pow</span>((o-------------o<br>                           |             !<br>                           !             !<br>                           !             !<br>                           o-------------o).A,<span class="hljs-number">2</span>)-(I---I))*(I-----I)*<span class="hljs-built_in">pow</span>(I-------I,<span class="hljs-number">2</span>)) <span class="hljs-built_in">error</span>();<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">7</span>]+p[<span class="hljs-number">8</span>] != (o-----------o<br>                      |L           \<br>                      | L           \<br>                      |  L           \<br>                      |   o-----------o|!<br>                      o   |           !<br>                       L  |           !<br>                        L |           !<br>                         L|           !<br>                          o-----------o).V*<span class="hljs-built_in">pow</span>(I-----I,<span class="hljs-number">2</span>) - <span class="hljs-built_in">pow</span>((o-------o<br>                                                                      |       !<br>                                                                      !       !<br>                                                                      o-------o).A,<span class="hljs-number">2</span>) + (I---I)) <span class="hljs-built_in">error</span>();<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">6</span>]+p[<span class="hljs-number">8</span>] != (o-----------o<br>                      |L           \<br>                      | L           \<br>                      |  L           \<br>                      |   L           \<br>                      |    L           \<br>                      |     o-----------o<br>                      |     !           !<br>                      o     |           !<br>                       L    |           !<br>                        L   |           !<br>                         L  |           !<br>                          L |           !<br>                           L|           !<br>                            o-----------o).V - (I-----I)) <span class="hljs-built_in">error</span>();<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">6</span>]*p[<span class="hljs-number">7</span>] != (o---------------------o<br>                      |L                     \<br>                      | L                     \<br>                      |  L                     \<br>                      |   L                     \<br>                      |    L                     \<br>                      |     L                     \<br>                      |      L                     \<br>                      |       L                     \<br>                      |        o---------------------o<br>                      |        !                     !<br>                      !        !                     !<br>                      o        |                     !<br>                       L       |                     !<br>                        L      |                     !<br>                         L     |                     !<br>                          L    |                     !<br>                           L   |                     !<br>                            L  |                     !<br>                             L |                     !<br>                              L|                     !<br>                               o---------------------o).V*(<span class="hljs-built_in">pow</span>(I-------I,<span class="hljs-number">2</span>) + (I-----I)) + <span class="hljs-built_in">pow</span>(I-----I,<span class="hljs-number">6</span>)) <span class="hljs-built_in">error</span>();<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">9</span>]+p[<span class="hljs-number">10</span>]*p[<span class="hljs-number">11</span>] != (o---------o<br>                             |L         \<br>                             | L         \<br>                             |  L         \<br>                             |   L         \<br>                             |    o---------o<br>                             |    !         !<br>                             !    !         !<br>                             o    |         !<br>                              L   |         !<br>                               L  |         !<br>                                L |         !<br>                                 L|         !<br>                                  o---------o).V*(I-------I)*<span class="hljs-built_in">pow</span>(I-----I,<span class="hljs-number">4</span>)-(I---I)) <span class="hljs-built_in">error</span>();<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">10</span>]+p[<span class="hljs-number">9</span>]*p[<span class="hljs-number">11</span>] != (o-----------o<br>                             |L           \<br>                             | L           \<br>                             |  L           \<br>                             |   L           \<br>                             |    L           \<br>                             |     o-----------o<br>                             |     !           !<br>                             o     |           !<br>                              L    |           !<br>                               L   |           !<br>                                L  |           !<br>                                 L |           !<br>                                  L|           !<br>                                   o-----------o).V*<span class="hljs-built_in">pow</span>(I-------I,<span class="hljs-number">3</span>) - (I-----------I)*((I-----I)*(I-----------I)+(I---I))) <span class="hljs-built_in">error</span>();<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">9</span>]+p[<span class="hljs-number">10</span>] != (o-------------o<br>                       |L             \<br>                       | L             \<br>                       |  L             \<br>                       |   L             \<br>                       |    L             \<br>                       |     o-------------o<br>                       |     !             !<br>                       o     |             !<br>                        L    |             !<br>                         L   |             !<br>                          L  |             !<br>                           L |             !<br>                            L|             !<br>                             o-------------o).V-(I-----------I)) <span class="hljs-built_in">error</span>();<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">12</span>] != <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-built_in">error</span>();<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;Guess passwd&quot;</span> &lt;&lt; std::endl;<br>    std::string password;<br>    std::cin &gt;&gt; password;<br>    <span class="hljs-built_in">check_password</span>(password);<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;Correct password! It&#x27;s your flag, bruh&quot;</span> &lt;&lt; std::endl;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>这个是调用了一个cxx的库，稍微google一下，可以大概了解到那一坨抽象的东西是等于一个数的，要么继续学怎么计算，这个时候gpt-4就挺好用的了（3.5是傻子），得到12个的结果，然后直接爆破：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#0-2</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x7f</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x7f</span>):<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x7f</span>):<br>                <span class="hljs-keyword">if</span> i+j == <span class="hljs-number">101</span> <span class="hljs-keyword">and</span> j+k==<span class="hljs-number">143</span> <span class="hljs-keyword">and</span> i*k==<span class="hljs-number">5035</span>:<br>                        flag += <span class="hljs-built_in">chr</span>(i)+<span class="hljs-built_in">chr</span>(j)+<span class="hljs-built_in">chr</span>(k)<br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[&#x27;</span>+<span class="hljs-built_in">chr</span>(i)+<span class="hljs-built_in">chr</span>(j)+<span class="hljs-built_in">chr</span>(k) + <span class="hljs-string">&#x27;]&#x27;</span>)<br><span class="hljs-comment">#50_     </span><br><span class="hljs-comment">#3-5</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x7f</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x7f</span>):<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x7f</span>):<br>                <span class="hljs-keyword">if</span> i+j == <span class="hljs-number">226</span> <span class="hljs-keyword">and</span> i+k==<span class="hljs-number">163</span> <span class="hljs-keyword">and</span> j*k==<span class="hljs-number">5814</span>:<br>                        flag += <span class="hljs-built_in">chr</span>(i)+<span class="hljs-built_in">chr</span>(j)+<span class="hljs-built_in">chr</span>(k)<br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[&#x27;</span>+<span class="hljs-built_in">chr</span>(i)+<span class="hljs-built_in">chr</span>(j)+<span class="hljs-built_in">chr</span>(k) + <span class="hljs-string">&#x27;]&#x27;</span>)<br><span class="hljs-comment">#pr3</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x7f</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x7f</span>):<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x7f</span>):<br>                <span class="hljs-keyword">if</span> j+k == <span class="hljs-number">205</span> <span class="hljs-keyword">and</span> i+k==<span class="hljs-number">173</span> <span class="hljs-keyword">and</span> i*j==<span class="hljs-number">9744</span>:<br>                        flag += <span class="hljs-built_in">chr</span>(i)+<span class="hljs-built_in">chr</span>(j)+<span class="hljs-built_in">chr</span>(k)<br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[&#x27;</span>+<span class="hljs-built_in">chr</span>(i)+<span class="hljs-built_in">chr</span>(j)+<span class="hljs-built_in">chr</span>(k) + <span class="hljs-string">&#x27;]&#x27;</span>)<br><span class="hljs-comment">#Tty</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x7f</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x7f</span>):<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x7f</span>):<br>                <span class="hljs-keyword">if</span> i+j*k == <span class="hljs-number">5375</span> <span class="hljs-keyword">and</span> j+i*k==<span class="hljs-number">4670</span> <span class="hljs-keyword">and</span> i+j==<span class="hljs-number">205</span>:<br>                        flag += <span class="hljs-built_in">chr</span>(i)+<span class="hljs-built_in">chr</span>(j)+<span class="hljs-built_in">chr</span>(k)<br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[&#x27;</span>+<span class="hljs-built_in">chr</span>(i)+<span class="hljs-built_in">chr</span>(j)+<span class="hljs-built_in">chr</span>(k) + <span class="hljs-string">&#x27;]&#x27;</span>)<br><span class="hljs-comment">#_n0</span><br>flag +=<span class="hljs-string">&#x27;w&#x27;</span><br><span class="hljs-built_in">print</span>(flag)<br><br><br></code></pre></td></tr></table></figure>

<h4 id="easyRE"><a href="#easyRE" class="headerlink" title="easyRE"></a>easyRE</h4><p>main函数：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function">__int64 <span class="hljs-title">sub_4009C6</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>  __int64 result; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+Ch] [rbp-114h]</span><br>  __int64 v2; <span class="hljs-comment">// [rsp+10h] [rbp-110h]</span><br>  __int64 v3; <span class="hljs-comment">// [rsp+18h] [rbp-108h]</span><br>  __int64 v4; <span class="hljs-comment">// [rsp+20h] [rbp-100h]</span><br>  __int64 v5; <span class="hljs-comment">// [rsp+28h] [rbp-F8h]</span><br>  __int64 v6; <span class="hljs-comment">// [rsp+30h] [rbp-F0h]</span><br>  __int64 v7; <span class="hljs-comment">// [rsp+38h] [rbp-E8h]</span><br>  __int64 v8; <span class="hljs-comment">// [rsp+40h] [rbp-E0h]</span><br>  __int64 v9; <span class="hljs-comment">// [rsp+48h] [rbp-D8h]</span><br>  __int64 v10; <span class="hljs-comment">// [rsp+50h] [rbp-D0h]</span><br>  __int64 v11; <span class="hljs-comment">// [rsp+58h] [rbp-C8h]</span><br>  <span class="hljs-type">char</span> v12[<span class="hljs-number">13</span>]; <span class="hljs-comment">// [rsp+60h] [rbp-C0h] BYREF</span><br>  <span class="hljs-type">char</span> v13[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+6Dh] [rbp-B3h] BYREF</span><br>  <span class="hljs-type">char</span> v14[<span class="hljs-number">19</span>]; <span class="hljs-comment">// [rsp+71h] [rbp-AFh] BYREF</span><br>  <span class="hljs-type">char</span> v15[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+90h] [rbp-90h] BYREF</span><br>  <span class="hljs-type">int</span> v16; <span class="hljs-comment">// [rsp+B0h] [rbp-70h]</span><br>  <span class="hljs-type">char</span> v17; <span class="hljs-comment">// [rsp+B4h] [rbp-6Ch]</span><br>  <span class="hljs-type">char</span> v18[<span class="hljs-number">72</span>]; <span class="hljs-comment">// [rsp+C0h] [rbp-60h] BYREF</span><br>  <span class="hljs-type">unsigned</span> __int64 v19; <span class="hljs-comment">// [rsp+108h] [rbp-18h]</span><br><br>  v19 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>  <span class="hljs-built_in">qmemcpy</span>(v12, <span class="hljs-string">&quot;Iodl&gt;Qnb(ocy&quot;</span>, <span class="hljs-number">12</span>);<br>  v12[<span class="hljs-number">12</span>] = <span class="hljs-number">127</span>;<br>  <span class="hljs-built_in">qmemcpy</span>(v13, <span class="hljs-string">&quot;y.i&quot;</span>, <span class="hljs-number">3</span>);<br>  v13[<span class="hljs-number">3</span>] = <span class="hljs-number">127</span>;<br>  <span class="hljs-built_in">qmemcpy</span>(v14, <span class="hljs-string">&quot;d`3w&#125;wek9&#123;iy=~yL@EC&quot;</span>, <span class="hljs-built_in">sizeof</span>(v14));<br>  <span class="hljs-built_in">memset</span>(v15, <span class="hljs-number">0</span>, <span class="hljs-built_in">sizeof</span>(v15));<br>  v16 = <span class="hljs-number">0</span>;<br>  v17 = <span class="hljs-number">0</span>;<br>  <span class="hljs-built_in">sub_4406E0</span>(<span class="hljs-number">0</span>, v15, <span class="hljs-number">37LL</span>);<br>  v17 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">if</span> ( (sub_424BA0)(v15) == <span class="hljs-number">36</span> )<br>  &#123;<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; (sub_424BA0)(v15); ++i )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( (v15[i] ^ i) != v12[i] )<br>      &#123;<br>        result = <span class="hljs-number">4294967294LL</span>;<br>        <span class="hljs-keyword">goto</span> LABEL_13;<br>      &#125;<br>    &#125;<br>    <span class="hljs-built_in">sub_410CC0</span>(<span class="hljs-string">&quot;continue!&quot;</span>);<br>    <span class="hljs-built_in">memset</span>(v18, <span class="hljs-number">0</span>, <span class="hljs-number">65</span>);<br>    <span class="hljs-built_in">sub_4406E0</span>(<span class="hljs-number">0</span>, v18, <span class="hljs-number">64LL</span>);<br>    v18[<span class="hljs-number">39</span>] = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span> ( (sub_424BA0)(v18) == <span class="hljs-number">39</span> )<br>    &#123;<br>      v2 = <span class="hljs-built_in">sub_400E44</span>(v18);<br>      v3 = <span class="hljs-built_in">sub_400E44</span>(v2);<br>      v4 = <span class="hljs-built_in">sub_400E44</span>(v3);<br>      v5 = <span class="hljs-built_in">sub_400E44</span>(v4);<br>      v6 = <span class="hljs-built_in">sub_400E44</span>(v5);<br>      v7 = <span class="hljs-built_in">sub_400E44</span>(v6);<br>      v8 = <span class="hljs-built_in">sub_400E44</span>(v7);<br>      v9 = <span class="hljs-built_in">sub_400E44</span>(v8);<br>      v10 = <span class="hljs-built_in">sub_400E44</span>(v9);<br>      v11 = <span class="hljs-built_in">sub_400E44</span>(v10);<br>      <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">sub_400360</span>(v11, off_6CC090) )<br>      &#123;<br>        <span class="hljs-built_in">sub_410CC0</span>(<span class="hljs-string">&quot;You found me!!!&quot;</span>);<br>        <span class="hljs-built_in">sub_410CC0</span>(<span class="hljs-string">&quot;bye bye~&quot;</span>);<br>      &#125;<br>      result = <span class="hljs-number">0LL</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      result = <span class="hljs-number">4294967293LL</span>;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    result = <span class="hljs-number">0xFFFFFFFF</span>LL;<br>  &#125;<br>LABEL_13:<br>  <span class="hljs-keyword">if</span> ( __readfsqword(<span class="hljs-number">0x28</span>u) != v19 )<br>    <span class="hljs-built_in">sub_444020</span>();<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>v15存输入的内容，第一段就是将输入异或下标后与已知的v12数组比较（ida分析错了，v12，v13，v14应该是一个数组，地址连在一起的）</p>
<p>脚本解密：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">arr = [<span class="hljs-number">73</span>,<span class="hljs-number">111</span>,<span class="hljs-number">100</span>,<span class="hljs-number">108</span>,<span class="hljs-number">62</span>,<span class="hljs-number">81</span>,<span class="hljs-number">110</span>,<span class="hljs-number">98</span>,<span class="hljs-number">40</span>,<span class="hljs-number">111</span>,<span class="hljs-number">99</span>,<span class="hljs-number">121</span>,<span class="hljs-number">127</span>,<span class="hljs-number">121</span>,<span class="hljs-number">46</span>,<span class="hljs-number">105</span>,<span class="hljs-number">127</span>,<span class="hljs-number">100</span>,<span class="hljs-number">96</span>,<span class="hljs-number">51</span>,<span class="hljs-number">119</span>,<span class="hljs-number">125</span>,<br>       <span class="hljs-number">119</span>,<span class="hljs-number">101</span>,<span class="hljs-number">107</span>,<span class="hljs-number">57</span>,<span class="hljs-number">123</span>,<span class="hljs-number">105</span>,<span class="hljs-number">121</span>,<span class="hljs-number">61</span>,<span class="hljs-number">126</span>,<span class="hljs-number">121</span>,<span class="hljs-number">76</span>,<span class="hljs-number">64</span>,<span class="hljs-number">69</span>,<span class="hljs-number">67</span>]<br><br>dec = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">36</span>):<br>    dec += <span class="hljs-built_in">chr</span>(arr[i]^i)<br><br><span class="hljs-built_in">print</span>(dec)<br><br><span class="hljs-comment">#Info:The first four chars are flag``</span><br></code></pre></td></tr></table></figure>

<p>第二次输入，进行了10次base64加密，解密即可：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">enc = <span class="hljs-string">&quot;Vm0wd2VHUXhTWGhpUm1SWVYwZDRWVll3Wkc5WFJsbDNXa1pPVlUxV2NIcFhhMk0xVmpKS1NHVkdXbFpOYmtKVVZtcEtTMUl5VGtsaVJtUk9ZV3hhZVZadGVHdFRNVTVYVW01T2FGSnRVbGhhVjNoaFZWWmtWMXBFVWxSTmJFcElWbTAxVDJGV1NuTlhia0pXWWxob1dGUnJXbXRXTVZaeVdrWm9hVlpyV1hwV1IzaGhXVmRHVjFOdVVsWmlhMHBZV1ZSR1lWZEdVbFZTYlhSWFRWWndNRlZ0TVc5VWJGcFZWbXR3VjJKSFVYZFdha1pXWlZaT2NtRkhhRk5pVjJoWVYxZDBhMVV3TlhOalJscFlZbGhTY1ZsclduZGxiR1J5VmxSR1ZXSlZjRWhaTUZKaFZqSktWVkZZYUZkV1JWcFlWV3BHYTFkWFRrZFRiV3hvVFVoQ1dsWXhaRFJpTWtsM1RVaG9hbEpYYUhOVmJUVkRZekZhY1ZKcmRGTk5Wa3A2VjJ0U1ExWlhTbFpqUldoYVRVWndkbFpxUmtwbGJVWklZVVprYUdFeGNHOVhXSEJIWkRGS2RGSnJhR2hTYXpWdlZGVm9RMlJzV25STldHUlZUVlpXTlZadE5VOVdiVXBJVld4c1dtSllUWGhXTUZwell6RmFkRkpzVWxOaVNFSktWa1phVTFFeFduUlRhMlJxVWxad1YxWnRlRXRXTVZaSFVsUnNVVlZVTURrPQ==&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    enc = enc.decode(<span class="hljs-string">&#x27;base64&#x27;</span>)<br><span class="hljs-built_in">print</span> (enc)<br></code></pre></td></tr></table></figure>

<p>接下来又是两段异或，第一段可以通过已知的flag反向解出v5，第二段异或根据已知数组和v5异或解出flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">key = <span class="hljs-string">&#x27;&#x27;</span><br>enc1 = <span class="hljs-string">&#x27;flag&#x27;</span><br>dec = <span class="hljs-string">&#x27;&#x27;</span><br>enc = [<span class="hljs-number">0x40</span>,<span class="hljs-number">0x35</span>,<span class="hljs-number">0x20</span>,<span class="hljs-number">0x56</span>,<span class="hljs-number">0x5D</span>,<span class="hljs-number">0x18</span>,<span class="hljs-number">0x22</span>,<span class="hljs-number">0x45</span>,<span class="hljs-number">0x17</span>,<span class="hljs-number">0x2F</span>,<span class="hljs-number">0x24</span>,<span class="hljs-number">0x6E</span>,<span class="hljs-number">0x62</span>,<span class="hljs-number">0x3C</span>,<span class="hljs-number">0x27</span>,<span class="hljs-number">0x54</span>,<span class="hljs-number">0x48</span>,<span class="hljs-number">0x6C</span>,<span class="hljs-number">0x24</span>,<span class="hljs-number">0x6E</span>,<span class="hljs-number">0x72</span>,<span class="hljs-number">0x3C</span>,<span class="hljs-number">0x32</span>,<span class="hljs-number">0x45</span>,<span class="hljs-number">0x5B</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>    key += <span class="hljs-built_in">chr</span>(enc[i] ^ <span class="hljs-built_in">ord</span>(enc1[i]))<br><span class="hljs-built_in">print</span> (key)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    dec += <span class="hljs-built_in">chr</span>(enc[i] ^ <span class="hljs-built_in">ord</span>(key[i%<span class="hljs-number">4</span>]))<br><span class="hljs-built_in">print</span>(dec)<br><br><span class="hljs-comment">#flag&#123;Act1ve_Defen5e_Test&#125;</span><br></code></pre></td></tr></table></figure>

<h3 id="5-5"><a href="#5-5" class="headerlink" title="5.5"></a>5.5</h3><h4 id="CISCN-2022-东北-easycpp"><a href="#CISCN-2022-东北-easycpp" class="headerlink" title="[CISCN 2022 东北]easycpp"></a>[CISCN 2022 东北]easycpp</h4><p>今年的全国大学生信息安全竞赛快开了，做做往年的题</p>
<p>这个应该是一个签到</p>
<p>主程序逻辑非常简单，直接上脚本：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> miwen[] =<br>&#123;<br>  <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x60</span>,<br>  <span class="hljs-number">0x37</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x3C</span>,<br>  <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x62</span>,<br>  <span class="hljs-number">0x65</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x7D</span><br>&#125;;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">37</span>; i &gt;=<span class="hljs-number">3</span>; i--)<br>	&#123;<br>		miwen[i<span class="hljs-number">-1</span>] ^= miwen[i];<br>		miwen[i<span class="hljs-number">-2</span>] ^= miwen[i<span class="hljs-number">-1</span>];<br>		miwen[i<span class="hljs-number">-3</span>] ^= miwen[i<span class="hljs-number">-2</span>];<br>	&#125;<br>	<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">38</span>; i++)<br>	&#123;<br>		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, miwen[i]);<br>	&#125;<br>	<span class="hljs-keyword">return</span>  <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="AnCTFxD-3CTF：d3sky"><a href="#AnCTFxD-3CTF：d3sky" class="headerlink" title="AnCTFxD^3CTF：d3sky"></a>AnCTFxD^3CTF：d3sky</h4><p>还是没看汇编的习惯，人家悄悄把密钥变了都没发现</p>
<p>首先是一个tls反调试，修改标志位跳过，接着就不能看f5的伪代码了，看汇编：</p>
<p><img src="https://raw.githubusercontent.com/shimmer123456/img/main/img/202305051929942.png" alt="image-20230505192948632"></p>
<p>可以看到有try，except的代码，说明<strong>程序通过异常来控制执行流程</strong>，其中就有一个除零异常，但是按理来说动调时候应该是会触发的，但是没有（这里我还没有完全看明白，大概猜测还是与在调试的状态有关），那么先假设他触发了除零异常了，接下来就会跳转到loc_6310EF那里继续执行，在密钥后面又加上了一个字符串（这才是真正的密钥）。利用这个密钥初始化了s盒，解密opcode最后一部分，长度为74</p>
<p>接下来是一个虚拟机：</p>
<p>​	进入虚拟机，每次解密3个opcode，然后执行opcode，最后再加密回去</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python">enc = [<span class="hljs-number">36</span>, <span class="hljs-number">11</span>, <span class="hljs-number">109</span>, <span class="hljs-number">15</span>, <span class="hljs-number">3</span>, <span class="hljs-number">50</span>, <span class="hljs-number">66</span>, <span class="hljs-number">29</span>, <span class="hljs-number">43</span>, <span class="hljs-number">67</span>, <span class="hljs-number">120</span>, <span class="hljs-number">67</span>, <span class="hljs-number">115</span>, <span class="hljs-number">48</span>, <span class="hljs-number">43</span>, <span class="hljs-number">78</span>, <span class="hljs-number">99</span>, <span class="hljs-number">72</span>, <span class="hljs-number">119</span>, <span class="hljs-number">46</span>, <span class="hljs-number">50</span>, <span class="hljs-number">57</span>, <span class="hljs-number">26</span>, <span class="hljs-number">18</span>, <span class="hljs-number">113</span>, <span class="hljs-number">122</span>, <span class="hljs-number">66</span>, <span class="hljs-number">23</span>, <span class="hljs-number">69</span>, <span class="hljs-number">114</span>, <span class="hljs-number">86</span>, <span class="hljs-number">12</span>, <span class="hljs-number">92</span>, <span class="hljs-number">74</span>, <span class="hljs-number">98</span>, <span class="hljs-number">83</span>, <span class="hljs-number">51</span>]<br>dec = [<span class="hljs-number">0</span>] * <span class="hljs-number">37</span><br>dec[-<span class="hljs-number">1</span>] = <span class="hljs-number">126</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">4</span>):<br>  dec[i] = enc[i] ^ enc[i+<span class="hljs-number">1</span>] ^ dec[i+<span class="hljs-number">4</span>]<br><br>dec[<span class="hljs-number">33</span>] = enc[<span class="hljs-number">33</span>] ^ enc[<span class="hljs-number">34</span>] ^ dec[<span class="hljs-number">0</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">29</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">4</span>):<br>  dec[i] = enc[i] ^ enc[i+<span class="hljs-number">1</span>] ^ dec[i+<span class="hljs-number">4</span>]<br><br>dec[<span class="hljs-number">2</span>] = enc[-<span class="hljs-number">1</span>] ^ dec[<span class="hljs-number">0</span>] ^ dec[<span class="hljs-number">1</span>] ^ dec[-<span class="hljs-number">1</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>, <span class="hljs-number">37</span>):<br>  dec[i] = enc[i-<span class="hljs-number">3</span>] ^ dec[i-<span class="hljs-number">1</span>] ^ dec[i-<span class="hljs-number">2</span>] ^ dec[i-<span class="hljs-number">3</span>]<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(dec))<br></code></pre></td></tr></table></figure>

<h3 id="5-6"><a href="#5-6" class="headerlink" title="5.6"></a>5.6</h3><h4 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h4><p>主要逻辑：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs c"> sub_401AD0();<br>  <span class="hljs-built_in">strcpy</span>(v5, <span class="hljs-string">&quot;1A2F943C4D8C5B6EA3C9BCAD7E&quot;</span>);<br>  v0 = <span class="hljs-number">0</span>;<br>  v5[<span class="hljs-number">27</span>] = <span class="hljs-number">0</span>;<br>  v6 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">do</span><br>  &#123;<br>    *(_DWORD *)&amp;v7[v0] = <span class="hljs-number">0</span>;<br>    v0 += <span class="hljs-number">4</span>;<br>  &#125;<br>  <span class="hljs-keyword">while</span> ( v0 &lt; <span class="hljs-number">0x20</span> );<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;input your key:&quot;</span>);<br>  <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>, v7);<br>  v1 = <span class="hljs-built_in">strlen</span>(v7);<br>  <span class="hljs-keyword">if</span> ( v1 &lt;= <span class="hljs-number">19</span> )<br>  &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;too short!&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( v1 &gt; <span class="hljs-number">30</span> )<br>  &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;too long!&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    <span class="hljs-keyword">if</span> ( sub_4014A0(v7, v5, v1) )<br>      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;congratulations, your input is the flag ^_^&quot;</span>);<br>    <span class="hljs-keyword">else</span><br>      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;try agian&quot;</span>);<br>    cnt = iob[<span class="hljs-number">0</span>]._cnt - <span class="hljs-number">1</span>;<br>    iob[<span class="hljs-number">0</span>]._cnt = cnt;<br>    <span class="hljs-keyword">if</span> ( cnt &lt; <span class="hljs-number">0</span> )<br>    &#123;<br>      filbuf((FILE *)iob[<span class="hljs-number">0</span>]._ptr);<br>      cnt = iob[<span class="hljs-number">0</span>]._cnt;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      ++iob[<span class="hljs-number">0</span>]._ptr;<br>    &#125;<br>    v3 = cnt - <span class="hljs-number">1</span>;<br>    iob[<span class="hljs-number">0</span>]._cnt = v3;<br>    <span class="hljs-keyword">if</span> ( v3 &lt; <span class="hljs-number">0</span> )<br>      filbuf((FILE *)iob[<span class="hljs-number">0</span>]._ptr);<br>    <span class="hljs-keyword">else</span><br>      ++iob[<span class="hljs-number">0</span>]._ptr;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>关键函数sub_4014A0(v7, v5, v1)，跟进：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs c"> v3 = <span class="hljs-number">0</span>;<br>  v11 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">do</span><br>  &#123;<br>    *(_DWORD *)&amp;v10[v3] = <span class="hljs-number">0</span>;<br>    v3 += <span class="hljs-number">4</span>;<br>  &#125;<br>  <span class="hljs-keyword">while</span> ( v3 &lt; ((v9 - v10 + <span class="hljs-number">30</span>) &amp; <span class="hljs-number">0xFFFFFFFC</span>) );<br>  v9[<span class="hljs-number">0</span>] = <span class="hljs-number">15</span>;<br>  v9[<span class="hljs-number">1</span>] = <span class="hljs-number">-121</span>;<br>  v10[<span class="hljs-number">0</span>] = <span class="hljs-number">98</span>;<br>  v10[<span class="hljs-number">1</span>] = <span class="hljs-number">20</span>;<br>  v10[<span class="hljs-number">2</span>] = <span class="hljs-number">1</span>;<br>  v10[<span class="hljs-number">3</span>] = <span class="hljs-number">-58</span>;<br>  v10[<span class="hljs-number">4</span>] = <span class="hljs-number">-16</span>;<br>  v10[<span class="hljs-number">5</span>] = <span class="hljs-number">33</span>;<br>  v10[<span class="hljs-number">6</span>] = <span class="hljs-number">48</span>;<br>  v10[<span class="hljs-number">7</span>] = <span class="hljs-number">17</span>;<br>  v10[<span class="hljs-number">8</span>] = <span class="hljs-number">80</span>;<br>  v10[<span class="hljs-number">9</span>] = <span class="hljs-number">-48</span>;<br>  v10[<span class="hljs-number">10</span>] = <span class="hljs-number">-126</span>;<br>  v10[<span class="hljs-number">11</span>] = <span class="hljs-number">35</span>;<br>  v10[<span class="hljs-number">12</span>] = <span class="hljs-number">-82</span>;<br>  v10[<span class="hljs-number">13</span>] = <span class="hljs-number">35</span>;<br>  v10[<span class="hljs-number">14</span>] = <span class="hljs-number">-18</span>;<br>  v10[<span class="hljs-number">15</span>] = <span class="hljs-number">-87</span>;<br>  v10[<span class="hljs-number">16</span>] = <span class="hljs-number">-76</span>;<br>  v10[<span class="hljs-number">17</span>] = <span class="hljs-number">82</span>;<br>  v10[<span class="hljs-number">18</span>] = <span class="hljs-number">120</span>;<br>  v10[<span class="hljs-number">19</span>] = <span class="hljs-number">87</span>;<br>  v10[<span class="hljs-number">20</span>] = <span class="hljs-number">12</span>;<br>  v10[<span class="hljs-number">21</span>] = <span class="hljs-number">-122</span>;<br>  v10[<span class="hljs-number">22</span>] = <span class="hljs-number">-117</span>;<br>  <span class="hljs-keyword">if</span> ( a3 == <span class="hljs-number">25</span> )<br>  &#123;<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i != <span class="hljs-number">25</span>; ++i )<br>      v12[i] = __ROL1__(*(_BYTE *)(a1 + i), <span class="hljs-number">2</span>);<br>    <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j != <span class="hljs-number">25</span>; ++j )<br>      v12[j] ^= sub_401460(a2, j);<br>    v7 = <span class="hljs-number">15</span>;<br>    <span class="hljs-keyword">for</span> ( k = <span class="hljs-number">0</span>; v12[k] == v7; v7 = v9[k] )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( ++k == <span class="hljs-number">25</span> )<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>其中sub_401460没有flag参与，直接仿写就行</p>
<p>抄的exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">key = <span class="hljs-string">&#x27;1A2F943C4D8C5B6EA3C9BCAD7E&#x27;</span><br>c = [<span class="hljs-number">0x0F</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x8B</span>]<br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">25</span>):<br>    x = c[i] ^ <span class="hljs-built_in">int</span>(key[i : i + <span class="hljs-number">2</span>], <span class="hljs-number">16</span>)<br>    x = ((x &lt;&lt; <span class="hljs-number">6</span>) &amp; <span class="hljs-number">0xff</span>) | ((x &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">0xff</span>)<br>    flag += <span class="hljs-built_in">chr</span>(x)<br>    <br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<h4 id="bad-python"><a href="#bad-python" class="headerlink" title="bad_python"></a>bad_python</h4><p>是一个被修改的的pyc文件， 根据文件名得到编译环境为python3.6，所以先百度正确的文件头是 33 0d 0d 0a 0c 63 4a 63 61 02 00 e3 00 00 00 。修改好后就可以正常反编译了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># uncompyle6 version 3.8.0</span><br><span class="hljs-comment"># Python bytecode 3.6 (3379)</span><br><span class="hljs-comment"># Decompiled from: Python 3.6.0 (v3.6.0:41df79263a11, Dec 23 2016, 08:06:12) [MSC v.1900 64 bit (AMD64)]</span><br><span class="hljs-comment"># Embedded file name: pyre.py</span><br><span class="hljs-comment"># Compiled at: 2022-10-15 15:36:44</span><br><span class="hljs-comment"># Size of source mod 2**32: 609 bytes</span><br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">v, k</span>):<br>    v0 = c_uint32(v[<span class="hljs-number">0</span>])<br>    v1 = c_uint32(v[<span class="hljs-number">1</span>])<br>    sum1 = c_uint32(<span class="hljs-number">0</span>)<br>    delta = <span class="hljs-number">195935983</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>        v0.value += (v1.value &lt;&lt; <span class="hljs-number">4</span> ^ v1.value &gt;&gt; <span class="hljs-number">7</span>) + v1.value ^ sum1.value + k[(sum1.value &amp; <span class="hljs-number">3</span>)]<br>        sum1.value += delta<br>        v1.value += (v0.value &lt;&lt; <span class="hljs-number">4</span> ^ v0.value &gt;&gt; <span class="hljs-number">7</span>) + v0.value ^ sum1.value + k[(sum1.value &gt;&gt; <span class="hljs-number">9</span> &amp; <span class="hljs-number">3</span>)]<br> <br>    <span class="hljs-keyword">return</span> (<br>     v0.value, v1.value)<br> <br> <br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    flag = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;please input your flag:&#x27;</span>)<br>    k = [<span class="hljs-number">255</span>, <span class="hljs-number">187</span>, <span class="hljs-number">51</span>, <span class="hljs-number">68</span>]<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(flag) != <span class="hljs-number">32</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;wrong!&#x27;</span>)<br>        exit(-<span class="hljs-number">1</span>)<br>    a = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">32</span>, <span class="hljs-number">8</span>):<br>        v1 = bytes_to_long(<span class="hljs-built_in">bytes</span>(flag[i:i + <span class="hljs-number">4</span>], <span class="hljs-string">&#x27;ascii&#x27;</span>))<br>        v2 = bytes_to_long(<span class="hljs-built_in">bytes</span>(flag[i + <span class="hljs-number">4</span>:i + <span class="hljs-number">8</span>], <span class="hljs-string">&#x27;ascii&#x27;</span>))<br>        a += encrypt([v1, v2], k)<br> <br>    enc = [<br>     <span class="hljs-number">4006073346</span>, <span class="hljs-number">2582197823</span>, <span class="hljs-number">2235293281</span>, <span class="hljs-number">558171287</span>, <span class="hljs-number">2425328816</span>, <span class="hljs-number">1715140098</span>, <span class="hljs-number">986348143</span>, <span class="hljs-number">1948615354</span>]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        <span class="hljs-keyword">if</span> enc[i] != a[i]:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;wrong!&#x27;</span>)<br>            exit(-<span class="hljs-number">1</span>)<br> <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;flag is flag&#123;%s&#125;&#x27;</span> % flag)<br><span class="hljs-comment"># okay decompiling d:\pyre.cpython-36.pyc</span><br></code></pre></td></tr></table></figure>

<p>简单的tea，逆写：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span>  u_int unsigned int</span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>	u_int enc[] = &#123; <span class="hljs-number">4006073346</span>, <span class="hljs-number">2582197823</span>, <span class="hljs-number">2235293281</span>, <span class="hljs-number">558171287</span>,<br>				<span class="hljs-number">2425328816</span>, <span class="hljs-number">1715140098</span>, <span class="hljs-number">986348143</span>, <span class="hljs-number">1948615354</span> &#125;;<br>	u_int k[] = &#123; <span class="hljs-number">255</span>, <span class="hljs-number">187</span>, <span class="hljs-number">51</span>, <span class="hljs-number">68</span> &#125;;<br>	<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i += <span class="hljs-number">2</span>)<br>	&#123;<br>		u_int delta = <span class="hljs-number">195935983</span>;<br>		u_int s1 = delta * <span class="hljs-number">32</span>;<br>		<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">32</span>; j++)<br>		&#123;<br>			enc[i + <span class="hljs-number">1</span>] -= (enc[i] &lt;&lt; <span class="hljs-number">4</span> ^ enc[i] &gt;&gt; <span class="hljs-number">7</span>) + enc[i] ^ s1 + k[s1 &gt;&gt; <span class="hljs-number">9</span> &amp; <span class="hljs-number">3</span>];<br>			s1 -= delta;<br>			enc[i] -= (enc[i + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">4</span> ^ enc[i + <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">7</span>) + enc[i + <span class="hljs-number">1</span>] ^ s1 + k[s1 &amp; <span class="hljs-number">3</span>];<br>		&#125;<br>	&#125;<br>	<span class="hljs-type">char</span> flag[<span class="hljs-number">32</span>] = &#123; <span class="hljs-number">0</span> &#125;;<br>	<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++)<br>	&#123;<br>		flag[<span class="hljs-number">4</span> * i] = enc[i] &gt;&gt; <span class="hljs-number">24</span>;<br>		flag[<span class="hljs-number">4</span> * i + <span class="hljs-number">1</span>] = (enc[i] &gt;&gt; <span class="hljs-number">16</span>) ^ <span class="hljs-number">0xFF000000</span>;<br>		flag[<span class="hljs-number">4</span> * i + <span class="hljs-number">2</span>] = (enc[i] &gt;&gt; <span class="hljs-number">8</span>) ^ <span class="hljs-number">0xFF000000</span>;<br>		flag[<span class="hljs-number">4</span> * i + <span class="hljs-number">3</span>] = enc[i] ^ <span class="hljs-number">0xFF000000</span>;<br>	&#125;<br>	<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++)<br>	&#123;<br>		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, flag[i]);<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="5-7"><a href="#5-7" class="headerlink" title="5.7"></a>5.7</h3><h4 id="TEA"><a href="#TEA" class="headerlink" title="TEA"></a>TEA</h4><p>魔改的xtea加密：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">8</span>; ++i )<br> &#123;<br>   v5 = <span class="hljs-number">0</span>;<br>   v6 = <span class="hljs-number">256256256</span> * i;<br>   v3 = i + <span class="hljs-number">1</span>;<br>   <span class="hljs-keyword">do</span><br>   &#123;<br>     ++v5;<br>     *(a1 + <span class="hljs-number">4</span>i64 * i) += v6 ^ (*(a1 + <span class="hljs-number">4</span>i64 * v3) + ((*(a1 + <span class="hljs-number">4</span>i64 * v3) &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">16</span> * *(a1 + <span class="hljs-number">4</span>i64 * v3)))) ^ (v6 + *(a2 + <span class="hljs-number">4</span>i64 * (v6 &amp; <span class="hljs-number">3</span>)));<br>     *(a1 + <span class="hljs-number">4</span>i64 * v3) += (v6 + *(a2 + <span class="hljs-number">4</span>i64 * ((v6 &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>))) ^ (*(a1 + <span class="hljs-number">4</span>i64 * i)<br>                                                                  + ((*(a1 + <span class="hljs-number">4</span>i64 * i) &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">16</span> * *(a1 + <span class="hljs-number">4</span>i64 * i))));<br>     v6 += <span class="hljs-number">256256256</span>;<br>   &#125;<br>   <span class="hljs-keyword">while</span> ( v5 &lt;= <span class="hljs-number">0x20</span> );<br>   result = (i + <span class="hljs-number">1</span>);<br> &#125;<br></code></pre></td></tr></table></figure>

<p>其中do{}内的是tea加密的算法，外层套了个for（）循环，因为原文有10个整数</p>
<p>解密脚本：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">8</span>; i &gt;= <span class="hljs-number">0</span>; --i)<span class="hljs-comment">//从后往前遍历</span><br>    &#123;<br>        <span class="hljs-type">int</span> v5 = <span class="hljs-number">0</span>;<br>        <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v6 = <span class="hljs-number">256256256</span> * (i+<span class="hljs-number">33</span>);<span class="hljs-comment">//detal  因为v6也就是detal在加密过程中一直加256256256，加了32次，所以逆的时候先求出最后的结果，并且要注意使用unsigned int</span><br>        <br>        <span class="hljs-keyword">do</span><span class="hljs-comment">//这个部分就完全逆过来，一共三步嘛，去原文那里对照着看一下，+=变-=，后面的内容不需要变，直接抄</span><br>        &#123;<br>            ++v5;<br>            v6 -= <span class="hljs-number">256256256</span>;<br>            a1[i + <span class="hljs-number">1</span>] -= (v6 + a2[(v6 &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>]) ^ (a1[i] + ((a1[i] &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">16</span> * a1[i])));<br>            a1[i] -= v6 ^ (a1[i + <span class="hljs-number">1</span>] + ((a1[i + <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">16</span> * a1[i + <span class="hljs-number">1</span>]))) ^ (v6 + a2[v6 &amp; <span class="hljs-number">3</span>]);<br>            <br>        &#125; <span class="hljs-keyword">while</span> (v5 &lt;= <span class="hljs-number">32</span>);<br><br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++)<span class="hljs-comment">//这里是原程序这样写的</span><br>    &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">3</span>; j &gt;= <span class="hljs-number">0</span>; j--)<br>        &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, (a1[i] &gt;&gt; (j * <span class="hljs-number">8</span>)) &amp; <span class="hljs-number">0xFF</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="xxxorrr"><a href="#xxxorrr" class="headerlink" title="xxxorrr"></a>xxxorrr</h4><p>main函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> a1, <span class="hljs-type">char</span> **a2, <span class="hljs-type">char</span> **a3)</span><br>&#123;<br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+Ch] [rbp-34h]</span><br>  <span class="hljs-type">char</span> s[<span class="hljs-number">40</span>]; <span class="hljs-comment">// [rsp+10h] [rbp-30h] BYREF</span><br>  <span class="hljs-type">unsigned</span> __int64 v6; <span class="hljs-comment">// [rsp+38h] [rbp-8h]</span><br> <br>  v6 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>  sub_A90(sub_916);<br>  fgets(s, <span class="hljs-number">35</span>, <span class="hljs-built_in">stdin</span>);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">33</span>; ++i )<br>    s1[i] ^= s[i];<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span><br></code></pre></td></tr></table></figure>

<p>输入的s1与s1的元素进行异或，点击sub_916函数找s1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">unsigned __int64 sub_916()<br>&#123;<br>  unsigned __int64 v1; // [rsp+8h] [rbp-8h]<br> <br>  v1 = __readfsqword(0x28u);<br>  if ( !strcmp(s1, s2) )<br>    puts(&quot;Congratulations!&quot;);<br>  else<br>    puts(&quot;Wrong!&quot;);<br>  return __readfsqword(0x28u) ^ v1;<br>&#125;<br>#.data:0000000000201060 s2              db &#x27;VNWXQQ&#x27;,9,&#x27;F&#x27;       ; DATA XREF: sub_916+17↑o<br>.data:0000000000201068                 db  17h<br>.data:0000000000201069                 db  46h ; F<br>.data:000000000020106A                 db  54h ; T<br>.data:000000000020106B                 db  5Ah ; Z<br>.data:000000000020106C                 db  59h ; Y<br>.data:000000000020106D                 db  59h ; Y<br>.data:000000000020106E                 db  1Fh<br>.data:000000000020106F                 db  48h ; H<br>.data:0000000000201070                 db  32h ; 2<br>.data:0000000000201071                 db  5Bh ; [<br>.data:0000000000201072                 db  6Bh ; k<br>.data:0000000000201073                 db  7Ch ; |<br>.data:0000000000201074                 db  75h ; u<br>.data:0000000000201075                 db  6Eh ; n<br>.data:0000000000201076                 db  7Eh ; ~<br>.data:0000000000201077                 db  6Eh ; n<br>.data:0000000000201078                 db  2Fh ; /<br>.data:0000000000201079                 db  77h ; w<br>.data:000000000020107A                 db  4Fh ; O<br>.data:000000000020107B                 db  7Ah ; z<br>.data:000000000020107C                 db  71h ; q<br>.data:000000000020107D                 db  43h ; C<br>.data:000000000020107E                 db  2Bh ; +<br>.data:000000000020107F                 db  26h ; &amp;<br>.data:0000000000201080                 db  89h<br></code></pre></td></tr></table></figure>

<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">s2=[ <span class="hljs-number">0x56</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x46</span>, <br>  <span class="hljs-number">0x54</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x7C</span>, <br>  <span class="hljs-number">0x75</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x43</span>, <br>  <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x00</span>]<br>s1 = <span class="hljs-string">&#x27;qasxcytgsasxcvrefghnrfghnjedfgbhn&#x27;</span><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">33</span>):<br> 	flag+=<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(s1[i])^ (<span class="hljs-number">2</span> * i + <span class="hljs-number">65</span>)^s2[i])<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment"># flag&#123;c0n5truct0r5_functi0n_in_41f&#125;</span><br></code></pre></td></tr></table></figure>

<h3 id="5-8"><a href="#5-8" class="headerlink" title="5.8"></a>5.8</h3><h4 id="ISCC-Convert"><a href="#ISCC-Convert" class="headerlink" title="ISCC  Convert"></a>ISCC  Convert</h4><p>今天做了两道ISCC的题目，这个比赛还没结束，不可以写wp捏。贴张截图</p>
<p><img src="https://raw.githubusercontent.com/shimmer123456/img/main/img/202305082157702.png" alt="image-20230508215723510"></p>
<h4 id="testre"><a href="#testre" class="headerlink" title="testre"></a>testre</h4><p>主要逻辑：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">sub_400700</span><span class="hljs-params">(<span class="hljs-type">void</span> *a1, _QWORD *a2, __int64 a3, <span class="hljs-type">size_t</span> a4)</span><br>&#123;<br>  <span class="hljs-type">unsigned</span> __int8 *v4; <span class="hljs-comment">// rcx</span><br>  __int64 v6; <span class="hljs-comment">// [rsp+0h] [rbp-C0h]</span><br>  <span class="hljs-type">int</span> c; <span class="hljs-comment">// [rsp+8h] [rbp-B8h]</span><br>  <span class="hljs-type">char</span> v8; <span class="hljs-comment">// [rsp+Fh] [rbp-B1h]</span><br>  <span class="hljs-type">int</span> v9; <span class="hljs-comment">// [rsp+10h] [rbp-B0h]</span><br>  <span class="hljs-type">bool</span> v10; <span class="hljs-comment">// [rsp+17h] [rbp-A9h]</span><br>  <span class="hljs-type">unsigned</span> __int8 *v11; <span class="hljs-comment">// [rsp+18h] [rbp-A8h]</span><br>  <span class="hljs-type">char</span> v12; <span class="hljs-comment">// [rsp+27h] [rbp-99h]</span><br>  <span class="hljs-type">int</span> v13; <span class="hljs-comment">// [rsp+28h] [rbp-98h]</span><br>  <span class="hljs-type">int</span> v14; <span class="hljs-comment">// [rsp+2Ch] [rbp-94h]</span><br>  <span class="hljs-type">unsigned</span> __int64 i; <span class="hljs-comment">// [rsp+30h] [rbp-90h]</span><br>  <span class="hljs-type">size_t</span> n; <span class="hljs-comment">// [rsp+38h] [rbp-88h]</span><br>  <span class="hljs-type">size_t</span> v17; <span class="hljs-comment">// [rsp+40h] [rbp-80h]</span><br>  <span class="hljs-type">size_t</span> v18; <span class="hljs-comment">// [rsp+48h] [rbp-78h]</span><br>  <span class="hljs-type">size_t</span> j; <span class="hljs-comment">// [rsp+50h] [rbp-70h]</span><br>  <span class="hljs-type">size_t</span> v20; <span class="hljs-comment">// [rsp+58h] [rbp-68h]</span><br>  <span class="hljs-type">int</span> v21; <span class="hljs-comment">// [rsp+64h] [rbp-5Ch]</span><br>  <span class="hljs-type">unsigned</span> __int64 v22; <span class="hljs-comment">// [rsp+68h] [rbp-58h]</span><br>  <span class="hljs-type">int</span> v23; <span class="hljs-comment">// [rsp+74h] [rbp-4Ch]</span><br>  __int64 *v24; <span class="hljs-comment">// [rsp+78h] [rbp-48h]</span><br>  __int64 v25; <span class="hljs-comment">// [rsp+80h] [rbp-40h]</span><br>  <span class="hljs-type">void</span> *v26; <span class="hljs-comment">// [rsp+88h] [rbp-38h]</span><br>  <span class="hljs-type">int</span> v27; <span class="hljs-comment">// [rsp+94h] [rbp-2Ch]</span><br>  <span class="hljs-type">size_t</span> v28; <span class="hljs-comment">// [rsp+98h] [rbp-28h]</span><br>  __int64 v29; <span class="hljs-comment">// [rsp+A0h] [rbp-20h]</span><br>  _QWORD *v30; <span class="hljs-comment">// [rsp+A8h] [rbp-18h]</span><br>  <span class="hljs-type">void</span> *s; <span class="hljs-comment">// [rsp+B0h] [rbp-10h]</span><br>  <span class="hljs-type">char</span> v32; <span class="hljs-comment">// [rsp+BFh] [rbp-1h]</span><br><br>  s = a1;<br>  v30 = a2;<br>  v29 = a3;<br>  v28 = a4;<br>  v27 = <span class="hljs-number">-559038737</span>;<br>  v26 = <span class="hljs-built_in">malloc</span>(<span class="hljs-number">0x100</span>uLL);<br>  v25 = v29;<br>  v24 = &amp;v6;<br>  v22 = <span class="hljs-number">0LL</span>;<br>  v17 = <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0LL</span>; i &lt; v28; ++i )<br>  &#123;<br>    v13 = *(<span class="hljs-type">unsigned</span> __int8 *)(v25 + i);<br>    *((_BYTE *)v26 + i) = byte_400E90[i % <span class="hljs-number">0x1D</span>] ^ v13;<br>    *((_BYTE *)v26 + i) += *(_BYTE *)(v25 + i);<br>  &#125;<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    v12 = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span> ( v17 &lt; v28 )<br>      v12 = ~(*(_BYTE *)(v25 + v17) != <span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">if</span> ( !(v12 &amp; <span class="hljs-number">1</span>) )<br>      <span class="hljs-keyword">break</span>;<br>    ++v17;<br>  &#125;<br>  n = ((<span class="hljs-type">unsigned</span> __int64)(<span class="hljs-number">0x28F5C28F5C28F5C3</span>LL * (<span class="hljs-type">unsigned</span> __int128)(<span class="hljs-number">138</span> * (v28 - v17) &gt;&gt; <span class="hljs-number">2</span>) &gt;&gt; <span class="hljs-number">64</span>) &gt;&gt; <span class="hljs-number">2</span>) + <span class="hljs-number">1</span>;<br>  v23 = ((<span class="hljs-type">unsigned</span> __int64)(<span class="hljs-number">0xAAAAAAAAAAAAAAAB</span>LL * (<span class="hljs-type">unsigned</span> __int128)((v17 + v28) &lt;&lt; <span class="hljs-number">6</span>) &gt;&gt; <span class="hljs-number">64</span>) &gt;&gt; <span class="hljs-number">5</span>) - <span class="hljs-number">1</span>;<br>  v11 = (<span class="hljs-type">unsigned</span> __int8 *)&amp;v6<br>      - ((((<span class="hljs-type">unsigned</span> __int64)(<span class="hljs-number">0x28F5C28F5C28F5C3</span>LL * (<span class="hljs-type">unsigned</span> __int128)(<span class="hljs-number">138</span> * (v28 - v17) &gt;&gt; <span class="hljs-number">2</span>) &gt;&gt; <span class="hljs-number">64</span>) &gt;&gt; <span class="hljs-number">2</span>) + <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFFFFFFFFFFFFFFF0</span>LL);<br>  <span class="hljs-built_in">memset</span>(v11, <span class="hljs-number">0</span>, n);<br>  v20 = v17;<br>  v18 = n - <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">while</span> ( v20 &lt; v28 )<br>  &#123;<br>    v21 = *(<span class="hljs-type">unsigned</span> __int8 *)(v25 + v20);<br>    <span class="hljs-keyword">for</span> ( j = n - <span class="hljs-number">1</span>; ; --j )<br>    &#123;<br>      v10 = <span class="hljs-number">1</span>;<br>      <span class="hljs-keyword">if</span> ( j &lt;= v18 )<br>        v10 = v21 != <span class="hljs-number">0</span>;<br>      <span class="hljs-keyword">if</span> ( !v10 )<br>        <span class="hljs-keyword">break</span>;<br>      v22 = v11[j] &lt;&lt; <span class="hljs-number">6</span>;<br>      v21 += v11[j] &lt;&lt; <span class="hljs-number">8</span>;<br>      v9 = <span class="hljs-number">64</span>;<br>      v11[j] = v21 % <span class="hljs-number">58</span>;<br>      *((_BYTE *)v26 + j) = v22 &amp; <span class="hljs-number">0x3F</span>;<br>      v22 &gt;&gt;= <span class="hljs-number">6</span>;<br>      v21 /= <span class="hljs-number">58</span>;<br>      v27 /= v9;<br>      <span class="hljs-keyword">if</span> ( !j )<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>    ++v20;<br>    v18 = j;<br>  &#125;<br>  <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0LL</span>; ; ++j )<br>  &#123;<br>    v8 = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span> ( j &lt; n )<br>      v8 = ~(v11[j] != <span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">if</span> ( !(v8 &amp; <span class="hljs-number">1</span>) )<br>      <span class="hljs-keyword">break</span>;<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( *v30 &gt; n + v17 - j )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( v17 )<br>    &#123;<br>      c = <span class="hljs-number">61</span>;<br>      <span class="hljs-built_in">memset</span>(s, <span class="hljs-number">49</span>, v17);<br>      <span class="hljs-built_in">memset</span>(v26, c, v17);<br>    &#125;<br>    v20 = v17;<br>    <span class="hljs-keyword">while</span> ( j &lt; n )<br>    &#123;<br>      v4 = v11;<br>      *((_BYTE *)s + v20) = byte_400EB0[v11[j]];<br>      *((_BYTE *)v26 + v20++) = byte_400EF0[v4[j++]];<br>    &#125;<br>    *((_BYTE *)s + v20) = <span class="hljs-number">0</span>;<br>    *v30 = v20 + <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">strncmp</span>((<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)s, <span class="hljs-string">&quot;D9&quot;</span>, <span class="hljs-number">2uLL</span>)<br>      &amp;&amp; !<span class="hljs-built_in">strncmp</span>((<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)s + <span class="hljs-number">20</span>, <span class="hljs-string">&quot;Mp&quot;</span>, <span class="hljs-number">2uLL</span>)<br>      &amp;&amp; !<span class="hljs-built_in">strncmp</span>((<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)s + <span class="hljs-number">18</span>, <span class="hljs-string">&quot;MR&quot;</span>, <span class="hljs-number">2uLL</span>)<br>      &amp;&amp; !<span class="hljs-built_in">strncmp</span>((<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)s + <span class="hljs-number">2</span>, <span class="hljs-string">&quot;cS9N&quot;</span>, <span class="hljs-number">4uLL</span>)<br>      &amp;&amp; !<span class="hljs-built_in">strncmp</span>((<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)s + <span class="hljs-number">6</span>, <span class="hljs-string">&quot;9iHjM&quot;</span>, <span class="hljs-number">5uLL</span>)<br>      &amp;&amp; !<span class="hljs-built_in">strncmp</span>((<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)s + <span class="hljs-number">11</span>, <span class="hljs-string">&quot;LTdA8YS&quot;</span>, <span class="hljs-number">7uLL</span>) )<br>    &#123;<br>      HIDWORD(v6) = <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;correct!&quot;</span>);<br>    &#125;<br>    v32 = <span class="hljs-number">1</span>;<br>    v14 = <span class="hljs-number">1</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    *v30 = n + v17 - j + <span class="hljs-number">1</span>;<br>    v32 = <span class="hljs-number">0</span>;<br>    v14 = <span class="hljs-number">1</span>;<br>  &#125;<br>  <span class="hljs-keyword">return</span> v32 &amp; <span class="hljs-number">1</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>可以看到最后是s跟<code>D9cS9N9iHjMLTdA8YSMRMp</code>作比较<br>而s来自于v11</p>
<p>分析一下可能得到是base58编码，解码即可：base58_is_boring</p>
<h3 id="5-9"><a href="#5-9" class="headerlink" title="5.9"></a>5.9</h3><h4 id="ISCC-Pull-the-Wool-Over-People’s-Eyes"><a href="#ISCC-Pull-the-Wool-Over-People’s-Eyes" class="headerlink" title="ISCC  Pull the Wool Over People’s Eyes"></a>ISCC  Pull the Wool Over People’s Eyes</h4><p>比赛还是没结束捏，不能写wp</p>
<h4 id="CISCN-2022-东北-hana"><a href="#CISCN-2022-东北-hana" class="headerlink" title="[CISCN 2022 东北]hana"></a>[CISCN 2022 东北]hana</h4><p>upx壳，使用工具脱掉，幸好我有两个脱壳工具，只有一个能用，动调断在输入处，可以看到加密只有一个异或，比较处也可以找到密文，key反查一下，抄的exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python">cip = [<span class="hljs-number">0x56</span>,<span class="hljs-number">0xEC</span>,<span class="hljs-number">0xA0</span>,<span class="hljs-number">0xDC</span>,<span class="hljs-number">0x57</span>,<span class="hljs-number">0x06</span>,<span class="hljs-number">0xFE</span>,<span class="hljs-number">0xA3</span>,<span class="hljs-number">0xEB</span>,<span class="hljs-number">0x72</span>,<span class="hljs-number">0xEA</span>,<span class="hljs-number">0x97</span>,<span class="hljs-number">0xE2</span>,<span class="hljs-number">0x87</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0xAA</span>,<span class="hljs-number">0x18</span>,<span class="hljs-number">0x6A</span>,<span class="hljs-number">0xF3</span>,<span class="hljs-number">0xBE</span>,<span class="hljs-number">0xBD</span>,<span class="hljs-number">0xDA</span>,<span class="hljs-number">0x79</span>,<span class="hljs-number">0x0A</span>,<span class="hljs-number">0x98</span>,<span class="hljs-number">0x36</span>,<span class="hljs-number">0x12</span>,<span class="hljs-number">0x5C</span>,<span class="hljs-number">0xE0</span>,<span class="hljs-number">0x94</span>,<span class="hljs-number">0x61</span>,<span class="hljs-number">0x5A</span>, <span class="hljs-number">0x42</span>,<span class="hljs-number">0xBC</span>,<span class="hljs-number">0x4B</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x49</span>,<span class="hljs-number">0x7B</span>,<span class="hljs-number">0x5F</span>]<br><br>flag = <span class="hljs-string">&#x27;flag&#123;12345678876543211234567887654321&#125;&#x27;</span><br><br>cip2 = [<span class="hljs-number">0x56</span>,<span class="hljs-number">0xEC</span>,<span class="hljs-number">0xA0</span>,<span class="hljs-number">0xDC</span>,<span class="hljs-number">0x57</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0xF4</span>,<span class="hljs-number">0xA3</span>,<span class="hljs-number">0xE9</span>,<span class="hljs-number">0x77</span>,<span class="hljs-number">0xBF</span>,<span class="hljs-number">0x93</span>,<span class="hljs-number">0xBC</span>,<span class="hljs-number">0x86</span>,<span class="hljs-number">0x52</span>,<span class="hljs-number">0xA5</span>,<span class="hljs-number">0x14</span>,<span class="hljs-number">0x6A</span>,<span class="hljs-number">0xA5</span>,<span class="hljs-number">0xBD</span>,<span class="hljs-number">0xB5</span>,<span class="hljs-number">0xD2</span>,<span class="hljs-number">0x7F</span>,<span class="hljs-number">0x0B</span>,<span class="hljs-number">0x9B</span>,<span class="hljs-number">0x67</span>,<span class="hljs-number">0x1D</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0xEF</span>,<span class="hljs-number">0xC9</span>,<span class="hljs-number">0x32</span>,<span class="hljs-number">0x5D</span>,<span class="hljs-number">0x43</span>,<span class="hljs-number">0xED</span>,<span class="hljs-number">0x1E</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x4B</span>,<span class="hljs-number">0x7B</span>,<span class="hljs-number">0x01</span>]<br><br>flag2 = <span class="hljs-string">&#x27;&#x27;</span><br><br>key = []<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)):<br><br>    key.append(<span class="hljs-built_in">ord</span>(flag[i])^cip[i])<br><br><span class="hljs-built_in">print</span> key<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(key)):<br><br>    flag2 += <span class="hljs-built_in">chr</span>(key[i]^cip2[i])<br><br><span class="hljs-built_in">print</span> flag2<br><br></code></pre></td></tr></table></figure>

<h3 id="5-10"><a href="#5-10" class="headerlink" title="5.10"></a>5.10</h3><h4 id="HNCTF-2022-WEEK2-e-sy-flower"><a href="#HNCTF-2022-WEEK2-e-sy-flower" class="headerlink" title="[HNCTF 2022 WEEK2]e@sy_flower"></a>[HNCTF 2022 WEEK2]e@sy_flower</h4><p>简单的花指令，找到冒红的地方，先u重定义，再将第一个字节改为nop，回到上面main函数那按p重建函数，f5即可反编译</p>
<p>直接逆写即可：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python">enc = <span class="hljs-built_in">list</span>(<span class="hljs-string">&#x27;c~scvdzKCEoDEZ[^roDICUMC&#x27;</span>)<br>flag = []<br><br><span class="hljs-comment"># 与 0x30异或</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    flag.append(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(enc[i]) ^ <span class="hljs-number">0x30</span>))<br><br><span class="hljs-comment">#</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">len</span>(flag) / <span class="hljs-number">2</span>)):<br>    tmp = flag[<span class="hljs-number">2</span> * i]<br>    flag[<span class="hljs-number">2</span> * i] = flag[<span class="hljs-number">2</span> * i + <span class="hljs-number">1</span>]<br>    flag[<span class="hljs-number">2</span> * i + <span class="hljs-number">1</span>] = tmp<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag:<br>    <span class="hljs-built_in">print</span>(i, end=<span class="hljs-string">&#x27;&#x27;</span>)<br>    <br>    <span class="hljs-comment">#NSSCTF&#123;Just_junk_Bytess&#125;</span><br></code></pre></td></tr></table></figure>

<h4 id="luck-guy"><a href="#luck-guy" class="headerlink" title="luck_guy"></a>luck_guy</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">b = a.to_bytes(<span class="hljs-number">8</span>, byteorder=<span class="hljs-string">&#x27;little&#x27;</span>)<br><span class="hljs-built_in">print</span>(b)<br>c = <span class="hljs-built_in">list</span>(b)<br><span class="hljs-built_in">print</span>(c)<br>flag = <span class="hljs-string">&#x27;&#x27;</span><br>flag0 = <span class="hljs-string">&#x27;GXY&#123;do_not_&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>    <span class="hljs-keyword">if</span> i % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:<br>        flag += <span class="hljs-built_in">chr</span>((c[i]) - <span class="hljs-number">2</span>)<br>    <span class="hljs-keyword">else</span>:<br>        flag += <span class="hljs-built_in">chr</span>((c[i]) - <span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(flag0 + flag)<br><br></code></pre></td></tr></table></figure>

<h3 id="5-11"><a href="#5-11" class="headerlink" title="5.11"></a>5.11</h3><h4 id="hackme"><a href="#hackme" class="headerlink" title="hackme"></a>hackme</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">sub_400F8E</span><span class="hljs-params">(__int64 a1, __int64 a2)</span><br>&#123;<br>  <span class="hljs-type">char</span> v3[<span class="hljs-number">136</span>]; <span class="hljs-comment">// [rsp+10h] [rbp-B0h]</span><br>  <span class="hljs-type">int</span> v4; <span class="hljs-comment">// [rsp+98h] [rbp-28h]</span><br>  <span class="hljs-type">char</span> v5; <span class="hljs-comment">// [rsp+9Fh] [rbp-21h]</span><br>  <span class="hljs-type">int</span> v6; <span class="hljs-comment">// [rsp+A0h] [rbp-20h]</span><br>  <span class="hljs-type">unsigned</span> __int8 v7; <span class="hljs-comment">// [rsp+A6h] [rbp-1Ah]</span><br>  <span class="hljs-type">char</span> v8; <span class="hljs-comment">// [rsp+A7h] [rbp-19h]</span><br>  <span class="hljs-type">int</span> v9; <span class="hljs-comment">// [rsp+A8h] [rbp-18h]</span><br>  <span class="hljs-type">int</span> v10; <span class="hljs-comment">// [rsp+ACh] [rbp-14h]</span><br>  <span class="hljs-type">int</span> v11; <span class="hljs-comment">// [rsp+B0h] [rbp-10h]</span><br>  <span class="hljs-type">int</span> v12; <span class="hljs-comment">// [rsp+B4h] [rbp-Ch]</span><br>  _BOOL4 v13; <span class="hljs-comment">// [rsp+B8h] [rbp-8h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+BCh] [rbp-4h]</span><br><br>  sub_407470((__int64)<span class="hljs-string">&quot;Give me the password: &quot;</span>, a2);<br>  sub_4075A0((__int64)<span class="hljs-string">&quot;%s&quot;</span>, v3);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; v3[i]; ++i )<br>    ;<br>  v13 = i == <span class="hljs-number">22</span>;<br>  v12 = <span class="hljs-number">10</span>;<br>  <span class="hljs-keyword">do</span><br>  &#123;<br>    v9 = (<span class="hljs-type">signed</span> <span class="hljs-type">int</span>)sub_406D90(<span class="hljs-string">&quot;%s&quot;</span>, v3) % <span class="hljs-number">22</span>;<br>    v11 = <span class="hljs-number">0</span>;<br>    v8 = byte_6B4270[v9];<br>    v7 = v3[v9];<br>    v6 = v9 + <span class="hljs-number">1</span>;<br>    v10 = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> ( v10 &lt; v6 )<br>    &#123;<br>      ++v10;<br>      v11 = <span class="hljs-number">1828812941</span> * v11 + <span class="hljs-number">12345</span>;<br>    &#125;<br>    v5 = v11 ^ v7;<br>    <span class="hljs-keyword">if</span> ( v8 != ((<span class="hljs-type">unsigned</span> __int8)v11 ^ v7) )<br>      v13 = <span class="hljs-number">0</span>;<br>    --v12;<br>  &#125;<br>  <span class="hljs-keyword">while</span> ( v12 );<br>  <span class="hljs-keyword">if</span> ( v13 )<br>    v4 = sub_407470((__int64)<span class="hljs-string">&quot;Congras\n&quot;</span>);<br>  <span class="hljs-keyword">else</span><br>    v4 = sub_407470((__int64)<span class="hljs-string">&quot;Oh no!\n&quot;</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解密：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">index = [<span class="hljs-number">0x5F</span>,<span class="hljs-number">0xF2</span>,<span class="hljs-number">0x5E</span>,<span class="hljs-number">0x8B</span>,<span class="hljs-number">0x4E</span>,<span class="hljs-number">0x0E</span>,<span class="hljs-number">0xA3</span>,<span class="hljs-number">0xAA</span>,<span class="hljs-number">0xC7</span>,<span class="hljs-number">0x93</span>,<span class="hljs-number">0x81</span>,<span class="hljs-number">0x3D</span>,<span class="hljs-number">0x5F</span>,<span class="hljs-number">0x74</span>,<span class="hljs-number">0xA3</span>,<span class="hljs-number">0x09</span>,<br><span class="hljs-number">0x91</span>,<span class="hljs-number">0x2B</span>,<span class="hljs-number">0x49</span>,<span class="hljs-number">0x28</span>,<span class="hljs-number">0x93</span>,<span class="hljs-number">0x67</span>]<br><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">22</span>):<br>    v6 = i + <span class="hljs-number">1</span><br>    v10 = <span class="hljs-number">0</span><br>    v11 = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> v10 &lt; v6:<br>        v10 = v10 + <span class="hljs-number">1</span><br>        v11 = <span class="hljs-number">1828812941</span> * v11 + <span class="hljs-number">12345</span><br>    flag += <span class="hljs-built_in">chr</span>((index[i]^v11)&amp;<span class="hljs-number">0xff</span>)<br><span class="hljs-built_in">print</span> (flag)<br></code></pre></td></tr></table></figure>



<h4 id="SignIn"><a href="#SignIn" class="headerlink" title="SignIn"></a>SignIn</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br>q = <span class="hljs-number">282164587459512124844245113950593348271</span><br>p = <span class="hljs-number">366669102002966856876605669837014229419</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">0xad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35</span><br>n = <span class="hljs-number">103461035900816914121390101299049044413950405173712170434161686539878160984549</span><br> <br>d = libnum.invmod(e, (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>))		<span class="hljs-comment">#invmod(a, n) - 求a对于n的模逆,这里逆向加密过程中计算ψ(n)=(p-1)(q-1)，对ψ(n)保密,也就是对应根据e*d=1modψ(n),求出d</span><br>m = <span class="hljs-built_in">pow</span>(c, d, n)   <span class="hljs-comment"># 这里的m是十进制形式,pow(x, y[, z])--函数是计算 x 的 y 次方，如果 z 在存在，则再对结果进行取模，其结果等效于 pow(x,y) %z，对应前面解密算法中M=D(C)=（C^d）mod n</span><br>string = long_to_bytes(m)  <span class="hljs-comment"># 获取m明文</span><br><span class="hljs-built_in">print</span>(string)<br><br></code></pre></td></tr></table></figure>

<h3 id="5-12"><a href="#5-12" class="headerlink" title="5.12"></a>5.12</h3><h4 id="强网杯-2022-GameMaster"><a href="#强网杯-2022-GameMaster" class="headerlink" title="[强网杯 2022]GameMaster"></a>[强网杯 2022]GameMaster</h4><p>c#逆向 dnspy打开，可以看到main函数一开始就打开了gamemessage文件，这个文件也是题目给出的</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c#">FileStream fileStream = File.OpenRead(<span class="hljs-string">&quot;gamemessage&quot;</span>);<br><span class="hljs-built_in">int</span> num = (<span class="hljs-built_in">int</span>)fileStream.Length;<br>Program.memory = <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span>[num];<br>fileStream.Position = <span class="hljs-number">0L</span>;<br>fileStream.Read(Program.memory, <span class="hljs-number">0</span>, num);<br></code></pre></td></tr></table></figure>

<p>将该文件传给了memory，在goldfunc函数里异或了34</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c#"><span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; Program.memory.Length; i++)<br>&#123;<br>	<span class="hljs-built_in">byte</span>[] array = Program.memory;<br>	<span class="hljs-built_in">int</span> num = i;<br>	array[num] ^= <span class="hljs-number">34</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>将memory 用AES，ECB 解密生成ExploitClass.dll</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs c#"><span class="hljs-built_in">byte</span>[] key = <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span>[]<br>&#123;<br>	<span class="hljs-number">66</span>,<br>	<span class="hljs-number">114</span>,<br>	<span class="hljs-number">97</span>,<br>	<span class="hljs-number">105</span>,<br>	<span class="hljs-number">110</span>,<br>	<span class="hljs-number">115</span>,<br>	<span class="hljs-number">116</span>,<br>	<span class="hljs-number">111</span>,<br>	<span class="hljs-number">114</span>,<br>	<span class="hljs-number">109</span>,<br>	<span class="hljs-number">105</span>,<br>	<span class="hljs-number">110</span>,<br>	<span class="hljs-number">103</span>,<br>	<span class="hljs-number">33</span>,<br>	<span class="hljs-number">33</span>,<br>	<span class="hljs-number">33</span><br>&#125;;<br>ICryptoTransform cryptoTransform = <span class="hljs-keyword">new</span> RijndaelManaged<br>&#123;<br>	Key = key,<br>	Mode = CipherMode.ECB,<br>	Padding = PaddingMode.Zeros<br>&#125;.CreateDecryptor();<br>Program.m = cryptoTransform.TransformFinalBlock(Program.memory, <span class="hljs-number">0</span>, Program.memory.Length);<br></code></pre></td></tr></table></figure>

<p>所以，解密：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">data = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;gamemessage&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>).read()<br>data = <span class="hljs-built_in">bytes</span>([v^<span class="hljs-number">0x22</span> <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> data])<br> <br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br> <br>key = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0x42</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">110</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x6f</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x6d</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">110</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x21</span>])<br>aes = AES.new(key,AES.MODE_ECB)<br>m = aes.decrypt(data)<br> <br>pos = <span class="hljs-number">0x13eb</span><br>m = m[pos:]+m[:pos]<br><span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;temp.dll&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>).write(m)<br></code></pre></td></tr></table></figure>

<p>查看PE，发现了MZ文件头，把前面的删掉，还是一个c#程序，继续拖入dnspy</p>
<p>先看看key是啥，仿写即可：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c">private <span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title function_">ParseKey</span><span class="hljs-params">(ulong[] L, byte[] Key)</span><br>&#123;<br>	<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++)<br>	&#123;<br>		<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">4</span>; j++)<br>		&#123;<br>			Key[i * <span class="hljs-number">4</span> + j] = (byte)((L[i] &gt;&gt; j * <span class="hljs-number">8</span>) &amp; <span class="hljs-number">255UL</span>);<br>		&#125;<br>	&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>check函数：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c#"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Check1</span>(<span class="hljs-params"><span class="hljs-built_in">ulong</span> x, <span class="hljs-built_in">ulong</span> y, <span class="hljs-built_in">ulong</span> z, <span class="hljs-built_in">byte</span>[] KeyStream</span>)</span><br>&#123;<br>	<span class="hljs-built_in">int</span> num = <span class="hljs-number">-1</span>;<br>	<span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">320</span>; i++)<br>	&#123;<br>		x = (((x &gt;&gt; <span class="hljs-number">29</span>) ^ (x &gt;&gt; <span class="hljs-number">28</span>) ^ (x &gt;&gt; <span class="hljs-number">25</span>) ^ (x &gt;&gt; <span class="hljs-number">23</span>)) &amp; <span class="hljs-number">1U</span>L) | (x &lt;&lt; <span class="hljs-number">1</span>);<br>		y = (((y &gt;&gt; <span class="hljs-number">30</span>) ^ (y &gt;&gt; <span class="hljs-number">27</span>)) &amp; <span class="hljs-number">1U</span>L) | (y &lt;&lt; <span class="hljs-number">1</span>);<br>		z = (((z &gt;&gt; <span class="hljs-number">31</span>) ^ (z &gt;&gt; <span class="hljs-number">30</span>) ^ (z &gt;&gt; <span class="hljs-number">29</span>) ^ (z &gt;&gt; <span class="hljs-number">28</span>) ^ (z &gt;&gt; <span class="hljs-number">26</span>) ^ (z &gt;&gt; <span class="hljs-number">24</span>)) &amp; <span class="hljs-number">1U</span>L) | (z &lt;&lt; <span class="hljs-number">1</span>);<br>		<span class="hljs-built_in">bool</span> flag = i % <span class="hljs-number">8</span> == <span class="hljs-number">0</span>;<br>		<span class="hljs-keyword">if</span> (flag)<br>		&#123;<br>			num++;<br>		&#125;<br>		KeyStream[num] = (<span class="hljs-built_in">byte</span>)((<span class="hljs-built_in">long</span>)((<span class="hljs-built_in">long</span>)KeyStream[num] &lt;&lt; <span class="hljs-number">1</span>) | (<span class="hljs-built_in">long</span>)((<span class="hljs-built_in">ulong</span>)((<span class="hljs-built_in">uint</span>)(((z &gt;&gt; <span class="hljs-number">32</span>) &amp; <span class="hljs-number">1U</span>L &amp; ((x &gt;&gt; <span class="hljs-number">30</span>) &amp; <span class="hljs-number">1U</span>L)) ^ ((((z &gt;&gt; <span class="hljs-number">32</span>) &amp; <span class="hljs-number">1U</span>L) ^ <span class="hljs-number">1U</span>L) &amp; ((y &gt;&gt; <span class="hljs-number">31</span>) &amp; <span class="hljs-number">1U</span>L))))));<br>	&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>



<p>z3解方程：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> z3<br>first=[<span class="hljs-number">101</span>,<span class="hljs-number">5</span>,<span class="hljs-number">80</span>,<span class="hljs-number">213</span>,<span class="hljs-number">163</span>,<span class="hljs-number">26</span>,<span class="hljs-number">59</span>,<span class="hljs-number">38</span>,<span class="hljs-number">19</span>,<span class="hljs-number">6</span>,<span class="hljs-number">173</span>,<span class="hljs-number">189</span>,<span class="hljs-number">198</span>,<span class="hljs-number">166</span>,<span class="hljs-number">140</span>,<span class="hljs-number">183</span>,<span class="hljs-number">42</span>,<span class="hljs-number">247</span>,<span class="hljs-number">223</span>,<span class="hljs-number">24</span>,<span class="hljs-number">106</span>,<span class="hljs-number">20</span>,<span class="hljs-number">145</span>,<span class="hljs-number">37</span>,<span class="hljs-number">24</span>,<span class="hljs-number">7</span>,<span class="hljs-number">22</span>,<span class="hljs-number">191</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(first))<br>tmp=<span class="hljs-built_in">len</span>(first)*[<span class="hljs-number">0</span>]<br>num = -<span class="hljs-number">1</span><br>x = z3.BitVec(<span class="hljs-string">&quot;v1&quot;</span>, <span class="hljs-number">64</span>) <span class="hljs-comment">#64位的v1</span><br>y = z3.BitVec(<span class="hljs-string">&quot;v2&quot;</span>, <span class="hljs-number">64</span>)<br>z = z3.BitVec(<span class="hljs-string">&quot;v3&quot;</span>, <span class="hljs-number">64</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">320</span>):<br>x = (((x &gt;&gt; <span class="hljs-number">29</span> ^ x &gt;&gt; <span class="hljs-number">28</span> ^ x &gt;&gt; <span class="hljs-number">25</span> ^ x &gt;&gt; <span class="hljs-number">23</span>) &amp; <span class="hljs-number">1</span>) | x &lt;&lt; <span class="hljs-number">1</span>)<br>y = (((y &gt;&gt; <span class="hljs-number">30</span> ^ y &gt;&gt; <span class="hljs-number">27</span>) &amp; <span class="hljs-number">1</span>) | y &lt;&lt; <span class="hljs-number">1</span>)<br>z = (((z &gt;&gt; <span class="hljs-number">31</span> ^ z &gt;&gt; <span class="hljs-number">30</span> ^ z &gt;&gt; <span class="hljs-number">29</span> ^ z &gt;&gt; <span class="hljs-number">28</span> ^ z &gt;&gt; <span class="hljs-number">26</span> ^ z &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">1</span>) | z &lt;&lt; <span class="hljs-number">1</span>)<br><span class="hljs-keyword">if</span> i%<span class="hljs-number">8</span>==<span class="hljs-number">0</span>:<br>num+=<span class="hljs-number">1</span><br>tmp[num] = tmp[num] &lt;&lt; <span class="hljs-number">1</span> | (z &gt;&gt; <span class="hljs-number">32</span> &amp; <span class="hljs-number">1</span> &amp; (x &gt;&gt; <span class="hljs-number">30</span> &amp; <span class="hljs-number">1</span>)) ^ (((z &gt;&gt; <span class="hljs-number">32</span> &amp; <span class="hljs-number">1</span>) ^ <span class="hljs-number">1</span>) &amp; (y &gt;&gt; <span class="hljs-number">31</span> &amp; <span class="hljs-number">1</span>)<br>solver = z3.Solver()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(first)):<br>solver.add(first[i] == tmp[i])<br>solver.check()<br><span class="hljs-built_in">print</span>(solver.model())<br><span class="hljs-comment"># [v3 = 3131229747, v1 = 156324965, v2 = 868387187</span><br></code></pre></td></tr></table></figure>

<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">l=[<span class="hljs-number">156324965</span>, <span class="hljs-number">868387187</span>, <span class="hljs-number">3131229747</span>]<br>arr=[<span class="hljs-number">0</span>]*<span class="hljs-number">12</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>        arr[i*<span class="hljs-number">4</span>+j]=(l[i]&gt;&gt;j*<span class="hljs-number">8</span>)&amp;<span class="hljs-number">0xff</span><br>enc=[<span class="hljs-number">60</span>, <span class="hljs-number">100</span>, <span class="hljs-number">36</span>, <span class="hljs-number">86</span>, <span class="hljs-number">51</span>, <span class="hljs-number">251</span>, <span class="hljs-number">167</span>, <span class="hljs-number">108</span>, <span class="hljs-number">116</span>, <span class="hljs-number">245</span>,<br>				<span class="hljs-number">207</span>, <span class="hljs-number">223</span>, <span class="hljs-number">40</span>, <span class="hljs-number">103</span>, <span class="hljs-number">34</span>, <span class="hljs-number">62</span>, <span class="hljs-number">22</span>, <span class="hljs-number">251</span>, <span class="hljs-number">227</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(enc[i]^arr[i%<span class="hljs-built_in">len</span>(arr)]),end=<span class="hljs-string">&#x27;&#x27;</span>)<br><br></code></pre></td></tr></table></figure>

<h4 id="xctf-babymips"><a href="#xctf-babymips" class="headerlink" title="xctf babymips"></a>xctf babymips</h4><p>main函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __fastcall <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> a1, <span class="hljs-type">char</span> **a2, <span class="hljs-type">char</span> **a3)</span><br>&#123;<br>  <span class="hljs-type">int</span> result; <span class="hljs-comment">// $v0</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [sp+18h] [+18h] BYREF</span><br>  <span class="hljs-type">char</span> v5[<span class="hljs-number">36</span>]; <span class="hljs-comment">// [sp+1Ch] [+1Ch] BYREF</span><br><br>  setbuf((FILE *)<span class="hljs-built_in">stdout</span>, <span class="hljs-number">0</span>);<br>  setbuf((FILE *)<span class="hljs-built_in">stdin</span>, <span class="hljs-number">0</span>);<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Give me your flag:&quot;</span>);<br>  <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%32s&quot;</span>, v5);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; ++i )<br>    *((_BYTE *)&amp;i + i + <span class="hljs-number">4</span>) ^= <span class="hljs-number">32</span> - (_BYTE)i;<br>  <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">strncmp</span>(v5, fdata, <span class="hljs-number">5u</span>) )<br>    result = sub_4007F0(v5);<br>  <span class="hljs-keyword">else</span><br>    result = <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Wrong&quot;</span>);<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __fastcall <span class="hljs-title function_">sub_4007F0</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *a1)</span><br>&#123;<br>  <span class="hljs-type">char</span> v1; <span class="hljs-comment">// $v1</span><br>  <span class="hljs-type">int</span> result; <span class="hljs-comment">// $v0</span><br>  <span class="hljs-type">size_t</span> i; <span class="hljs-comment">// [sp+18h] [+18h]</span><br><br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">5</span>; i &lt; <span class="hljs-built_in">strlen</span>(a1); ++i )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( (i &amp; <span class="hljs-number">1</span>) != <span class="hljs-number">0</span> )<br>      v1 = (a1[i] &gt;&gt; <span class="hljs-number">2</span>) | (a1[i] &lt;&lt; <span class="hljs-number">6</span>);  <span class="hljs-comment">//把低二位和高六位进行交换</span><br>    <span class="hljs-keyword">else</span><br>      v1 = (<span class="hljs-number">4</span> * a1[i]) | (a1[i] &gt;&gt; <span class="hljs-number">6</span>);<br>    a1[i] = v1;<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">strncmp</span>(a1 + <span class="hljs-number">5</span>, (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)off_410D04, <span class="hljs-number">0x1B</span>u) )<br>    result = <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Right!&quot;</span>);<br>  <span class="hljs-keyword">else</span><br>    result = <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Wrong!&quot;</span>);<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">part1=<span class="hljs-string">b&#x27;Q|j&#123;g&#x27;</span><br>part2=<span class="hljs-string">&#x27;52 fd 16 a4 89 bd 92 80 13 41 54 a0 8d 45 18 81 de fc 95 f0 16 79 1a 15 5b 75 1f&#x27;</span><br>part2=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">bytes</span>.fromhex(part2))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>,<span class="hljs-built_in">len</span>(part2)+<span class="hljs-number">5</span>):<br>    t = part2[i-<span class="hljs-number">5</span>]<br>    <span class="hljs-keyword">if</span> i&amp;<span class="hljs-number">1</span>==<span class="hljs-number">0</span>:   <span class="hljs-comment">#偶数时&amp;1 为0</span><br>        part2[i-<span class="hljs-number">5</span>]=(t&amp;<span class="hljs-number">0x3</span>)&lt;&lt;<span class="hljs-number">6</span>|(t&amp;<span class="hljs-number">0xfc</span>)&gt;&gt;<span class="hljs-number">2</span>   <span class="hljs-comment">#低2位左移6位，高6位右移2位  相当于循环右移2位</span><br>    <span class="hljs-keyword">else</span>:<br>        part2[i-<span class="hljs-number">5</span>]=(t&amp;<span class="hljs-number">0x3f</span>)&lt;&lt;<span class="hljs-number">2</span>|(t&amp;<span class="hljs-number">0xc0</span>)&gt;&gt;<span class="hljs-number">6</span>  <span class="hljs-comment">#低6位左移2位，高2位右移6位  相当于循环左移2位</span><br><br>temp=<span class="hljs-built_in">list</span>(part1)+part2<br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(temp)):<br>    flag+=<span class="hljs-built_in">chr</span>(temp[i]^<span class="hljs-number">0x20</span> -i)<br><span class="hljs-built_in">print</span>(flag)<br><br></code></pre></td></tr></table></figure>

<h3 id="5-13"><a href="#5-13" class="headerlink" title="5.13"></a>5.13</h3><h4 id="litctf-逆向wp-shimmer’s-blog-shimmer123456-github-io"><a href="#litctf-逆向wp-shimmer’s-blog-shimmer123456-github-io" class="headerlink" title="litctf 逆向wp | shimmer’s blog (shimmer123456.github.io)"></a><a target="_blank" rel="noopener" href="https://shimmer123456.github.io/2023/05/13/litctf/">litctf 逆向wp | shimmer’s blog (shimmer123456.github.io)</a></h4><h3 id="5-14"><a href="#5-14" class="headerlink" title="5.14"></a>5.14</h3><h4 id="春秋杯-Poisoned-tea-CHELL（壳是真难脱啊，还好我脱掉了）"><a href="#春秋杯-Poisoned-tea-CHELL（壳是真难脱啊，还好我脱掉了）" class="headerlink" title="春秋杯 Poisoned_tea_CHELL（壳是真难脱啊，还好我脱掉了）"></a>春秋杯 Poisoned_tea_CHELL（壳是真难脱啊，还好我脱掉了）</h4><h4 id="春秋杯-sum"><a href="#春秋杯-sum" class="headerlink" title="春秋杯 sum"></a>春秋杯 sum</h4><p>比赛还没结束捏，不能写wp，（目前为止逆向ak，嘿嘿）贴个图算了：</p>
<p><img src="https://raw.githubusercontent.com/shimmer123456/img/main/img/202305142042959.png" alt="image-20230514204252391"></p>
<h3 id="5-15"><a href="#5-15" class="headerlink" title="5.15"></a>5.15</h3><h4 id="SWPUCTF-2021-新生赛-fakebase"><a href="#SWPUCTF-2021-新生赛-fakebase" class="headerlink" title="[SWPUCTF 2021 新生赛]fakebase"></a>[SWPUCTF 2021 新生赛]fakebase</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python">flag = <span class="hljs-string">&#x27;xxxxxxxxxxxxxxxxxxx&#x27;</span><br><br>s_box = <span class="hljs-string">&#x27;qwertyuiopasdfghjkzxcvb123456#$&#x27;</span><br>tmp = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag:<br>    tmp += <span class="hljs-built_in">str</span>(<span class="hljs-built_in">bin</span>(<span class="hljs-built_in">ord</span>(i)))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>)<br>b1 = <span class="hljs-built_in">int</span>(tmp,<span class="hljs-number">2</span>)<br>s = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">while</span> b1//<span class="hljs-number">31</span> != <span class="hljs-number">0</span>:<br>    s += s_box[b1%<span class="hljs-number">31</span>]<br>    b1 = b1//<span class="hljs-number">31</span><br><br><span class="hljs-built_in">print</span>(s)<br><br><span class="hljs-comment"># s = u#k4ggia61egegzjuqz12jhfspfkay</span><br></code></pre></td></tr></table></figure>

<p>其中<code>s</code>的值都是<code>s_box</code>中取的，因此<code>[b1%31]</code>是可以得知的。也就是</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">s_box = <span class="hljs-string">&#x27;qwertyuiopasdfghjkzxcvb123456#$&#x27;</span><br>s = <span class="hljs-string">&#x27;u#k4ggia61egegzjuqz12jhfspfkay&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s:<br>	b1 = k*<span class="hljs-number">31</span>+s_box.index(i)<br></code></pre></td></tr></table></figure>

<p>我们是从0开始爆破，因为b1是从大每次整除<code>31</code>，依次减小的，因此我们<code>s</code>选好 是需要逆序。因此：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">s_box = <span class="hljs-string">&#x27;qwertyuiopasdfghjkzxcvb123456#$&#x27;</span><br>s = <span class="hljs-string">&#x27;u#k4ggia61egegzjuqz12jhfspfkay&#x27;</span><br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>	b1=k<br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s[::-<span class="hljs-number">1</span>]:<br>		b1 = b1*<span class="hljs-number">31</span>+s_box.index(i)<br></code></pre></td></tr></table></figure>

<p>最后直接将整数转换为字符串即可：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br>s_box = <span class="hljs-string">&#x27;qwertyuiopasdfghjkzxcvb123456#$&#x27;</span><br>s = <span class="hljs-string">&#x27;u#k4ggia61egegzjuqz12jhfspfkay&#x27;</span><br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>	b1=k<br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s[::-<span class="hljs-number">1</span>]:<br>		b1 = b1*<span class="hljs-number">31</span>+s_box.index(i)<br>	<span class="hljs-built_in">print</span>(libnum.n2s(<span class="hljs-built_in">int</span>(b1)))<br></code></pre></td></tr></table></figure>



<h4 id="SWPUCTF-2021-新生赛-fakerandom"><a href="#SWPUCTF-2021-新生赛-fakerandom" class="headerlink" title="[SWPUCTF 2021 新生赛]fakerandom"></a>[SWPUCTF 2021 新生赛]fakerandom</h4><p>逆着逻辑好了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-keyword">import</span> random<br>random.seed(<span class="hljs-number">1</span>)<br>l = []<br>flag=“”<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>l.append(random.getrandbits(<span class="hljs-number">8</span>))<br>result = [<span class="hljs-number">201</span>, <span class="hljs-number">8</span>, <span class="hljs-number">198</span>, <span class="hljs-number">68</span>, <span class="hljs-number">131</span>, <span class="hljs-number">152</span>, <span class="hljs-number">186</span>, <span class="hljs-number">136</span>, <span class="hljs-number">13</span>, <span class="hljs-number">130</span>, <span class="hljs-number">190</span>, <span class="hljs-number">112</span>, <span class="hljs-number">251</span>, <span class="hljs-number">93</span>, <span class="hljs-number">212</span>, <span class="hljs-number">1</span>, <span class="hljs-number">31</span>, <span class="hljs-number">214</span>, <span class="hljs-number">116</span>, <span class="hljs-number">244</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(l)):<br>random.seed(l[i])<br><span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>flag+=<span class="hljs-built_in">chr</span>(result[i*<span class="hljs-number">5</span>+n]^random.getrandbits(<span class="hljs-number">8</span>))<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#NSSCTF&#123;FakeE_random&#125;</span><br></code></pre></td></tr></table></figure>

<h3 id="5-16"><a href="#5-16" class="headerlink" title="5.16"></a>5.16</h3><h4 id="HGAME-2022-week1-easyasm"><a href="#HGAME-2022-week1-easyasm" class="headerlink" title="[HGAME 2022 week1]easyasm"></a>[HGAME 2022 week1]easyasm</h4><p>附件是16位的MS-DOS程序，用IDA分析start函数，代码不多，大意是将flag的每个字符前四位和后四位进行置换，然后与0x17异或，再与密文逐位比较。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;windows.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> cipher[] =<br>	&#123;<br>	  <span class="hljs-number">0x91</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x21</span>, <br>	  <span class="hljs-number">0x14</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0xC1</span>, <br>	  <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x17</span><br>	&#125;;<br>	<br>	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">28</span>; i++)<br>	&#123;<br>		<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> tmp = cipher[i]^<span class="hljs-number">0x17</span>;<br>		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, (tmp&lt;&lt;<span class="hljs-number">4</span>)+(tmp&gt;&gt;<span class="hljs-number">4</span>));<br>	&#125;<br>&#125; <br></code></pre></td></tr></table></figure>

<h4 id="WUSTCTF-2020-level3"><a href="#WUSTCTF-2020-level3" class="headerlink" title="[WUSTCTF 2020]level3"></a>[WUSTCTF 2020]level3</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c"> __int64 <span class="hljs-title function_">O_OLookAtYou</span><span class="hljs-params">()</span><br>&#123;<br>  __int64 result; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> v1; <span class="hljs-comment">// [rsp+1h] [rbp-5h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+2h] [rbp-4h]</span><br><br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">9</span>; ++i )<br>  &#123;<br>    v1 = base64_table[i];<br>    base64_table[i] = base64_table[<span class="hljs-number">19</span> - i];<br>    result = <span class="hljs-number">19</span> - i;<br>    base64_table[result] = v1;<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br><span class="hljs-comment">//数据交换</span><br>v1=base64_table[<span class="hljs-number">0</span>:<span class="hljs-number">9</span>]<br>base64_table[<span class="hljs-number">0</span>:<span class="hljs-number">9</span>]=base64_table[<span class="hljs-number">19</span>:<span class="hljs-number">10</span>]<br>base64_table[<span class="hljs-number">19</span>:<span class="hljs-number">10</span>]=base64_table[<span class="hljs-number">0</span>:<span class="hljs-number">9</span>]<br><br><br>ABCDEFGHIJ KLMNOPQRST UVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/<br>TSRQPONMLK JIHGFEDCBA UVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/<br></code></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> string<br><br>string = <span class="hljs-string">&quot;d2G0ZjLwHjS7DmOzZAY0X2lzX3CoZV9zdNOydO9vZl9yZXZlcnGlfD==&quot;</span><br>tableBase64 = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><br>tableNew =    <span class="hljs-string">&quot;TSRQPONMLKJIHGFEDCBAUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><br><br><br>maketrans = <span class="hljs-built_in">str</span>.maketrans(tableNew, tableBase64)<br>translate = string.translate(maketrans)<br>flag = base64.b64decode(translate)<br><span class="hljs-built_in">print</span> (flag)<br></code></pre></td></tr></table></figure>

<h3 id="5-17"><a href="#5-17" class="headerlink" title="5.17"></a>5.17</h3><h4 id="BJDCTF-2020-Easy-AmtuOrRF"><a href="#BJDCTF-2020-Easy-AmtuOrRF" class="headerlink" title="[BJDCTF 2020]Easy AmtuOrRF"></a>[BJDCTF 2020]Easy AmtuOrRF</h4><p>IDA pro 动调</p>
<p>1.先在 0x00401723 断点 方便查看flag</p>
<p>2.在0x0401773断点 运行到此</p>
<p>3.然后修改EIP 为 0x0401520</p>
<p>4.继续运行看cmd窗口得到flag</p>
<p>HACKIT4FUN</p>
<h4 id="HNCTF-2022-Week1-X0r"><a href="#HNCTF-2022-Week1-X0r" class="headerlink" title="[HNCTF 2022 Week1]X0r"></a>[HNCTF 2022 Week1]X0r</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br>f2 = [<span class="hljs-number">0x3FE</span>, <span class="hljs-number">0x3EB</span>,<span class="hljs-number">0x3EB</span>, <span class="hljs-number">0x3FB</span>, <span class="hljs-number">0x3E4</span>, <span class="hljs-number">0x3F6</span>, <span class="hljs-number">0x3D3</span>, <span class="hljs-number">0x3D0</span>, <span class="hljs-number">0x388</span>, <span class="hljs-number">0x3CA</span>, <span class="hljs-number">0x3EF</span>, <span class="hljs-number">0x389</span>, <span class="hljs-number">0x3CB</span>, <span class="hljs-number">0x3EF</span>, <span class="hljs-number">0x3CB</span>, <span class="hljs-number">0x388</span>, <span class="hljs-number">0x3EF</span>, <span class="hljs-number">0x3D5</span>, <span class="hljs-number">0x3D9</span>, <span class="hljs-number">0x3CB</span>, <span class="hljs-number">0x3D1</span>, <span class="hljs-number">0x3CD</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">22</span>):<br>    flag+=<span class="hljs-built_in">chr</span>((f2[i]-<span class="hljs-number">900</span>)^<span class="hljs-number">0x34</span>)<br><br><span class="hljs-built_in">print</span>(flag)<br><br><br></code></pre></td></tr></table></figure>

<h3 id="5-19"><a href="#5-19" class="headerlink" title="5.19"></a>5.19</h3><h4 id="2023春秋杯-sum"><a href="#2023春秋杯-sum" class="headerlink" title="[2023春秋杯  sum]"></a>[2023春秋杯  sum]</h4><p>main函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">char</span> *v3; <span class="hljs-comment">// rbp</span><br>  <span class="hljs-type">int</span> v4; <span class="hljs-comment">// r14d</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v5; <span class="hljs-comment">// r12d</span><br>  __int64 i; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">char</span> v7; <span class="hljs-comment">// al</span><br>  <span class="hljs-type">int</span> v8; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">const</span> <span class="hljs-type">char</span> *v9; <span class="hljs-comment">// rax</span><br><br>  v3 = (<span class="hljs-type">char</span> *)&amp;matrix;<br>  v4 = <span class="hljs-number">1</span>;<br>  v5 = <span class="hljs-number">0</span>;<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Welcome to Solver!&quot;</span>);<br>  <span class="hljs-keyword">do</span><br>  &#123;<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0LL</span>; i != <span class="hljs-number">9</span>; ++i )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( !v3[i] )<br>      &#123;<br>        v7 = getchar();<br>        <span class="hljs-keyword">if</span> ( (<span class="hljs-type">unsigned</span> __int8)(v7 - <span class="hljs-number">49</span>) &gt; <span class="hljs-number">8u</span> )<br>          v4 = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">else</span><br>          v3[i] = v7 - <span class="hljs-number">48</span>;<br>      &#125;<br>      v8 = v3[i];<br>      v5 += v8;<br>    &#125;<br>    v3 += <span class="hljs-number">9</span>;<br>  &#125;<br>  <span class="hljs-keyword">while</span> ( v3 != (<span class="hljs-type">char</span> *)&amp;matrix + <span class="hljs-number">81</span> );<br>  <span class="hljs-keyword">if</span> ( v4 &amp;&amp; (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)verify(<span class="hljs-string">&quot;Welcome to Solver!&quot;</span>, argv) )<br>  &#123;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;You Win!&quot;</span>);<br>    __snprintf_chk(buf, <span class="hljs-number">32LL</span>, <span class="hljs-number">1LL</span>, <span class="hljs-number">32LL</span>, <span class="hljs-string">&quot;%d&quot;</span>, v5);<br>    v9 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)str2md5(buf, <span class="hljs-built_in">strlen</span>(buf));<br>    __printf_chk(<span class="hljs-number">1LL</span>, <span class="hljs-string">&quot;flag is: flag&#123;%s&#125;\n\n&quot;</span>, v9);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>  &#125;<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Again~&quot;</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>首先是一个do while嵌套for的一个81次的循环，循环时当v3[i]的值等于0，会让用户输入一个字符，并且该输入必须在0-9之间</p>
<p>那么接下来进入verify函数：</p>
<p>不仔细看的话中等复杂，但他肯定是一段验证程序，因为它在if条件里嘛，满足条件就是win了。分析的话要么动调，要么为了省事直接问gpt（这个题效果还不错，有时候小心他会胡说八道）：</p>
<p>solve：</p>
<p>知道是数独，提取出81个数据，找个在线网站解一下数独，再运行程序填进去flag就输出了</p>
<h4 id="GDOUCTF-2023-doublegame"><a href="#GDOUCTF-2023-doublegame" class="headerlink" title="[GDOUCTF 2023]doublegame"></a>[GDOUCTF 2023]doublegame</h4><p>直接运行程序是一个贪吃蛇游戏，撞壁游戏就结束了。</p>
<p>拖入ida，因为没有main函数，所以通过字符串来定位关键逻辑，看到挺多0，跟进去，来到了这么一个函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> __noreturn <span class="hljs-title function_">sub_140012CF0</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">char</span> *v0; <span class="hljs-comment">// rdi</span><br>  __int64 i; <span class="hljs-comment">// rcx</span><br>  <span class="hljs-type">char</span> v2; <span class="hljs-comment">// [rsp+20h] [rbp+0h] BYREF</span><br>  <span class="hljs-type">char</span> Buffer[<span class="hljs-number">22</span>]; <span class="hljs-comment">// [rsp+30h] [rbp+10h] BYREF</span><br>  <span class="hljs-type">char</span> v4[<span class="hljs-number">44</span>]; <span class="hljs-comment">// [rsp+46h] [rbp+26h] BYREF</span><br>  <span class="hljs-type">char</span> v5[<span class="hljs-number">44</span>]; <span class="hljs-comment">// [rsp+72h] [rbp+52h] BYREF</span><br>  <span class="hljs-type">char</span> v6[<span class="hljs-number">44</span>]; <span class="hljs-comment">// [rsp+9Eh] [rbp+7Eh] BYREF</span><br>  <span class="hljs-type">char</span> v7[<span class="hljs-number">44</span>]; <span class="hljs-comment">// [rsp+CAh] [rbp+AAh] BYREF</span><br>  <span class="hljs-type">char</span> v8[<span class="hljs-number">44</span>]; <span class="hljs-comment">// [rsp+F6h] [rbp+D6h] BYREF</span><br>  <span class="hljs-type">char</span> v9[<span class="hljs-number">44</span>]; <span class="hljs-comment">// [rsp+122h] [rbp+102h] BYREF</span><br>  <span class="hljs-type">char</span> v10[<span class="hljs-number">44</span>]; <span class="hljs-comment">// [rsp+14Eh] [rbp+12Eh] BYREF</span><br>  <span class="hljs-type">char</span> v11[<span class="hljs-number">44</span>]; <span class="hljs-comment">// [rsp+17Ah] [rbp+15Ah] BYREF</span><br>  <span class="hljs-type">char</span> v12[<span class="hljs-number">44</span>]; <span class="hljs-comment">// [rsp+1A6h] [rbp+186h] BYREF</span><br>  <span class="hljs-type">char</span> v13[<span class="hljs-number">66</span>]; <span class="hljs-comment">// [rsp+1D2h] [rbp+1B2h] BYREF</span><br>  <span class="hljs-type">int</span> j; <span class="hljs-comment">// [rsp+214h] [rbp+1F4h]</span><br>  <span class="hljs-type">int</span> v15; <span class="hljs-comment">// [rsp+234h] [rbp+214h]</span><br>  <span class="hljs-type">int</span> v16; <span class="hljs-comment">// [rsp+254h] [rbp+234h]</span><br>  <span class="hljs-type">int</span> v17; <span class="hljs-comment">// [rsp+274h] [rbp+254h]</span><br>  <span class="hljs-type">int</span> v18; <span class="hljs-comment">// [rsp+294h] [rbp+274h]</span><br>  _DWORD v19[<span class="hljs-number">25</span>]; <span class="hljs-comment">// [rsp+2C0h] [rbp+2A0h] BYREF</span><br>  <span class="hljs-type">char</span> v20[<span class="hljs-number">100</span>]; <span class="hljs-comment">// [rsp+324h] [rbp+304h] BYREF</span><br>  <span class="hljs-type">char</span> v21[<span class="hljs-number">828</span>]; <span class="hljs-comment">// [rsp+388h] [rbp+368h] BYREF</span><br>  <span class="hljs-type">char</span> v22; <span class="hljs-comment">// [rsp+6C4h] [rbp+6A4h]</span><br>  <span class="hljs-type">int</span> v23; <span class="hljs-comment">// [rsp+6E4h] [rbp+6C4h]</span><br>  <span class="hljs-type">int</span> v24; <span class="hljs-comment">// [rsp+704h] [rbp+6E4h]</span><br><br>  v0 = &amp;v2;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">448</span>i64; i; --i )<br>  &#123;<br>    *(_DWORD *)v0 = <span class="hljs-number">-858993460</span>;<br>    v0 += <span class="hljs-number">4</span>;<br>  &#125;<br>  sub_14001141A(&amp;unk_1400290A6);<br>  <span class="hljs-built_in">strcpy</span>(Buffer, <span class="hljs-string">&quot;000000000000000000000&quot;</span>);<br>  <span class="hljs-built_in">strcpy</span>(v4, <span class="hljs-string">&quot;0 0 0 0     0     0 0&quot;</span>);<br>  <span class="hljs-built_in">strcpy</span>(&amp;v4[<span class="hljs-number">22</span>], <span class="hljs-string">&quot;0 0 0 00000 00000 0 0&quot;</span>);<br>  <span class="hljs-built_in">strcpy</span>(v5, <span class="hljs-string">&quot;0 0               0 0&quot;</span>);<br>  <span class="hljs-built_in">strcpy</span>(&amp;v5[<span class="hljs-number">22</span>], <span class="hljs-string">&quot;0 000 000 0 000 0 0 0&quot;</span>);<br>  <span class="hljs-built_in">strcpy</span>(v6, <span class="hljs-string">&quot;0 0     0 0 0   0 0 0&quot;</span>);<br>  <span class="hljs-built_in">strcpy</span>(&amp;v6[<span class="hljs-number">22</span>], <span class="hljs-string">&quot;0 0 0 00000 000 000 0&quot;</span>);<br>  <span class="hljs-built_in">strcpy</span>(v7, <span class="hljs-string">&quot;0 0 0     0   0 0    &quot;</span>);<br>  <span class="hljs-built_in">strcpy</span>(&amp;v7[<span class="hljs-number">22</span>], <span class="hljs-string">&quot;0 000 0 0 000 0 0 0 0&quot;</span>);<br>  <span class="hljs-built_in">strcpy</span>(v8, <span class="hljs-string">&quot;0     0 0 0 0 0 0 0 0&quot;</span>);<br>  <span class="hljs-built_in">strcpy</span>(&amp;v8[<span class="hljs-number">22</span>], <span class="hljs-string">&quot;0 00000 000 000 0 0 0&quot;</span>);<br>  <span class="hljs-built_in">strcpy</span>(v9, <span class="hljs-string">&quot;0     0       0   0 0&quot;</span>);<br>  <span class="hljs-built_in">strcpy</span>(&amp;v9[<span class="hljs-number">22</span>], <span class="hljs-string">&quot;000 0 0 0 000 0 0 0 0&quot;</span>);<br>  <span class="hljs-built_in">strcpy</span>(v10, <span class="hljs-string">&quot;0 0 0 0 0 0 * 0 0 0 0&quot;</span>);<br>  <span class="hljs-built_in">strcpy</span>(&amp;v10[<span class="hljs-number">22</span>], <span class="hljs-string">&quot;0 0000000 0 000 00000&quot;</span>);<br>  <span class="hljs-built_in">strcpy</span>(v11, <span class="hljs-string">&quot;@       0 0         0&quot;</span>);<br>  <span class="hljs-built_in">strcpy</span>(&amp;v11[<span class="hljs-number">22</span>], <span class="hljs-string">&quot;0 0 0 0 0 00000000000&quot;</span>);<br>  <span class="hljs-built_in">strcpy</span>(v12, <span class="hljs-string">&quot;0 0 0 0             0&quot;</span>);<br>  <span class="hljs-built_in">strcpy</span>(&amp;v12[<span class="hljs-number">22</span>], <span class="hljs-string">&quot;000 0 00000 0 000 000&quot;</span>);<br>  <span class="hljs-built_in">strcpy</span>(v13, <span class="hljs-string">&quot;0         0 0   0   0&quot;</span>);<br>  <span class="hljs-built_in">strcpy</span>(&amp;v13[<span class="hljs-number">22</span>], <span class="hljs-string">&quot;000000000000000000000&quot;</span>);<br>  v11[<span class="hljs-number">4</span>] = <span class="hljs-number">48</span>;<br>  <span class="hljs-built_in">strcpy</span>((<span class="hljs-type">char</span> *)v19, <span class="hljs-string">&quot;Please to save the cat!&quot;</span>);<br>  <span class="hljs-built_in">memset</span>(&amp;v19[<span class="hljs-number">6</span>], <span class="hljs-number">0</span>, <span class="hljs-number">0x4C</span>ui64);<br>  <span class="hljs-built_in">strcpy</span>(v20, <span class="hljs-string">&quot;the score is saving cat&#x27;s key!\n&quot;</span>);<br>  <span class="hljs-built_in">memset</span>(&amp;v20[<span class="hljs-number">32</span>], <span class="hljs-number">0</span>, <span class="hljs-number">0x44</span>ui64);<br>  qmemcpy(v21, &amp;unk_14001D340, <span class="hljs-number">0x47</span>ui64);<br>  <span class="hljs-built_in">memset</span>(&amp;v21[<span class="hljs-number">71</span>], <span class="hljs-number">0</span>, <span class="hljs-number">729</span>);<br>  sub_1400111F9(<span class="hljs-string">&quot;path\n&quot;</span>);<br>  v23 = <span class="hljs-number">0</span>;<br>  v24 = <span class="hljs-number">0</span>;<br>  v15 = <span class="hljs-number">15</span>;<br>  v16 = <span class="hljs-number">0</span>;<br>  v17 = <span class="hljs-number">7</span>;<br>  v18 = <span class="hljs-number">20</span>;<br>  <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">20</span>; ++j )<br>    <span class="hljs-built_in">puts</span>(&amp;Buffer[<span class="hljs-number">22</span> * j]);<br>  sub_1400111F9(<span class="hljs-string">&quot;Please to save the cat!\n&quot;</span>);<br>  <span class="hljs-keyword">while</span> ( v15 != v17 || v16 != v18 )<br>  &#123;<br>    v22 = getchar();<br>    <span class="hljs-keyword">switch</span> ( v22 )<br>    &#123;<br>      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;s&#x27;</span>:<br>        <span class="hljs-keyword">if</span> ( Buffer[<span class="hljs-number">22</span> * v15 + <span class="hljs-number">22</span> + v16] != <span class="hljs-number">48</span> )<br>        &#123;<br>          Buffer[<span class="hljs-number">22</span> * v15++ + v16] = <span class="hljs-number">32</span>;<br>          Buffer[<span class="hljs-number">22</span> * v15 + v16] = <span class="hljs-number">64</span>;<br>        &#125;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;w&#x27;</span>:<br>        <span class="hljs-keyword">if</span> ( Buffer[<span class="hljs-number">22</span> * v15 - <span class="hljs-number">22</span> + v16] != <span class="hljs-number">48</span> )<br>        &#123;<br>          Buffer[<span class="hljs-number">22</span> * v15-- + v16] = <span class="hljs-number">32</span>;<br>          Buffer[<span class="hljs-number">22</span> * v15 + v16] = <span class="hljs-number">64</span>;<br>        &#125;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;a&#x27;</span>:<br>        <span class="hljs-keyword">if</span> ( Buffer[<span class="hljs-number">22</span> * v15 - <span class="hljs-number">1</span> + v16] != <span class="hljs-number">48</span> )<br>        &#123;<br>          <span class="hljs-keyword">if</span> ( Buffer[<span class="hljs-number">22</span> * v15 - <span class="hljs-number">1</span> + v16] == <span class="hljs-number">42</span> )<br>            v7[<span class="hljs-number">20</span>] = <span class="hljs-number">48</span>;<br>          Buffer[<span class="hljs-number">22</span> * v15 + v16--] = <span class="hljs-number">32</span>;<br>          Buffer[<span class="hljs-number">22</span> * v15 + v16] = <span class="hljs-number">64</span>;<br>        &#125;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">default</span>:<br>        <span class="hljs-keyword">if</span> ( v22 == <span class="hljs-number">100</span> &amp;&amp; Buffer[<span class="hljs-number">22</span> * v15 + <span class="hljs-number">1</span> + v16] != <span class="hljs-number">48</span> )<br>        &#123;<br>          Buffer[<span class="hljs-number">22</span> * v15 + v16++] = <span class="hljs-number">32</span>;<br>          Buffer[<span class="hljs-number">22</span> * v15 + v16] = <span class="hljs-number">64</span>;<br>        &#125;<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>    system(<span class="hljs-string">&quot;cls&quot;</span>);<br>    <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">20</span>; ++j )<br>      <span class="hljs-built_in">puts</span>(&amp;Buffer[<span class="hljs-number">22</span> * j]);<br>    <span class="hljs-built_in">puts</span>((<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)&amp;v19[<span class="hljs-number">25</span> * v23]);<br>    <span class="hljs-keyword">if</span> ( v7[<span class="hljs-number">20</span>] == <span class="hljs-number">48</span> )<br>    &#123;<br>      v24 = sub_140011433(<span class="hljs-number">0</span>i64);<br>      <span class="hljs-keyword">if</span> ( v24 == <span class="hljs-number">13376013</span> )<br>      &#123;<br>        v23 = <span class="hljs-number">1</span>;<br>        v7[<span class="hljs-number">20</span>] = <span class="hljs-number">32</span>;<br>        Buffer[<span class="hljs-number">22</span> * v15 + v16] = <span class="hljs-number">32</span>;<br>        v15 = <span class="hljs-number">15</span>;<br>        v16 = <span class="hljs-number">0</span>;<br>        v11[<span class="hljs-number">0</span>] = <span class="hljs-number">64</span>;<br>        ++v23;<br>      &#125;<br>      <span class="hljs-keyword">else</span><br>      &#123;<br>        sub_1400111F9(<span class="hljs-string">&quot;error&quot;</span>);<br>      &#125;<br>    &#125;<br>  &#125;<br>  system(<span class="hljs-string">&quot;cls&quot;</span>);<br>  Sleep(<span class="hljs-number">0x1F4</span>u);<br>  Sleep(<span class="hljs-number">0xBB8</span>u);<br>  sub_140011492();<br>  <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>很明显是一个迷宫，但刚才的贪吃蛇哪去了（因为是double game啦），那么就再交叉引用看看谁调用了这个迷宫的函数，一直可以追到贪吃蛇游戏里</p>
<p>这个dword_140022CD0就是当前得分了，当它＞13371337时就会跳转到迷宫游戏</p>
<p>逻辑清楚了，那么在判断分数前下个断点，贪吃蛇游戏结束之后断下来，修改两次标志位（sf）跳转到迷宫游戏</p>
<p>接下来通过wsad控制上下左右走迷宫，先把小猫救出来后，程序会让输入key（其实就是贪吃蛇分数13371337），也可以通过判断key的逻辑再把key逆出来：</p>
<p>输入key之后，又回到原点了，再走一下迷宫，flag就是{key+md5(最短路径)}</p>
<h3 id="5-20"><a href="#5-20" class="headerlink" title="5.20"></a>5.20</h3><h4 id="LitCTF-2023-enbase64"><a href="#LitCTF-2023-enbase64" class="headerlink" title="[LitCTF 2023]enbase64"></a>[LitCTF 2023]enbase64</h4><p>变表base64，下断点dump出变表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#python</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">basechange</span>(<span class="hljs-params">source</span>):<br>destination = <span class="hljs-built_in">list</span>(source)<br>v3 = [<br><span class="hljs-number">16</span>, <span class="hljs-number">34</span>, <span class="hljs-number">56</span>, <span class="hljs-number">7</span>, <span class="hljs-number">46</span>, <span class="hljs-number">2</span>, <span class="hljs-number">10</span>, <span class="hljs-number">44</span>, <span class="hljs-number">20</span>, <span class="hljs-number">41</span>, <span class="hljs-number">59</span>, <span class="hljs-number">31</span>, <span class="hljs-number">51</span>, <span class="hljs-number">60</span>, <span class="hljs-number">61</span>, <span class="hljs-number">26</span>, <span class="hljs-number">5</span>, <span class="hljs-number">40</span>, <span class="hljs-number">21</span>, <span class="hljs-number">38</span>, <span class="hljs-number">4</span>, <span class="hljs-number">54</span>, <span class="hljs-number">52</span>, <span class="hljs-number">47</span>, <span class="hljs-number">3</span>, <span class="hljs-number">11</span>, <span class="hljs-number">58</span>, <span class="hljs-number">48</span>, <span class="hljs-number">32</span>, <span class="hljs-number">15</span>, <span class="hljs-number">49</span>, <span class="hljs-number">14</span>, <span class="hljs-number">37</span>, <span class="hljs-number">0</span>, <span class="hljs-number">55</span>, <span class="hljs-number">53</span>, <span class="hljs-number">24</span>, <span class="hljs-number">35</span>, <span class="hljs-number">18</span>, <span class="hljs-number">25</span>, <span class="hljs-number">33</span>, <span class="hljs-number">43</span>, <span class="hljs-number">50</span>, <span class="hljs-number">39</span>, <span class="hljs-number">12</span>, <span class="hljs-number">19</span>, <span class="hljs-number">13</span>, <span class="hljs-number">42</span>, <span class="hljs-number">9</span>, <span class="hljs-number">17</span>, <span class="hljs-number">28</span>, <span class="hljs-number">30</span>, <span class="hljs-number">23</span>, <span class="hljs-number">36</span>, <span class="hljs-number">1</span>, <span class="hljs-number">22</span>, <span class="hljs-number">57</span>, <span class="hljs-number">63</span>, <span class="hljs-number">8</span>, <span class="hljs-number">27</span>, <span class="hljs-number">6</span>, <span class="hljs-number">62</span>, <span class="hljs-number">45</span>, <span class="hljs-number">29</span><br>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">48</span>):<br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>source[j] = destination[v3[j]]<br>destination = source[:]<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join(destination)<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>s =<br><span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwx</span><br><span class="hljs-string">yz0123456789+/&quot;</span><br>result = basechange(<span class="hljs-built_in">list</span>(s))<br><span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure>

<h3 id="5-21"><a href="#5-21" class="headerlink" title="5.21"></a>5.21</h3><h4 id="GXYCTF-2019-luck-guy"><a href="#GXYCTF-2019-luck-guy" class="headerlink" title="[GXYCTF 2019]luck_guy"></a>[GXYCTF 2019]luck_guy</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">flag = <span class="hljs-string">&#x27;&#x27;</span><br>f2 = [<span class="hljs-number">0x7F</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x69</span>][::-<span class="hljs-number">1</span>]<br>s = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>    <span class="hljs-keyword">if</span> i % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:<br>        flag += <span class="hljs-built_in">chr</span>((f2[i]) - <span class="hljs-number">2</span>)<br>    <span class="hljs-keyword">else</span>:<br>        flag += <span class="hljs-built_in">chr</span>((f2[i]) - <span class="hljs-number">1</span>)<br>    <span class="hljs-comment"># flag += s</span><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<h3 id="5-22"><a href="#5-22" class="headerlink" title="5.22"></a>5.22</h3><h4 id="NISACTF-2022-ezpython"><a href="#NISACTF-2022-ezpython" class="headerlink" title="[NISACTF 2022]ezpython"></a>[NISACTF 2022]ezpython</h4><p>使用pyinstxtractor解包exe</p>
<p>使用010修复src.pyc的文件头</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#line 50:</span><br>flag = <span class="hljs-string">&#x27;IAMrG1EOPkM5NRI1cChQDxEcGDZMURptPzgHJHUiN0ASDgUYUB4LGQMUGAtLCQcJJywcFmddNno/PBtQbiMWNxsGLiFuLwpiFlkyP084Ng0lKj8GUBMXcwEXPTJrRDMdNwMiHVkCBFklHgIAWQwgCz8YQhp6E1xUHgUELxMtSh0xXzxBEisbUyYGOx1DBBZWPg1CXFkvJEcxO0ADeBwzChIOQkdwXQRpQCJHCQsaFE4CIjMDcwswTBw4BS9mLVMLLDs8HVgeQkscGBEBFSpQFQQgPTVRAUpvHyAiV1oPE0kyADpDbF8AbyErBjNkPh9PHiY7O1ZaGBADMB0PEVwdCxI+MCcXARZiPhwfH1IfKitGOF42FV8FTxwqPzBPAVUUOAEKAHEEP2QZGjQVV1oIS0QBJgBDLx1jEAsWKGk5Nw03MVgmWSE4Qy5LEghoHDY+OQ9dXE44Th0=&#x27;</span><br>key = <span class="hljs-string">&#x27;this is key&#x27;</span><br><span class="hljs-keyword">try</span>:<br>    result = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;please input key: &#x27;</span>)<br>    <span class="hljs-keyword">if</span> result == decrypt2(<span class="hljs-string">&#x27;AAAAAAAAAAAfFwwRSAIWWQ==&#x27;</span>, key):<br>        <span class="hljs-built_in">print</span>(decrypt1(base64.b64decode(decrypt2(flag, result))))<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">if</span> result == key:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;flag&#123;0e26d898-b454-43de-9c87-eb3d122186bc&#125;&#x27;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;key is error.&#x27;</span>)<br><span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>    <span class="hljs-keyword">pass</span><br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#line 50:</span><br>flag = <span class="hljs-string">&#x27;IAMrG1EOPkM5NRI1cChQDxEcGDZMURptPzgHJHUiN0ASDgUYUB4LGQMUGAtLCQcJJywcFmddNno/PBtQbiMWNxsGLiFuLwpiFlkyP084Ng0lKj8GUBMXcwEXPTJrRDMdNwMiHVkCBFklHgIAWQwgCz8YQhp6E1xUHgUELxMtSh0xXzxBEisbUyYGOx1DBBZWPg1CXFkvJEcxO0ADeBwzChIOQkdwXQRpQCJHCQsaFE4CIjMDcwswTBw4BS9mLVMLLDs8HVgeQkscGBEBFSpQFQQgPTVRAUpvHyAiV1oPE0kyADpDbF8AbyErBjNkPh9PHiY7O1ZaGBADMB0PEVwdCxI+MCcXARZiPhwfH1IfKitGOF42FV8FTxwqPzBPAVUUOAEKAHEEP2QZGjQVV1oIS0QBJgBDLx1jEAsWKGk5Nw03MVgmWSE4Qy5LEghoHDY+OQ9dXE44Th0=&#x27;</span><br>key = <span class="hljs-string">&#x27;this is key&#x27;</span><br><br><span class="hljs-built_in">print</span>(decrypt1(base64.b64decode(decrypt2(flag, decrypt2(<span class="hljs-string">&#x27;AAAAAAAAAAAfFwwRSAIWWQ==&#x27;</span>, key)))))<br></code></pre></td></tr></table></figure>

<h3 id="5-23"><a href="#5-23" class="headerlink" title="5.23"></a>5.23</h3><h4 id="HNCTF-2022-WEEK2-来解个方程"><a href="#HNCTF-2022-WEEK2-来解个方程" class="headerlink" title="[HNCTF 2022 WEEK2]来解个方程?"></a>[HNCTF 2022 WEEK2]来解个方程?</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br>v2=[Int(<span class="hljs-string">&#x27;v2%s&#x27;</span> %i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">22</span>)]<br>s=Solver()<br><br>s.add(<span class="hljs-number">245</span> * v2[<span class="hljs-number">4</span>] + <span class="hljs-number">395</span> * v2[<span class="hljs-number">3</span>] + <span class="hljs-number">3541</span> * v2[<span class="hljs-number">2</span>] + <span class="hljs-number">2051</span> * v2[<span class="hljs-number">1</span>] + <span class="hljs-number">3201</span> * v2[<span class="hljs-number">0</span>] + <span class="hljs-number">1345</span> * v2[<span class="hljs-number">5</span>] == <span class="hljs-number">855009</span>)<br>s.add(<span class="hljs-number">3270</span> * v2[<span class="hljs-number">4</span>] + <span class="hljs-number">3759</span> * v2[<span class="hljs-number">3</span>] + <span class="hljs-number">3900</span> * v2[<span class="hljs-number">2</span>] + <span class="hljs-number">3963</span> * v2[<span class="hljs-number">1</span>] + <span class="hljs-number">1546</span> * v2[<span class="hljs-number">0</span>] + <span class="hljs-number">3082</span> * v2[<span class="hljs-number">5</span>] == <span class="hljs-number">1515490</span>)<br>s.add(<span class="hljs-number">526</span> * v2[<span class="hljs-number">4</span>] + <span class="hljs-number">2283</span> * v2[<span class="hljs-number">3</span>] + <span class="hljs-number">3349</span> * v2[<span class="hljs-number">2</span>] + <span class="hljs-number">2458</span> * v2[<span class="hljs-number">1</span>] + <span class="hljs-number">2012</span> * v2[<span class="hljs-number">0</span>] + <span class="hljs-number">268</span> * v2[<span class="hljs-number">5</span>] == <span class="hljs-number">854822</span>)<br>s.add(<span class="hljs-number">3208</span> * v2[<span class="hljs-number">4</span>] + <span class="hljs-number">2021</span> * v2[<span class="hljs-number">3</span>] + <span class="hljs-number">3146</span> * v2[<span class="hljs-number">2</span>] + <span class="hljs-number">1571</span> * v2[<span class="hljs-number">1</span>] + <span class="hljs-number">2569</span> * v2[<span class="hljs-number">0</span>] + <span class="hljs-number">1395</span> * v2[<span class="hljs-number">5</span>] == <span class="hljs-number">1094422</span>)<br>s.add(<span class="hljs-number">3136</span> * v2[<span class="hljs-number">4</span>] + <span class="hljs-number">3553</span> * v2[<span class="hljs-number">3</span>] + <span class="hljs-number">2997</span> * v2[<span class="hljs-number">2</span>] + <span class="hljs-number">1824</span> * v2[<span class="hljs-number">1</span>] + <span class="hljs-number">1575</span> * v2[<span class="hljs-number">0</span>] + <span class="hljs-number">1599</span> * v2[<span class="hljs-number">5</span>] == <span class="hljs-number">1136398</span>)<br>s.add(<span class="hljs-number">2300</span> * v2[<span class="hljs-number">4</span>] + <span class="hljs-number">1349</span> * v2[<span class="hljs-number">3</span>] + <span class="hljs-number">86</span> * v2[<span class="hljs-number">2</span>] + <span class="hljs-number">3672</span> * v2[<span class="hljs-number">1</span>] + <span class="hljs-number">2908</span> * v2[<span class="hljs-number">0</span>] + <span class="hljs-number">1681</span> * v2[<span class="hljs-number">5</span>] == <span class="hljs-number">939991</span>)<br>s.add( <span class="hljs-number">212</span> * v2[<span class="hljs-number">20</span>]<br>       + <span class="hljs-number">153</span> * v2[<span class="hljs-number">19</span>]<br>       + <span class="hljs-number">342</span> * v2[<span class="hljs-number">18</span>]<br>     + <span class="hljs-number">490</span> * v2[<span class="hljs-number">10</span>]<br>      + <span class="hljs-number">325</span> * v2[<span class="hljs-number">9</span>]<br>       + <span class="hljs-number">485</span> * v2[<span class="hljs-number">8</span>]<br>       + <span class="hljs-number">56</span> * v2[<span class="hljs-number">7</span>]<br>       + <span class="hljs-number">202</span> * v2[<span class="hljs-number">6</span>]<br>       + <span class="hljs-number">191</span> * v2[<span class="hljs-number">21</span>] == <span class="hljs-number">245940</span>)<br>    <br><br><br><br>s.add(<span class="hljs-number">348</span> * v2[<span class="hljs-number">20</span>]<br>       + <span class="hljs-number">185</span> * v2[<span class="hljs-number">19</span>]<br>       + <span class="hljs-number">134</span> * v2[<span class="hljs-number">18</span>]<br>       + <span class="hljs-number">153</span> * v2[<span class="hljs-number">10</span>]<br>       + <span class="hljs-number">460</span> * v2[<span class="hljs-number">7</span>]<br>       + <span class="hljs-number">207</span> * v2[<span class="hljs-number">6</span>]<br>       + <span class="hljs-number">22</span> * v2[<span class="hljs-number">8</span>]<br>       + <span class="hljs-number">24</span> * v2[<span class="hljs-number">9</span>]<br>       + <span class="hljs-number">22</span> * v2[<span class="hljs-number">21</span>] == <span class="hljs-number">146392</span>)<br>s.add(<span class="hljs-number">177</span> * v2[<span class="hljs-number">20</span>]<br>       + <span class="hljs-number">231</span> * v2[<span class="hljs-number">19</span>]<br>       + <span class="hljs-number">489</span> * v2[<span class="hljs-number">18</span>]<br>       + <span class="hljs-number">339</span> * v2[<span class="hljs-number">10</span>]<br>       + <span class="hljs-number">433</span> * v2[<span class="hljs-number">9</span>]<br>       + <span class="hljs-number">311</span> * v2[<span class="hljs-number">8</span>]<br>       + <span class="hljs-number">164</span> * v2[<span class="hljs-number">7</span>]<br>       + <span class="hljs-number">154</span> * v2[<span class="hljs-number">6</span>]<br>       + <span class="hljs-number">100</span> * v2[<span class="hljs-number">21</span>] == <span class="hljs-number">239438</span>)<br><br>s.add(<span class="hljs-number">68</span> * v2[<span class="hljs-number">18</span>]<br>       + <span class="hljs-number">466</span> * v2[<span class="hljs-number">10</span>]<br>       + <span class="hljs-number">470</span> * v2[<span class="hljs-number">9</span>]<br>       + <span class="hljs-number">22</span> * v2[<span class="hljs-number">8</span>]<br>       + <span class="hljs-number">270</span> * v2[<span class="hljs-number">7</span>]<br>       + <span class="hljs-number">360</span> * v2[<span class="hljs-number">6</span>]<br>       + <span class="hljs-number">337</span> * v2[<span class="hljs-number">19</span>]<br>       + <span class="hljs-number">257</span> * v2[<span class="hljs-number">20</span>]<br>       + <span class="hljs-number">82</span> * v2[<span class="hljs-number">21</span>] == <span class="hljs-number">233887</span>)<br><br>s.add(<span class="hljs-number">246</span> * v2[<span class="hljs-number">20</span>]<br>       + <span class="hljs-number">235</span> * v2[<span class="hljs-number">19</span>]<br>       + <span class="hljs-number">468</span> * v2[<span class="hljs-number">18</span>]<br>       + <span class="hljs-number">91</span> * v2[<span class="hljs-number">10</span>]<br>       + <span class="hljs-number">151</span> * v2[<span class="hljs-number">9</span>]<br>       + <span class="hljs-number">197</span> * v2[<span class="hljs-number">6</span>]<br>       + <span class="hljs-number">92</span> * v2[<span class="hljs-number">7</span>]<br>       + <span class="hljs-number">73</span> * v2[<span class="hljs-number">8</span>]<br>       + <span class="hljs-number">54</span> * v2[<span class="hljs-number">21</span>] == <span class="hljs-number">152663</span>)<br>s.add(<span class="hljs-number">241</span> * v2[<span class="hljs-number">20</span>]<br>       + <span class="hljs-number">377</span> * v2[<span class="hljs-number">19</span>]<br>       + <span class="hljs-number">131</span> * v2[<span class="hljs-number">18</span>]<br>       + <span class="hljs-number">243</span> * v2[<span class="hljs-number">10</span>]<br>       + <span class="hljs-number">233</span> * v2[<span class="hljs-number">9</span>]<br>       + <span class="hljs-number">55</span> * v2[<span class="hljs-number">8</span>]<br>       + <span class="hljs-number">376</span> * v2[<span class="hljs-number">7</span>]<br>       + <span class="hljs-number">242</span> * v2[<span class="hljs-number">6</span>]<br>       + <span class="hljs-number">343</span> * v2[<span class="hljs-number">21</span>] == <span class="hljs-number">228375</span>)<br>s.add(<span class="hljs-number">356</span> * v2[<span class="hljs-number">20</span>]<br>       + <span class="hljs-number">200</span> * v2[<span class="hljs-number">19</span>]<br>       + <span class="hljs-number">136</span> * v2[<span class="hljs-number">9</span>]<br>       + <span class="hljs-number">301</span> * v2[<span class="hljs-number">8</span>]<br>       + <span class="hljs-number">284</span> * v2[<span class="hljs-number">7</span>]<br>       + <span class="hljs-number">364</span> * v2[<span class="hljs-number">6</span>]<br>       + <span class="hljs-number">458</span> * v2[<span class="hljs-number">10</span>]<br>       + <span class="hljs-number">5</span> * v2[<span class="hljs-number">18</span>]<br>       + <span class="hljs-number">61</span> * v2[<span class="hljs-number">21</span>] == <span class="hljs-number">211183</span>)<br>s.add(<span class="hljs-number">154</span> * v2[<span class="hljs-number">20</span>]<br>       + <span class="hljs-number">55</span> * v2[<span class="hljs-number">19</span>]<br>       + <span class="hljs-number">406</span> * v2[<span class="hljs-number">18</span>]<br>       + <span class="hljs-number">107</span> * v2[<span class="hljs-number">10</span>]<br>       + <span class="hljs-number">80</span> * v2[<span class="hljs-number">8</span>]<br>       + <span class="hljs-number">66</span> * v2[<span class="hljs-number">6</span>]<br>       + <span class="hljs-number">71</span> * v2[<span class="hljs-number">7</span>]<br>       + <span class="hljs-number">17</span> * v2[<span class="hljs-number">9</span>]<br>       + <span class="hljs-number">71</span> * v2[<span class="hljs-number">21</span>] == <span class="hljs-number">96788</span>)<br>s.add( <span class="hljs-number">335</span> * v2[<span class="hljs-number">20</span>]<br>       + <span class="hljs-number">201</span> * v2[<span class="hljs-number">19</span>]<br>       + <span class="hljs-number">197</span> * v2[<span class="hljs-number">9</span>]<br>       + <span class="hljs-number">280</span> * v2[<span class="hljs-number">8</span>]<br>       + <span class="hljs-number">409</span> * v2[<span class="hljs-number">7</span>]<br>       + <span class="hljs-number">56</span> * v2[<span class="hljs-number">6</span>]<br>       + <span class="hljs-number">494</span> * v2[<span class="hljs-number">10</span>]<br>       + <span class="hljs-number">63</span> * v2[<span class="hljs-number">18</span>]<br>       + <span class="hljs-number">99</span> * v2[<span class="hljs-number">21</span>] == <span class="hljs-number">204625</span>)<br>s.add(<span class="hljs-number">428</span> * v2[<span class="hljs-number">16</span>] + <span class="hljs-number">1266</span> * v2[<span class="hljs-number">15</span>] + <span class="hljs-number">1326</span> * v2[<span class="hljs-number">14</span>] + <span class="hljs-number">1967</span> * v2[<span class="hljs-number">13</span>] + <span class="hljs-number">3001</span> * v2[<span class="hljs-number">12</span>] + <span class="hljs-number">81</span> * v2[<span class="hljs-number">11</span>] + <span class="hljs-number">2439</span> * v2[<span class="hljs-number">17</span>] == <span class="hljs-number">1109296</span>)<br>s.add(<span class="hljs-number">2585</span> * v2[<span class="hljs-number">16</span>] + <span class="hljs-number">4027</span> * v2[<span class="hljs-number">15</span>] + <span class="hljs-number">141</span> * v2[<span class="hljs-number">14</span>] + <span class="hljs-number">2539</span> * v2[<span class="hljs-number">13</span>] + <span class="hljs-number">3073</span> * v2[<span class="hljs-number">12</span>] + <span class="hljs-number">164</span> * v2[<span class="hljs-number">11</span>] + <span class="hljs-number">1556</span> * v2[<span class="hljs-number">17</span>] == <span class="hljs-number">1368547</span>)<br>s.add(<span class="hljs-number">2080</span> * v2[<span class="hljs-number">16</span>] + <span class="hljs-number">358</span> * v2[<span class="hljs-number">15</span>] + <span class="hljs-number">1317</span> * v2[<span class="hljs-number">14</span>] + <span class="hljs-number">1341</span> * v2[<span class="hljs-number">13</span>] + <span class="hljs-number">3681</span> * v2[<span class="hljs-number">12</span>] + <span class="hljs-number">2197</span> * v2[<span class="hljs-number">11</span>] + <span class="hljs-number">1205</span> * v2[<span class="hljs-number">17</span>] == <span class="hljs-number">1320274</span>)<br><br><br><br>s.add(<span class="hljs-number">840</span> * v2[<span class="hljs-number">16</span>] + <span class="hljs-number">1494</span> * v2[<span class="hljs-number">15</span>] + <span class="hljs-number">2353</span> * v2[<span class="hljs-number">14</span>] + <span class="hljs-number">235</span> * v2[<span class="hljs-number">13</span>] + <span class="hljs-number">3843</span> * v2[<span class="hljs-number">12</span>] + <span class="hljs-number">1496</span> * v2[<span class="hljs-number">11</span>] + <span class="hljs-number">1302</span> * v2[<span class="hljs-number">17</span>] == <span class="hljs-number">1206735</span>)<br>s.add(<span class="hljs-number">101</span> * v2[<span class="hljs-number">16</span>] + <span class="hljs-number">2025</span> * v2[<span class="hljs-number">15</span>] + <span class="hljs-number">2842</span> * v2[<span class="hljs-number">14</span>] + <span class="hljs-number">1559</span> * v2[<span class="hljs-number">13</span>] + <span class="hljs-number">2143</span> * v2[<span class="hljs-number">12</span>] + <span class="hljs-number">3008</span> * v2[<span class="hljs-number">11</span>] + <span class="hljs-number">981</span> * v2[<span class="hljs-number">17</span>] == <span class="hljs-number">1306983</span>)<br>s.add(<span class="hljs-number">1290</span> * v2[<span class="hljs-number">16</span>] + <span class="hljs-number">3822</span> * v2[<span class="hljs-number">15</span>] + <span class="hljs-number">1733</span> * v2[<span class="hljs-number">14</span>] + <span class="hljs-number">292</span> * v2[<span class="hljs-number">13</span>] + <span class="hljs-number">816</span> * v2[<span class="hljs-number">12</span>] + <span class="hljs-number">1017</span> * v2[<span class="hljs-number">11</span>] + <span class="hljs-number">3199</span> * v2[<span class="hljs-number">17</span>] == <span class="hljs-number">1160573</span>)<br>s.add(<span class="hljs-number">186</span> * v2[<span class="hljs-number">16</span>]<br>                  + <span class="hljs-number">2712</span> * v2[<span class="hljs-number">15</span>]<br>                  + <span class="hljs-number">2136</span> * v2[<span class="hljs-number">14</span>]<br>                  + <span class="hljs-number">98</span> * v2[<span class="hljs-number">11</span>]<br>                  + <span class="hljs-number">138</span> * v2[<span class="hljs-number">12</span>]<br>                  + <span class="hljs-number">3584</span> * v2[<span class="hljs-number">13</span>]<br>                  + <span class="hljs-number">1173</span> * v2[<span class="hljs-number">17</span>]==<span class="hljs-number">1005746</span>)<br><br><span class="hljs-built_in">print</span>(s.check())<br><br><br>m=s.model()<br>res=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">22</span>):<br>    res+=(<span class="hljs-built_in">chr</span>(m[v2[i]].as_long()))<br>   <br><span class="hljs-built_in">print</span>(res)<br><br></code></pre></td></tr></table></figure>

<h3 id="5-24"><a href="#5-24" class="headerlink" title="5.24"></a>5.24</h3><h4 id="GDOUCTF-2023-L！s！"><a href="#GDOUCTF-2023-L！s！" class="headerlink" title="[GDOUCTF 2023]L！s！"></a>[GDOUCTF 2023]L！s！</h4><p>考察了bindiff插件的使用</p>
<p>比较两个文件的不同之处，一般用来比较原文件和dump之后的文件</p>
<p>先用ida随便打开一个文件，再关闭，生成集成的那个文件（i64），再用ida打开另一个文件，打开插件bindiff，选择Diff Database 打开刚刚的i64文件，就可以查看这两个文件的不同之处了</p>
<p>密文提取出来：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> aa[] = &#123; <span class="hljs-number">0x04</span>,<span class="hljs-number">0x16</span>,<span class="hljs-number">0x0f</span>,<span class="hljs-number">0x18</span>,<span class="hljs-number">0x0a</span>,<span class="hljs-number">0x37</span>,<span class="hljs-number">0x2e</span>,<span class="hljs-number">0x7d</span>,<span class="hljs-number">0x22</span>,<span class="hljs-number">0x28</span>,<span class="hljs-number">0x25</span>,<span class="hljs-number">0x2a</span>,<span class="hljs-number">0x13</span>,<span class="hljs-number">0x7d</span>,<span class="hljs-number">0x3f</span>,<span class="hljs-number">0x13</span>,<span class="hljs-number">0x2d</span>,<span class="hljs-number">0x13</span>,<span class="hljs-number">0x39</span>,<span class="hljs-number">0x3f</span>,<span class="hljs-number">0x7f</span>,<span class="hljs-number">0x2a</span>,<span class="hljs-number">0x39</span>,<span class="hljs-number">0x20</span>,<span class="hljs-number">0x13</span>,<span class="hljs-number">0x38</span>,<span class="hljs-number">0x7c</span>,<span class="hljs-number">0x7c</span>,<span class="hljs-number">0x20</span>,<span class="hljs-number">0x31</span>&#125;;<br></code></pre></td></tr></table></figure>

<p>加密就仅仅只有一个异或v7，从0-256爆破遍，去结果里找flag</p>
<p><img src="https://raw.githubusercontent.com/shimmer123456/img/main/img/202304201207095.png" alt="image-20230420120722978"></p>
<p>还算好找</p>
<h3 id="5-26"><a href="#5-26" class="headerlink" title="5.26"></a>5.26</h3><h4 id="EasyDotnet"><a href="#EasyDotnet" class="headerlink" title="EasyDotnet"></a>EasyDotnet</h4><p>月赛的一道题。c#逆向，加了confuserex的壳。</p>
<p>用工具可以脱掉壳，但是会破坏程序，虽然源码能看到但程序不能动调，而这个题的源码里有字符串加密，要看字符串就必须动调看，所以这条路不行</p>
<p>那么就考虑手动脱壳：</p>
<p>仔细阅读代码可以发现，程序中 .static constructor() 是没有被加密的。阅读它调用的 第一个函数，可以发现其中调用了 Marshal.GetHINSTANCE() 和 kernel32.VirtualProtect() ，可 以猜测该函数是用于解密代码的。于是，在 .static constructor() 的第二行下断点，待 运行到该点之后，将程序的内存映像 dump 下来，完成脱壳</p>
<p>注意这里的dump必须要在dnspy下边的那个模块那里保存，不能去左上角文件那里保存模块，这样保存的是整个文件，会报错</p>
<p>dump之后再用dnspy打开，这个时候就可以看到main函数内有源码了，但是还有一些没回复，使用de4dot继续脱一下，就完整的脱掉了</p>
<p>再看源码，有两处反调试nop掉，再逆逻辑就行了，是一个base32加密</p>
<p>如何逆就不说了，主要是手动脱壳</p>
<h3 id="5-27-5-28"><a href="#5-27-5-28" class="headerlink" title="5.27  5.28"></a>5.27  5.28</h3><p>这两天国赛，不太想写了</p>
<h3 id="5-29"><a href="#5-29" class="headerlink" title="5.29"></a>5.29</h3><h4 id="ciscn-2023-babyRE"><a href="#ciscn-2023-babyRE" class="headerlink" title="ciscn 2023 babyRE"></a>ciscn 2023 babyRE</h4><p>进入题目开头给的网站，可视化编程，真是baby  re了，导入xml文件，可以看到对输入的处理就是逐位与前一位异或，密文也给出，不过顺序有点不好搞，那么就插入一个for循环，让程序自己打印出密文</p>
<h3 id="5-30"><a href="#5-30" class="headerlink" title="5.30"></a>5.30</h3><h4 id="春秋杯-re-wp-shimmer’s-blog-shimmer123456-github-io"><a href="#春秋杯-re-wp-shimmer’s-blog-shimmer123456-github-io" class="headerlink" title="春秋杯 re wp | shimmer’s blog (shimmer123456.github.io)"></a><a target="_blank" rel="noopener" href="https://shimmer123456.github.io/2023/05/30/%E6%98%A5%E7%A7%8B%E6%9D%AF/">春秋杯 re wp | shimmer’s blog (shimmer123456.github.io)</a></h4><h3 id="5-31"><a href="#5-31" class="headerlink" title="5.31"></a>5.31</h3><h4 id="春秋杯-re-wp-shimmer’s-blog-shimmer123456-github-io-1"><a href="#春秋杯-re-wp-shimmer’s-blog-shimmer123456-github-io-1" class="headerlink" title="春秋杯 re wp | shimmer’s blog (shimmer123456.github.io)"></a><a target="_blank" rel="noopener" href="https://shimmer123456.github.io/2023/05/30/%E6%98%A5%E7%A7%8B%E6%9D%AF/">春秋杯 re wp | shimmer’s blog (shimmer123456.github.io)</a></h4><h3 id="6-1"><a href="#6-1" class="headerlink" title="6.1"></a>6.1</h3><h4 id="ciscn-逆向wp-shimmer’s-blog-shimmer123456-github-io"><a href="#ciscn-逆向wp-shimmer’s-blog-shimmer123456-github-io" class="headerlink" title="ciscn 逆向wp | shimmer’s blog (shimmer123456.github.io)"></a><a target="_blank" rel="noopener" href="https://shimmer123456.github.io/2023/05/31/ciscn/">ciscn 逆向wp | shimmer’s blog (shimmer123456.github.io)</a></h4><h3 id="6-2"><a href="#6-2" class="headerlink" title="6.2"></a>6.2</h3><h4 id="ciscn-逆向wp-shimmer’s-blog-shimmer123456-github-io-1"><a href="#ciscn-逆向wp-shimmer’s-blog-shimmer123456-github-io-1" class="headerlink" title="ciscn 逆向wp | shimmer’s blog (shimmer123456.github.io)"></a><a target="_blank" rel="noopener" href="https://shimmer123456.github.io/2023/05/31/ciscn/">ciscn 逆向wp | shimmer’s blog (shimmer123456.github.io)</a></h4><h3 id="6-3"><a href="#6-3" class="headerlink" title="6.3"></a>6.3</h3><h4 id="MoeCTF-2022-chicken-soup"><a href="#MoeCTF-2022-chicken-soup" class="headerlink" title="[MoeCTF 2022]chicken_soup"></a>[MoeCTF 2022]chicken_soup</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">enc = [<span class="hljs-number">0xcd</span>,<span class="hljs-number">0x4d</span>,<span class="hljs-number">0x8c</span>,<span class="hljs-number">0x7d</span>,<span class="hljs-number">0xad</span>,<span class="hljs-number">0x1e</span>,<span class="hljs-number">0xbe</span>,<span class="hljs-number">0x4a</span>,<span class="hljs-number">0x8a</span>,<span class="hljs-number">0x7d</span>,<span class="hljs-number">0xbc</span>,<span class="hljs-number">0x7c</span>,<span class="hljs-number">0xfc</span>,<span class="hljs-number">0x2e</span>,<span class="hljs-number">0x2a</span>,<span class="hljs-number">0x79</span>,<span class="hljs-number">0x9d</span>,<span class="hljs-number">0x6a</span>,<span class="hljs-number">0x1a</span>,<span class="hljs-number">0xcc</span>,<span class="hljs-number">0x3d</span>,<span class="hljs-number">0x4a</span>,<span class="hljs-number">0xf8</span>,<span class="hljs-number">0x3c</span>,<span class="hljs-number">0x79</span>,<span class="hljs-number">0x69</span>,<span class="hljs-number">0x39</span>,<span class="hljs-number">0xd9</span>,<span class="hljs-number">0xdd</span>,<span class="hljs-number">0x9d</span>,<span class="hljs-number">0xa9</span>,<span class="hljs-number">0x69</span>,<span class="hljs-number">0x4c</span>,<span class="hljs-number">0x8c</span>,<span class="hljs-number">0xdd</span>,<span class="hljs-number">0x59</span>,<span class="hljs-number">0xe9</span>,<span class="hljs-number">0xd7</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>	enc[i] = ((enc[i]//<span class="hljs-number">16</span> | enc[i]&lt;&lt;<span class="hljs-number">4</span>)) &amp; <span class="hljs-number">0xff</span><br>	<span class="hljs-built_in">print</span>((enc[i]))<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):<br>    enc[i-<span class="hljs-number">1</span>] -= enc[i]<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(enc))<br></code></pre></td></tr></table></figure>



<h3 id="6-4"><a href="#6-4" class="headerlink" title="6.4"></a>6.4</h3><h4 id="hsctf-dasctf"><a href="#hsctf-dasctf" class="headerlink" title="hsctf dasctf"></a>hsctf dasctf</h4><h3 id="6-5"><a href="#6-5" class="headerlink" title="6.5"></a>6.5</h3><h4 id="陕西省赛-逆向wp-shimmer’s-blog-shimmer123456-github-io"><a href="#陕西省赛-逆向wp-shimmer’s-blog-shimmer123456-github-io" class="headerlink" title="陕西省赛 逆向wp | shimmer’s blog (shimmer123456.github.io)"></a><a target="_blank" rel="noopener" href="https://shimmer123456.github.io/2023/06/06/%E9%99%95%E8%A5%BF%E7%9C%81%E8%B5%9B/">陕西省赛 逆向wp | shimmer’s blog (shimmer123456.github.io)</a></h4><h3 id="6-6"><a href="#6-6" class="headerlink" title="6.6"></a>6.6</h3><h4 id="陕西省赛-逆向wp-shimmer’s-blog-shimmer123456-github-io-1"><a href="#陕西省赛-逆向wp-shimmer’s-blog-shimmer123456-github-io-1" class="headerlink" title="陕西省赛 逆向wp | shimmer’s blog (shimmer123456.github.io)"></a><a target="_blank" rel="noopener" href="https://shimmer123456.github.io/2023/06/06/%E9%99%95%E8%A5%BF%E7%9C%81%E8%B5%9B/">陕西省赛 逆向wp | shimmer’s blog (shimmer123456.github.io)</a></h4><h3 id="6-7"><a href="#6-7" class="headerlink" title="6.7"></a>6.7</h3><h4 id="SWPUCTF-2021-新生赛-PYRE"><a href="#SWPUCTF-2021-新生赛-PYRE" class="headerlink" title="[SWPUCTF 2021 新生赛]PYRE"></a>[SWPUCTF 2021 新生赛]PYRE</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># visit https://tool.lu/pyc/ for more information</span><br><span class="hljs-comment"># Version: Python 3.9</span><br><br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> hashlib<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">init</span>(<span class="hljs-params">x, y</span>):<br>    a = <span class="hljs-number">0</span><br>    y = hashlib.md5(y.encode()).hexdigest()<br>    b = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        x.append(i)<br>        b.append(y[i % <span class="hljs-built_in">len</span>(y)])<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        a = (a + x[i] + <span class="hljs-built_in">ord</span>(b[i])) % <span class="hljs-number">256</span><br>        x[i], x[a] = x[a], x[i]<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Encrypt</span>(<span class="hljs-params">x1, y1</span>):<br>    a1 = a2 = <span class="hljs-number">0</span><br>    c1 = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> y1:<br>        a1 = (a1 + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        a2 = (a2 + x1[a1]) % <span class="hljs-number">256</span><br>        x1[a1], x1[a2] = x1[a2], x1[a1]<br>        z1 = (x1[a1] + x1[a2]) % <span class="hljs-number">256</span><br>        z2 = <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(j) ^ x1[(x1[a1] + x1[a2]) % <span class="hljs-number">256</span>])<br>        <span class="hljs-built_in">print</span>(x1[(x1[a1] + x1[a2]) % <span class="hljs-number">256</span>], end=<span class="hljs-string">&#x27;,&#x27;</span>)<br>        c1 += z2<br>    <span class="hljs-comment"># c1 = base64.b64encode(c1.encode())</span><br>    <span class="hljs-comment"># print(c1)</span><br>    <span class="hljs-keyword">return</span> c1<br><br><br><span class="hljs-comment"># input_str = input(&#x27;input flag pls:&#x27;)</span><br>s = []<br>init(s, <span class="hljs-string">&#x27;bJLVFYw3WI5ncGez&#x27;</span>)<br><span class="hljs-comment"># if Encrypt(s, input_str).decode() == &#x27;w4s1PUYsJ8OYwpRXVjvDkVPCgzIEJ27Dt2I=&#x27;:</span><br><span class="hljs-comment">#     print(&#x27;good!&#x27;)</span><br><span class="hljs-comment"># else:</span><br><span class="hljs-comment">#     print(&#x27;nonono!&#x27;)</span><br><br>ci = <span class="hljs-string">&#x27;w4s1PUYsJ8OYwpRXVjvDkVPCgzIEJ27Dt2I=&#x27;</span><br>ci = base64.b64decode(ci.encode()).decode()<br><span class="hljs-built_in">print</span>(ci)<br>Encrypt(s, ci)<br>key = [<span class="hljs-number">133</span>, <span class="hljs-number">102</span>, <span class="hljs-number">110</span>, <span class="hljs-number">5</span>, <span class="hljs-number">120</span>, <span class="hljs-number">97</span>, <span class="hljs-number">163</span>, <span class="hljs-number">249</span>, <span class="hljs-number">56</span>, <span class="hljs-number">36</span>, <span class="hljs-number">94</span>, <span class="hljs-number">142</span>, <span class="hljs-number">34</span>, <span class="hljs-number">244</span>, <span class="hljs-number">67</span>, <span class="hljs-number">91</span>, <span class="hljs-number">75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">155</span>, <span class="hljs-number">31</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(ci)):<br>    a = key[i] ^ <span class="hljs-built_in">ord</span>(ci[i])<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(a), end=<span class="hljs-string">&quot;&quot;</span>)<br><br></code></pre></td></tr></table></figure>

<h3 id="6-8"><a href="#6-8" class="headerlink" title="6.8"></a>6.8</h3><h4 id="MoeCTF-2021-Realezpy"><a href="#MoeCTF-2021-Realezpy" class="headerlink" title="[MoeCTF 2021]Realezpy"></a>[MoeCTF 2021]Realezpy</h4><p>直接爆破：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python">c = [<span class="hljs-number">119</span>, <span class="hljs-number">121</span>, <span class="hljs-number">111</span>, <span class="hljs-number">109</span>, <span class="hljs-number">100</span>, <span class="hljs-number">112</span>, <span class="hljs-number">123</span>, <span class="hljs-number">74</span>, <span class="hljs-number">105</span>, <span class="hljs-number">100</span>, <span class="hljs-number">114</span>, <span class="hljs-number">48</span>, <span class="hljs-number">120</span>, <span class="hljs-number">95</span>, <span class="hljs-number">49</span>, <span class="hljs-number">99</span>, <span class="hljs-number">95</span>, <span class="hljs-number">99</span>, <span class="hljs-number">121</span>, <span class="hljs-number">48</span>, <span class="hljs-number">121</span>, <span class="hljs-number">48</span>, <span class="hljs-number">121</span>, <span class="hljs-number">48</span>, <span class="hljs-number">121</span>, <span class="hljs-number">48</span>, <span class="hljs-number">95</span>, <span class="hljs-number">111</span>, <span class="hljs-number">107</span>, <span class="hljs-number">99</span>, <span class="hljs-number">105</span>, <span class="hljs-number">125</span>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">a</span>):<br>    result = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>) &lt;= <span class="hljs-built_in">ord</span>(a[i]) &lt;= <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;z&#x27;</span>):<br>            result.append((<span class="hljs-built_in">ord</span>(a[i]) + <span class="hljs-number">114</span> - <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>)) % <span class="hljs-number">26</span> + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>))<br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>) &lt;= <span class="hljs-built_in">ord</span>(a[i]) &lt;= <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;Z&#x27;</span>):<br>            result.append((<span class="hljs-built_in">ord</span>(a[i]) + <span class="hljs-number">514</span> - <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>)) % <span class="hljs-number">26</span> + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>))<br>        <span class="hljs-keyword">else</span>:<br>            result.append(<span class="hljs-built_in">ord</span>(a[i]))<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> result<br><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(c)):<br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">37</span>,<span class="hljs-number">127</span>):<br>        <span class="hljs-keyword">if</span> c[i]==encrypt(<span class="hljs-built_in">chr</span>(k))[<span class="hljs-number">0</span>]:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(k),end=<span class="hljs-string">&quot;&quot;</span>)<br>            <span class="hljs-keyword">break</span><br><br></code></pre></td></tr></table></figure>

<h3 id="6-9"><a href="#6-9" class="headerlink" title="6.9"></a>6.9</h3><h4 id="MTCTF-2021-wow"><a href="#MTCTF-2021-wow" class="headerlink" title="[MTCTF 2021]wow"></a>[MTCTF 2021]wow</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> binascii<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">MX</span>(<span class="hljs-params">z, y, total, key, p, e</span>):<br>    temp1 = (z.value &gt;&gt; <span class="hljs-number">5</span> ^ y.value &lt;&lt; <span class="hljs-number">2</span>) + (y.value &gt;&gt; <span class="hljs-number">3</span> ^ z.value &lt;&lt; <span class="hljs-number">4</span>)<br>    temp2 = (total.value ^ y.value) + (key[(p &amp; <span class="hljs-number">3</span>) ^ e.value] ^ z.value)<br><br>    <span class="hljs-keyword">return</span> c_uint32(temp1 ^ temp2)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">n, v, key</span>):<br>    delta = <span class="hljs-number">0x9e3779b9</span><br>    rounds = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> // n<br><br>    total = c_uint32(<span class="hljs-number">0</span>)<br>    z = c_uint32(v[n - <span class="hljs-number">1</span>])<br>    e = c_uint32(<span class="hljs-number">0</span>)<br><br>    <span class="hljs-keyword">while</span> rounds &gt; <span class="hljs-number">0</span>:<br>        total.value += delta<br>        e.value = (total.value &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span><br>        <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n - <span class="hljs-number">1</span>):<br>            y = c_uint32(v[p + <span class="hljs-number">1</span>])<br>            v[p] = c_uint32(v[p] + MX(z, y, total, key, p, e).value).value<br>            z.value = v[p]<br>        y = c_uint32(v[<span class="hljs-number">0</span>])<br>        v[n - <span class="hljs-number">1</span>] = c_uint32(v[n - <span class="hljs-number">1</span>] + MX(z, y, total,<br>                                          key, n - <span class="hljs-number">1</span>, e).value).value<br>        z.value = v[n - <span class="hljs-number">1</span>]<br>        rounds -= <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">return</span> v<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">n, v, key</span>):<br>    delta = <span class="hljs-number">0x67452301</span><br>    <span class="hljs-comment"># rounds = 6 + 52//n</span><br>    rounds = <span class="hljs-number">12</span><br><br>    total = c_uint32(rounds * delta)<br>    y = c_uint32(v[<span class="hljs-number">0</span>])<br>    e = c_uint32(<span class="hljs-number">0</span>)<br><br>    <span class="hljs-keyword">while</span> rounds &gt; <span class="hljs-number">0</span>:<br>        e.value = (total.value &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span><br>        <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n - <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):<br>            z = c_uint32(v[p - <span class="hljs-number">1</span>])<br>            v[p] = c_uint32((v[p] - MX(z, y, total, key, p, e).value)).value<br>            y.value = v[p]<br>        z = c_uint32(v[n - <span class="hljs-number">1</span>])<br>        v[<span class="hljs-number">0</span>] = c_uint32(v[<span class="hljs-number">0</span>] - MX(z, y, total, key, <span class="hljs-number">0</span>, e).value).value<br>        y.value = v[<span class="hljs-number">0</span>]<br>        total.value -= delta<br>        rounds -= <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">return</span> v<br><br><br><span class="hljs-comment">#  test</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>        <span class="hljs-comment"># 该算法中每次可加密不只64bit的数据，并且加密的轮数由加密数据长度决定</span><br>    v = [<span class="hljs-number">0xD8F758F5</span>, <span class="hljs-number">0x526849DB</span>, <span class="hljs-number">0xE2D72563</span>, <span class="hljs-number">0x485EEFAC</span>, <span class="hljs-number">0x608F4BC6</span>,<br>         <span class="hljs-number">0x5859F76A</span>, <span class="hljs-number">0xB03565A3</span>, <span class="hljs-number">0x3E4091C1</span>, <span class="hljs-number">0xD3DB5B9A</span>, <span class="hljs-number">0x00000000</span>]<br>    k = [<span class="hljs-number">0x0EFCDAB89</span>, <span class="hljs-number">0x10325476</span>, <span class="hljs-number">0x98BADCFE</span>, <span class="hljs-number">0x0C3D2E1F0</span>]<br>    n = <span class="hljs-number">9</span><br><br>    <span class="hljs-comment"># print(&quot;Data is : &quot;, hex(v[0]), hex(v[1]))</span><br>    <span class="hljs-comment"># res = encrypt(n, v, k)</span><br>    <span class="hljs-comment"># print(&quot;Encrypted data is : &quot;, hex(res[0]), hex(res[1]))</span><br>    res = decrypt(n, v, k)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Decrypted data is : &quot;</span>, res)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(res)):<br>        <span class="hljs-built_in">print</span>(long_to_bytes(res[i])[::-<span class="hljs-number">1</span>].decode(), end=<span class="hljs-string">&quot;&quot;</span>)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Data is :  0x12345678 0x78563412</span><br><span class="hljs-string">Encrypted data is :  0xef86c2bb 0x25f31b5e</span><br><span class="hljs-string">Decrypted data is :  0x12345678 0x78563412</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br></code></pre></td></tr></table></figure>

<h3 id="6-10"><a href="#6-10" class="headerlink" title="6.10"></a>6.10</h3><h4 id="WUSTCTF-2020-level4"><a href="#WUSTCTF-2020-level4" class="headerlink" title="[WUSTCTF 2020]level4"></a>[WUSTCTF 2020]level4</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">PreOrder</span>(<span class="hljs-params">Postorder,Inorder</span>):<br>    length = <span class="hljs-built_in">len</span>(Postorder)<br>    <span class="hljs-keyword">if</span> length == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    root = Postorder[length-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length):<br>        <span class="hljs-keyword">if</span> root == Inorder[i]:<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-built_in">print</span>(root,end=<span class="hljs-string">&quot;&quot;</span>)<br>    PreOrder(Postorder[<span class="hljs-number">0</span>:i],Inorder[<span class="hljs-number">0</span>:i])<br>    PreOrder(Postorder[i:length-<span class="hljs-number">1</span>],Inorder[i+<span class="hljs-number">1</span>:length])<br>PreOrder(<span class="hljs-string">&quot;20f0Th&#123;2tsIS_icArE&#125;e7__w&quot;</span>,<span class="hljs-string">&quot;2f0t02T&#123;hcsiI_SwA__r7Ee&#125;&quot;</span>)<br><span class="hljs-comment">#二叉树遍历 前中求后</span><br></code></pre></td></tr></table></figure>

<h3 id="6-11"><a href="#6-11" class="headerlink" title="6.11"></a>6.11</h3><h4 id="长城杯-2021-院校组-Just-cmp-re"><a href="#长城杯-2021-院校组-Just-cmp-re" class="headerlink" title="[长城杯 2021 院校组]Just_cmp-re"></a>[长城杯 2021 院校组]Just_cmp-re</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">enc = [<span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x0A</span>, <br>  <span class="hljs-number">0x08</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x08</span>, <br>  <span class="hljs-number">0x38</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x07</span>, <br>  <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>]<br><br><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>	<span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(enc[i]+<span class="hljs-number">0x2a</span>),end=<span class="hljs-string">&quot;&quot;</span>)<br><br></code></pre></td></tr></table></figure>

<h3 id="6-12"><a href="#6-12" class="headerlink" title="6.12"></a>6.12</h3><h4 id="MoeCTF-2022-ezTea"><a href="#MoeCTF-2022-ezTea" class="headerlink" title="[MoeCTF 2022]ezTea"></a>[MoeCTF 2022]ezTea</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-type">void</span> <span class="hljs-title function_">decrypt</span> <span class="hljs-params">(<span class="hljs-type">uint32_t</span>* v, <span class="hljs-type">uint32_t</span>* k)</span> &#123; <span class="hljs-comment">//</span><br><span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>], sum = <span class="hljs-number">0xd33b470</span>*<span class="hljs-number">32</span>;<br><span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">0xd33b470</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;<br>v1 -= ((v0&lt;&lt;<span class="hljs-number">4</span>) + k[<span class="hljs-number">2</span>]) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="hljs-number">5</span>) + k[<span class="hljs-number">3</span>]);<br>v0 -= ((v1&lt;&lt;<span class="hljs-number">4</span>) + k[<span class="hljs-number">0</span>]) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="hljs-number">5</span>) + k[<span class="hljs-number">1</span>]);<br>sum -= delta;<br>&#125;<br>v[<span class="hljs-number">0</span>] = v0;<br>v[<span class="hljs-number">1</span>] = v1;<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br><br><span class="hljs-type">int8_t</span> enc[] = &#123;<span class="hljs-number">0x17</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xed</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x3d</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xa9</span>, <span class="hljs-number">0xfd</span>, <span class="hljs-number">0xe2</span>, <span class="hljs-number">0x5e</span>,<br>			<span class="hljs-number">0x61</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0xe4</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xf1</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0xe9</span>, <span class="hljs-number">0xe9</span>, <span class="hljs-number">0xa2</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0xcb</span>, <span class="hljs-number">0x9a</span>, <span class="hljs-number">0x99</span>,<br>			<span class="hljs-number">0xec</span>, <span class="hljs-number">0xb1</span>, <span class="hljs-number">0xe1</span>, <span class="hljs-number">0x7d</span>&#125;;<br><span class="hljs-type">uint32_t</span> k[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>&#125;;<br><br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i&lt;<span class="hljs-number">32</span>;i+=<span class="hljs-number">8</span>)&#123;<br><span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>] = &#123;*(<span class="hljs-type">uint32_t</span> *)&amp;enc[i], *(<span class="hljs-type">uint32_t</span> *)&amp;enc[i+<span class="hljs-number">4</span>]&#125;;<br>decrypt(v, k);<br><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">2</span>; j++)<br>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">4</span>; k++)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, v[j] &amp; <span class="hljs-number">0xff</span>); <br>        v[j] &gt;&gt;= <span class="hljs-number">8</span>;<br>           &#125;<br>      &#125;<br><br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="6-13"><a href="#6-13" class="headerlink" title="6.13"></a>6.13</h3><h4 id="MoeCTF-2021-大佬请喝coffee"><a href="#MoeCTF-2021-大佬请喝coffee" class="headerlink" title="[MoeCTF 2021]大佬请喝coffee"></a>[MoeCTF 2021]大佬请喝coffee</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><br>arrayOfChar = [Int(<span class="hljs-string">&quot;input[%d]&quot;</span>%i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>)]<br><br>s = Solver()<br>s.add(arrayOfChar[<span class="hljs-number">0</span>] * <span class="hljs-number">4778</span> + arrayOfChar[<span class="hljs-number">1</span>] * <span class="hljs-number">3659</span> + arrayOfChar[<span class="hljs-number">2</span>] * <span class="hljs-number">9011</span> + arrayOfChar[<span class="hljs-number">3</span>] * <span class="hljs-number">5734</span> + arrayOfChar[<span class="hljs-number">4</span>] * <span class="hljs-number">4076</span> + arrayOfChar[<span class="hljs-number">5</span>] * <span class="hljs-number">6812</span> + arrayOfChar[<span class="hljs-number">6</span>] * <span class="hljs-number">8341</span> + arrayOfChar[<span class="hljs-number">7</span>] * <span class="hljs-number">6765</span> + arrayOfChar[<span class="hljs-number">8</span>] * <span class="hljs-number">7435</span> == <span class="hljs-number">5711942</span> )<br>s.add(arrayOfChar[<span class="hljs-number">0</span>] * <span class="hljs-number">4449</span> + arrayOfChar[<span class="hljs-number">1</span>] * <span class="hljs-number">5454</span> + arrayOfChar[<span class="hljs-number">2</span>] * <span class="hljs-number">4459</span> + arrayOfChar[<span class="hljs-number">3</span>] * <span class="hljs-number">5800</span> + arrayOfChar[<span class="hljs-number">4</span>] * <span class="hljs-number">6685</span> + arrayOfChar[<span class="hljs-number">5</span>] * <span class="hljs-number">6120</span> + arrayOfChar[<span class="hljs-number">6</span>] * <span class="hljs-number">7357</span> + arrayOfChar[<span class="hljs-number">7</span>] * <span class="hljs-number">3561</span> + arrayOfChar[<span class="hljs-number">8</span>] * <span class="hljs-number">5199</span> == <span class="hljs-number">4885863</span> )<br>s.add(arrayOfChar[<span class="hljs-number">0</span>] * <span class="hljs-number">3188</span> + arrayOfChar[<span class="hljs-number">1</span>] * <span class="hljs-number">6278</span> + arrayOfChar[<span class="hljs-number">2</span>] * <span class="hljs-number">9411</span> + arrayOfChar[<span class="hljs-number">3</span>] * <span class="hljs-number">5760</span> + arrayOfChar[<span class="hljs-number">4</span>] * <span class="hljs-number">9909</span> + arrayOfChar[<span class="hljs-number">5</span>] * <span class="hljs-number">7618</span> + arrayOfChar[<span class="hljs-number">6</span>] * <span class="hljs-number">7184</span> + arrayOfChar[<span class="hljs-number">7</span>] * <span class="hljs-number">4791</span> + arrayOfChar[<span class="hljs-number">8</span>] * <span class="hljs-number">8686</span> == <span class="hljs-number">6387690</span> )<br>s.add(arrayOfChar[<span class="hljs-number">0</span>] * <span class="hljs-number">8827</span> + arrayOfChar[<span class="hljs-number">1</span>] * <span class="hljs-number">7419</span> + arrayOfChar[<span class="hljs-number">2</span>] * <span class="hljs-number">7033</span> + arrayOfChar[<span class="hljs-number">3</span>] * <span class="hljs-number">9306</span> + arrayOfChar[<span class="hljs-number">4</span>] * <span class="hljs-number">7300</span> + arrayOfChar[<span class="hljs-number">5</span>] * <span class="hljs-number">5774</span> + arrayOfChar[<span class="hljs-number">6</span>] * <span class="hljs-number">6588</span> + arrayOfChar[<span class="hljs-number">7</span>] * <span class="hljs-number">5541</span> + arrayOfChar[<span class="hljs-number">8</span>] * <span class="hljs-number">4628</span> == <span class="hljs-number">6077067</span> )<br>s.add(arrayOfChar[<span class="hljs-number">0</span>] * <span class="hljs-number">5707</span> + arrayOfChar[<span class="hljs-number">1</span>] * <span class="hljs-number">5793</span> + arrayOfChar[<span class="hljs-number">2</span>] * <span class="hljs-number">4589</span> + arrayOfChar[<span class="hljs-number">3</span>] * <span class="hljs-number">6679</span> + arrayOfChar[<span class="hljs-number">4</span>] * <span class="hljs-number">3972</span> + arrayOfChar[<span class="hljs-number">5</span>] * <span class="hljs-number">5876</span> + arrayOfChar[<span class="hljs-number">6</span>] * <span class="hljs-number">6668</span> + arrayOfChar[<span class="hljs-number">7</span>] * <span class="hljs-number">5951</span> + arrayOfChar[<span class="hljs-number">8</span>] * <span class="hljs-number">9569</span> == <span class="hljs-number">5492294</span> )<br>s.add(arrayOfChar[<span class="hljs-number">0</span>] * <span class="hljs-number">9685</span> + arrayOfChar[<span class="hljs-number">1</span>] * <span class="hljs-number">7370</span> + arrayOfChar[<span class="hljs-number">2</span>] * <span class="hljs-number">4648</span> + arrayOfChar[<span class="hljs-number">3</span>] * <span class="hljs-number">7230</span> + arrayOfChar[<span class="hljs-number">4</span>] * <span class="hljs-number">9614</span> + arrayOfChar[<span class="hljs-number">5</span>] * <span class="hljs-number">9979</span> + arrayOfChar[<span class="hljs-number">6</span>] * <span class="hljs-number">8309</span> + arrayOfChar[<span class="hljs-number">7</span>] * <span class="hljs-number">9631</span> + arrayOfChar[<span class="hljs-number">8</span>] * <span class="hljs-number">9272</span> == <span class="hljs-number">7562511</span> )<br>s.add(arrayOfChar[<span class="hljs-number">0</span>] * <span class="hljs-number">6955</span> + arrayOfChar[<span class="hljs-number">1</span>] * <span class="hljs-number">8567</span> + arrayOfChar[<span class="hljs-number">2</span>] * <span class="hljs-number">7949</span> + arrayOfChar[<span class="hljs-number">3</span>] * <span class="hljs-number">8699</span> + arrayOfChar[<span class="hljs-number">4</span>] * <span class="hljs-number">3284</span> + arrayOfChar[<span class="hljs-number">5</span>] * <span class="hljs-number">6647</span> + arrayOfChar[<span class="hljs-number">6</span>] * <span class="hljs-number">3175</span> + arrayOfChar[<span class="hljs-number">7</span>] * <span class="hljs-number">8506</span> + arrayOfChar[<span class="hljs-number">8</span>] * <span class="hljs-number">6552</span> == <span class="hljs-number">5970432</span> )<br>s.add(arrayOfChar[<span class="hljs-number">0</span>] * <span class="hljs-number">4323</span> + arrayOfChar[<span class="hljs-number">1</span>] * <span class="hljs-number">4706</span> + arrayOfChar[<span class="hljs-number">2</span>] * <span class="hljs-number">8081</span> + arrayOfChar[<span class="hljs-number">3</span>] * <span class="hljs-number">7900</span> + arrayOfChar[<span class="hljs-number">4</span>] * <span class="hljs-number">4862</span> + arrayOfChar[<span class="hljs-number">5</span>] * <span class="hljs-number">9544</span> + arrayOfChar[<span class="hljs-number">6</span>] * <span class="hljs-number">5211</span> + arrayOfChar[<span class="hljs-number">7</span>] * <span class="hljs-number">7443</span> + arrayOfChar[<span class="hljs-number">8</span>] * <span class="hljs-number">5676</span> == <span class="hljs-number">5834523</span> )<br>s.add(arrayOfChar[<span class="hljs-number">0</span>] * <span class="hljs-number">3022</span> + arrayOfChar[<span class="hljs-number">1</span>] * <span class="hljs-number">8999</span> + arrayOfChar[<span class="hljs-number">2</span>] * <span class="hljs-number">5058</span> + arrayOfChar[<span class="hljs-number">3</span>] * <span class="hljs-number">4529</span> + arrayOfChar[<span class="hljs-number">4</span>] * <span class="hljs-number">3940</span> + arrayOfChar[<span class="hljs-number">5</span>] * <span class="hljs-number">4279</span> + arrayOfChar[<span class="hljs-number">6</span>] * <span class="hljs-number">4606</span> + arrayOfChar[<span class="hljs-number">7</span>] * <span class="hljs-number">3428</span> + arrayOfChar[<span class="hljs-number">8</span>] * <span class="hljs-number">8889</span> == <span class="hljs-number">4681110</span>)<br><span class="hljs-keyword">if</span> s.check() == sat:<br>    m = s.model()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(m[arrayOfChar[i]]))),end = <span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure>

<h3 id="6-15"><a href="#6-15" class="headerlink" title="6.15"></a>6.15</h3><h4 id="MoeCTF-2022-D-flat"><a href="#MoeCTF-2022-D-flat" class="headerlink" title="[MoeCTF 2022]D_flat"></a>[MoeCTF 2022]D_flat</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-variable">$flag</span> = [<span class="hljs-number">109</span>,<span class="hljs-number">111</span>,<span class="hljs-number">101</span>,<span class="hljs-number">99</span>,<span class="hljs-number">116</span>,<span class="hljs-number">102</span>,<span class="hljs-number">123</span>,<span class="hljs-number">68</span>,<span class="hljs-number">95</span>,<span class="hljs-number">102</span>,<span class="hljs-number">108</span>,<span class="hljs-number">97</span>,<span class="hljs-number">116</span>,<span class="hljs-number">101</span>,<span class="hljs-number">95</span>,<span class="hljs-number">105</span>,<span class="hljs-number">115</span>,<span class="hljs-number">95</span>,<span class="hljs-number">67</span>,<span class="hljs-number">95</span>,<span class="hljs-number">115</span>,<span class="hljs-number">104</span>,<span class="hljs-number">97</span>,<span class="hljs-number">114</span>,<span class="hljs-number">112</span>,<span class="hljs-number">33</span>,<span class="hljs-number">125</span>];<br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$flag</span>); <span class="hljs-variable">$i</span>++) &#123; <br>	<span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-variable">$flag</span>[<span class="hljs-variable">$i</span>]);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br>moectf&#123;D_flate_is_C_sharp!&#125;<br></code></pre></td></tr></table></figure>

<h3 id="6-16"><a href="#6-16" class="headerlink" title="6.16"></a>6.16</h3><h4 id="MoeCTF-2022-fake-key"><a href="#MoeCTF-2022-fake-key" class="headerlink" title="[MoeCTF 2022]fake_key"></a>[MoeCTF 2022]fake_key</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs c">_BOOL8 __fastcall <span class="hljs-title function_">sub_4015A2</span><span class="hljs-params">(__int64 a1, __int64 a2)</span><br>&#123;<br>  <span class="hljs-type">char</span> v2; <span class="hljs-comment">// dl</span><br>  <span class="hljs-type">int</span> v3; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v5; <span class="hljs-comment">// [rsp+8h] [rbp-8h]</span><br>  <span class="hljs-type">int</span> v6; <span class="hljs-comment">// [rsp+Ch] [rbp-4h]</span><br><br>  v6 = <span class="hljs-number">0</span>;<br>  v5 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">while</span> ( v6 &lt;= <span class="hljs-number">28</span> )<br>  &#123;<br>    v2 = *(_BYTE *)(a1 + v6);<br>    v3 = v6++;<br>    <span class="hljs-keyword">if</span> ( v2 == *(_BYTE *)(a2 + v3) )<br>      ++v5;<br>  &#125;<br>  <span class="hljs-keyword">return</span> v5 == <span class="hljs-number">29</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span> <span class="hljs-type">const</span> *argv[])</span><br>&#123;<br>	<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">28</span>; ++i)<br>	&#123;<br>		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d,&quot;</span>, rand() % <span class="hljs-number">10</span>);<br>	&#125;<br>	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python">cip = [<span class="hljs-number">0x15</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x3A</span>,<br>       <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x0C</span>,<br>       <span class="hljs-number">0x74</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x1F</span>]<br>key = [<br>    <span class="hljs-number">0x79</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x54</span>,<br>    <span class="hljs-number">0x43</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x59</span>,<br>    <span class="hljs-number">0x44</span>, <span class="hljs-number">0x53</span><br>]<br>rand_num = [<span class="hljs-number">1</span>, <span class="hljs-number">7</span>, <span class="hljs-number">4</span>, <span class="hljs-number">0</span>, <span class="hljs-number">9</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">7</span>,<br>            <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">7</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>]<br>tmp = []<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(cip)):<br>    tmp.append(cip[i]-rand_num[i])<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(tmp)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(tmp[i] ^ key[i % <span class="hljs-built_in">len</span>(key)]), end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-comment"># print(tmp)</span><br><br></code></pre></td></tr></table></figure>

<h3 id="6-17"><a href="#6-17" class="headerlink" title="6.17"></a>6.17</h3><h4 id="SDCTF-2022-A-Bowl-of-Pythons"><a href="#SDCTF-2022-A-Bowl-of-Pythons" class="headerlink" title="[SDCTF 2022]A Bowl of Pythons"></a>[SDCTF 2022]A Bowl of Pythons</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">f = <span class="hljs-string">b&#x27;co\\7\x7f\x7f`|p\x15\x0e\x8a\x0fP\x14\x18\xfe\xa9\xf3\xe2y\xdd&#x27;</span><br><span class="hljs-comment"># if bytes((g[i] ^ (a(i) &amp; 0xff) for i in range(len(g)))) != f:</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(f)):<br>    s = a(i) &amp; <span class="hljs-number">0xff</span><br>    flag = s ^ f[i]<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(flag), end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-comment">#an_3xtra_YuMMY_LaZagnA</span><br></code></pre></td></tr></table></figure>

<h3 id="6-18"><a href="#6-18" class="headerlink" title="6.18"></a>6.18</h3><h4 id="MoeCTF-2022-Art"><a href="#MoeCTF-2022-Art" class="headerlink" title="[MoeCTF 2022]Art"></a>[MoeCTF 2022]Art</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python">data=<span class="hljs-string">&#x27;02 18 0f f8 19 04 27 d8 eb 00 35 48 4d 2a 45 6b 59 2e 43 01 18 5c 09 09 09 09 b5 7d&#x27;</span><br>data=data.split(<span class="hljs-string">&#x27; &#x27;</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encode</span>(<span class="hljs-params">first,second</span>):<br>   <span class="hljs-keyword">return</span> <span class="hljs-built_in">ord</span>(first)^<span class="hljs-built_in">ord</span>(second)+<span class="hljs-built_in">ord</span>(first)%<span class="hljs-number">17</span>^<span class="hljs-number">0x19</span><br>flag=<span class="hljs-string">&#x27;moectf&#123;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>,<span class="hljs-number">28</span>):<br>   current_first=flag[i]<br>   <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;current_first:&quot;</span>+current_first+<span class="hljs-string">&quot;\n&quot;</span>)<br>   expected_value=<span class="hljs-built_in">int</span>(data[i],<span class="hljs-number">16</span>)<br>   <span class="hljs-keyword">for</span> letter <span class="hljs-keyword">in</span> printable:<br>      result=encode(current_first,letter)<br>      <span class="hljs-keyword">if</span> result==expected_value:<br>         flag+=letter<br>         <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<h3 id="6-19"><a href="#6-19" class="headerlink" title="6.19"></a>6.19</h3><h4 id="长城杯-2022-高校组-baby-re"><a href="#长城杯-2022-高校组-baby-re" class="headerlink" title="[长城杯 2022 高校组]baby_re"></a>[长城杯 2022 高校组]baby_re</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> new <span class="hljs-keyword">import</span> *<br><br>  <br><br>flag = <span class="hljs-string">&#x27;5WEU5ROREb0hK+AurHXCD80or/h96jqpjEhcoh2CuDh=&#x27;</span><br>word = <span class="hljs-built_in">list</span>(word)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test1</span>():<br>    x = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(flag)//<span class="hljs-number">4</span>):<br>        <span class="hljs-built_in">print</span>(x)<br>        t = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">for</span> i1 <span class="hljs-keyword">in</span> word:<br>            <span class="hljs-keyword">for</span> i2 <span class="hljs-keyword">in</span> word:<br>                <span class="hljs-keyword">for</span> i3 <span class="hljs-keyword">in</span> word:<br>                    <span class="hljs-keyword">if</span> t == <span class="hljs-number">0</span>:<br>                        <span class="hljs-keyword">break</span><br>                    tmp1 = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;i1&#125;</span><span class="hljs-subst">&#123;i2&#125;</span><span class="hljs-subst">&#123;i3&#125;</span>&#x27;</span><br>                    tmp2 = mmo(x + tmp1)()<br>                    <span class="hljs-keyword">if</span> tmp2 == flag[:<span class="hljs-built_in">len</span>(tmp2)]:<br>                        <span class="hljs-built_in">print</span>(tmp2)<br>                        x += tmp1<br>                        t = <span class="hljs-number">0</span><br><br>test1()<br><span class="hljs-comment">#5WEU5ROREb0hK+AurHXCD80or/h96jqpjEhcoh2C</span><br>x =<span class="hljs-string">&#x27;8b98aa2e10ac53e21240ee10a9054b&#x27;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs pyhton">x =&#x27;8b98aa2e10ac53e21240ee10a9054b&#x27;<br><br>for i1 in word:<br>   for i2 in word:<br>        tmp1 = f&#x27;&#123;i1&#125;&#123;i2&#125;&#x27;<br>        tmp2 = mmo(x + tmp1)()<br>        if tmp2 == flag:<br>            print(tmp2)<br>            print(x + tmp1)<br><br># 5WEU5ROREb0hK+AurHXCD80or/h96jqpjEhcoh2CuDh=<br># flag = 8b98aa2e10ac53e21240ee10a9054be3<br></code></pre></td></tr></table></figure>

<h3 id="6-20"><a href="#6-20" class="headerlink" title="6.20"></a>6.20</h3><h4 id="MoeCTF-2021-midpython"><a href="#MoeCTF-2021-midpython" class="headerlink" title="[MoeCTF 2021]midpython"></a>[MoeCTF 2021]midpython</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><code class="hljs python">              <span class="hljs-number">2</span> LOAD_CONST               <span class="hljs-number">0</span> ((<span class="hljs-number">69</span>, <span class="hljs-number">70</span>, <span class="hljs-number">79</span>, <span class="hljs-number">72</span>, <span class="hljs-number">88</span>, <span class="hljs-number">75</span>, <span class="hljs-number">85</span>, <span class="hljs-number">127</span>, <span class="hljs-number">89</span>, <span class="hljs-number">85</span>, <span class="hljs-number">74</span>, <span class="hljs-number">19</span>, <span class="hljs-number">74</span>, <span class="hljs-number">122</span>, <span class="hljs-number">107</span>, <span class="hljs-number">103</span>, <span class="hljs-number">75</span>, <span class="hljs-number">77</span>, <span class="hljs-number">9</span>, <span class="hljs-number">73</span>, <span class="hljs-number">29</span>, <span class="hljs-number">28</span>, <span class="hljs-number">67</span>))<br>              <span class="hljs-number">4</span> CALL_FINALLY             <span class="hljs-number">1</span> (to <span class="hljs-number">7</span>)<br>              <span class="hljs-number">6</span> STORE_NAME               <span class="hljs-number">0</span> (key)<br><br>  <span class="hljs-number">2</span>           <span class="hljs-number">8</span> LOAD_CONST               <span class="hljs-number">1</span> (&lt;code <span class="hljs-built_in">object</span> &lt;<span class="hljs-keyword">lambda</span>&gt; at <span class="hljs-number">0x000001C308563EA0</span>, file <span class="hljs-string">&quot;\\Mac\Home\NSSCTF\problems\moeCTF_2021\Challenges\Reverse\midpython\Midpython.py&quot;</span>, line <span class="hljs-number">2</span>&gt;)<br>             <span class="hljs-number">10</span> LOAD_CONST               <span class="hljs-number">2</span> (<span class="hljs-string">&#x27;&lt;lambda&gt;&#x27;</span>)<br>             <span class="hljs-number">12</span> MAKE_FUNCTION            <span class="hljs-number">0</span><br>             <span class="hljs-number">14</span> STORE_NAME               <span class="hljs-number">1</span> (xxor)<br><br>  <span class="hljs-number">3</span>          <span class="hljs-number">16</span> LOAD_CONST               <span class="hljs-number">3</span> (&lt;code <span class="hljs-built_in">object</span> &lt;<span class="hljs-keyword">lambda</span>&gt; at <span class="hljs-number">0x000001C308563F50</span>, file <span class="hljs-string">&quot;\\Mac\Home\NSSCTF\problems\moeCTF_2021\Challenges\Reverse\midpython\Midpython.py&quot;</span>, line <span class="hljs-number">3</span>&gt;)<br>             <span class="hljs-number">18</span> LOAD_CONST               <span class="hljs-number">2</span> (<span class="hljs-string">&#x27;&lt;lambda&gt;&#x27;</span>)<br>             <span class="hljs-number">20</span> MAKE_FUNCTION            <span class="hljs-number">0</span><br>             <span class="hljs-number">22</span> STORE_NAME               <span class="hljs-number">2</span> (xoor)<br><br>  <span class="hljs-number">4</span>          <span class="hljs-number">24</span> LOAD_CONST               <span class="hljs-number">4</span> (&lt;code <span class="hljs-built_in">object</span> &lt;<span class="hljs-keyword">lambda</span>&gt; at <span class="hljs-number">0x000001C30856A030</span>, file <span class="hljs-string">&quot;\\Mac\Home\NSSCTF\problems\moeCTF_2021\Challenges\Reverse\midpython\Midpython.py&quot;</span>, line <span class="hljs-number">4</span>&gt;)<br>             <span class="hljs-number">26</span> LOAD_CONST               <span class="hljs-number">2</span> (<span class="hljs-string">&#x27;&lt;lambda&gt;&#x27;</span>)<br>             <span class="hljs-number">28</span> MAKE_FUNCTION            <span class="hljs-number">0</span><br>             <span class="hljs-number">30</span> STORE_NAME               <span class="hljs-number">3</span> (xorr)<br><br>  <span class="hljs-number">5</span>          <span class="hljs-number">32</span> LOAD_NAME                <span class="hljs-number">4</span> (<span class="hljs-built_in">len</span>)<br>             <span class="hljs-number">34</span> LOAD_NAME                <span class="hljs-number">0</span> (key)<br>             <span class="hljs-number">36</span> CALL_FUNCTION            <span class="hljs-number">1</span><br>             <span class="hljs-number">38</span> STORE_NAME               <span class="hljs-number">5</span> (length)<br><br>  <span class="hljs-number">6</span>          <span class="hljs-number">40</span> LOAD_NAME                <span class="hljs-number">6</span> (<span class="hljs-built_in">input</span>)<br>             <span class="hljs-number">42</span> LOAD_CONST               <span class="hljs-number">5</span> (<span class="hljs-string">&#x27;&gt;&gt;&gt;input your flag:\n&gt;&gt;&gt;&#x27;</span>)<br>             <span class="hljs-number">44</span> CALL_FUNCTION            <span class="hljs-number">1</span><br>             <span class="hljs-number">46</span> STORE_NAME               <span class="hljs-number">7</span> (ipt)<br><br>  <span class="hljs-number">7</span>          <span class="hljs-number">48</span> LOAD_CONST               <span class="hljs-number">6</span> (<span class="hljs-number">1</span>)<br>             <span class="hljs-number">50</span> STORE_NAME               <span class="hljs-number">8</span> (flag)<br><br>  <span class="hljs-number">8</span>          <span class="hljs-number">52</span> LOAD_NAME                <span class="hljs-number">4</span> (<span class="hljs-built_in">len</span>)<br>             <span class="hljs-number">54</span> LOAD_NAME                <span class="hljs-number">7</span> (ipt)<br>             <span class="hljs-number">56</span> CALL_FUNCTION            <span class="hljs-number">1</span><br>             <span class="hljs-number">58</span> LOAD_NAME                <span class="hljs-number">5</span> (length)<br>             <span class="hljs-number">60</span> COMPARE_OP               <span class="hljs-number">2</span> (==)<br>             <span class="hljs-number">62</span> POP_JUMP_IF_FALSE      <span class="hljs-number">114</span><br><br>  <span class="hljs-number">9</span>          <span class="hljs-number">64</span> LOAD_NAME                <span class="hljs-number">9</span> (<span class="hljs-built_in">range</span>)<br>             <span class="hljs-number">66</span> LOAD_NAME                <span class="hljs-number">5</span> (length)<br>             <span class="hljs-number">68</span> CALL_FUNCTION            <span class="hljs-number">1</span><br>             <span class="hljs-number">70</span> GET_ITER<br>        &gt;&gt;   <span class="hljs-number">72</span> FOR_ITER                <span class="hljs-number">38</span> (to <span class="hljs-number">112</span>)<br>             <span class="hljs-number">74</span> STORE_NAME              <span class="hljs-number">10</span> (i)<br><br> <span class="hljs-number">10</span>          <span class="hljs-number">76</span> LOAD_NAME                <span class="hljs-number">3</span> (xorr)<br>             <span class="hljs-number">78</span> LOAD_NAME               <span class="hljs-number">11</span> (<span class="hljs-built_in">ord</span>)<br>             <span class="hljs-number">80</span> LOAD_NAME                <span class="hljs-number">7</span> (ipt)<br>             <span class="hljs-number">82</span> LOAD_NAME               <span class="hljs-number">10</span> (i)<br>             <span class="hljs-number">84</span> BINARY_SUBSCR<br>             <span class="hljs-number">86</span> CALL_FUNCTION            <span class="hljs-number">1</span><br>             <span class="hljs-number">88</span> LOAD_NAME               <span class="hljs-number">10</span> (i)<br>             <span class="hljs-number">90</span> CALL_FUNCTION            <span class="hljs-number">2</span><br>             <span class="hljs-number">92</span> LOAD_NAME                <span class="hljs-number">0</span> (key)<br>             <span class="hljs-number">94</span> LOAD_NAME               <span class="hljs-number">10</span> (i)<br>             <span class="hljs-number">96</span> BINARY_SUBSCR<br>             <span class="hljs-number">98</span> COMPARE_OP               <span class="hljs-number">3</span> (!=)<br>            <span class="hljs-number">100</span> POP_JUMP_IF_FALSE       <span class="hljs-number">72</span><br><br> <span class="hljs-number">11</span>         <span class="hljs-number">102</span> LOAD_CONST               <span class="hljs-number">7</span> (<span class="hljs-number">0</span>)<br>            <span class="hljs-number">104</span> STORE_NAME               <span class="hljs-number">8</span> (flag)<br><br> <span class="hljs-number">12</span>         <span class="hljs-number">106</span> POP_TOP<br>            <span class="hljs-number">108</span> JUMP_ABSOLUTE          <span class="hljs-number">118</span><br>            <span class="hljs-number">110</span> JUMP_ABSOLUTE           <span class="hljs-number">72</span><br>        &gt;&gt;  <span class="hljs-number">112</span> JUMP_FORWARD             <span class="hljs-number">4</span> (to <span class="hljs-number">118</span>)<br><br> <span class="hljs-number">14</span>     &gt;&gt;  <span class="hljs-number">114</span> LOAD_CONST               <span class="hljs-number">7</span> (<span class="hljs-number">0</span>)<br>            <span class="hljs-number">116</span> STORE_NAME               <span class="hljs-number">8</span> (flag)<br><br> <span class="hljs-number">15</span>     &gt;&gt;  <span class="hljs-number">118</span> LOAD_NAME                <span class="hljs-number">8</span> (flag)<br>            <span class="hljs-number">120</span> LOAD_CONST               <span class="hljs-number">6</span> (<span class="hljs-number">1</span>)<br>            <span class="hljs-number">122</span> COMPARE_OP               <span class="hljs-number">2</span> (==)<br>            <span class="hljs-number">124</span> POP_JUMP_IF_FALSE      <span class="hljs-number">136</span><br><br> <span class="hljs-number">16</span>         <span class="hljs-number">126</span> LOAD_NAME               <span class="hljs-number">12</span> (<span class="hljs-built_in">print</span>)<br>            <span class="hljs-number">128</span> LOAD_CONST               <span class="hljs-number">8</span> (<span class="hljs-string">&#x27;&gt;&gt;&gt;Right!!&#x27;</span>)<br>            <span class="hljs-number">130</span> CALL_FUNCTION            <span class="hljs-number">1</span><br>            <span class="hljs-number">132</span> POP_TOP<br>            <span class="hljs-number">134</span> JUMP_FORWARD             <span class="hljs-number">8</span> (to <span class="hljs-number">144</span>)<br><br> <span class="hljs-number">18</span>     &gt;&gt;  <span class="hljs-number">136</span> LOAD_NAME               <span class="hljs-number">12</span> (<span class="hljs-built_in">print</span>)<br>            <span class="hljs-number">138</span> LOAD_CONST               <span class="hljs-number">9</span> (<span class="hljs-string">&#x27;&gt;&gt;&gt;Wrong!!&#x27;</span>)<br>            <span class="hljs-number">140</span> CALL_FUNCTION            <span class="hljs-number">1</span><br>            <span class="hljs-number">142</span> POP_TOP<br>        &gt;&gt;  <span class="hljs-number">144</span> LOAD_CONST              <span class="hljs-number">10</span> (<span class="hljs-literal">None</span>)<br>            <span class="hljs-number">146</span> RETURN_VALUE<br><br>Disassembly of &lt;code <span class="hljs-built_in">object</span> &lt;<span class="hljs-keyword">lambda</span>&gt; at <span class="hljs-number">0x000001C308563EA0</span>, file <span class="hljs-string">&quot;\\Mac\Home\NSSCTF\problems\moeCTF_2021\Challenges\Reverse\midpython\Midpython.py&quot;</span>, line <span class="hljs-number">2</span>&gt;:<br>  <span class="hljs-number">2</span>           <span class="hljs-number">0</span> LOAD_FAST                <span class="hljs-number">0</span> (x)<br>              <span class="hljs-number">2</span> LOAD_FAST                <span class="hljs-number">1</span> (y)<br>              <span class="hljs-number">4</span> BINARY_XOR<br>              <span class="hljs-number">6</span> LOAD_CONST               <span class="hljs-number">1</span> (<span class="hljs-number">11</span>)<br>              <span class="hljs-number">8</span> BINARY_XOR<br>             <span class="hljs-number">10</span> RETURN_VALUE<br><br>Disassembly of &lt;code <span class="hljs-built_in">object</span> &lt;<span class="hljs-keyword">lambda</span>&gt; at <span class="hljs-number">0x000001C308563F50</span>, file <span class="hljs-string">&quot;\\Mac\Home\NSSCTF\problems\moeCTF_2021\Challenges\Reverse\midpython\Midpython.py&quot;</span>, line <span class="hljs-number">3</span>&gt;:<br>  <span class="hljs-number">3</span>           <span class="hljs-number">0</span> LOAD_GLOBAL              <span class="hljs-number">0</span> (xxor)<br>              <span class="hljs-number">2</span> LOAD_FAST                <span class="hljs-number">0</span> (x)<br>              <span class="hljs-number">4</span> LOAD_FAST                <span class="hljs-number">1</span> (y)<br>              <span class="hljs-number">6</span> CALL_FUNCTION            <span class="hljs-number">2</span><br>              <span class="hljs-number">8</span> LOAD_CONST               <span class="hljs-number">1</span> (<span class="hljs-number">45</span>)<br>             <span class="hljs-number">10</span> BINARY_XOR<br>             <span class="hljs-number">12</span> RETURN_VALUE<br><br>Disassembly of &lt;code <span class="hljs-built_in">object</span> &lt;<span class="hljs-keyword">lambda</span>&gt; at <span class="hljs-number">0x000001C30856A030</span>, file <span class="hljs-string">&quot;\\Mac\Home\NSSCTF\problems\moeCTF_2021\Challenges\Reverse\midpython\Midpython.py&quot;</span>, line <span class="hljs-number">4</span>&gt;:<br>  <span class="hljs-number">4</span>           <span class="hljs-number">0</span> LOAD_GLOBAL              <span class="hljs-number">0</span> (xoor)<br>              <span class="hljs-number">2</span> LOAD_FAST                <span class="hljs-number">0</span> (x)<br>              <span class="hljs-number">4</span> LOAD_FAST                <span class="hljs-number">1</span> (y)<br>              <span class="hljs-number">6</span> CALL_FUNCTION            <span class="hljs-number">2</span><br>              <span class="hljs-number">8</span> LOAD_CONST               <span class="hljs-number">1</span> (<span class="hljs-number">14</span>)<br>             <span class="hljs-number">10</span> BINARY_XOR<br>             <span class="hljs-number">12</span> RETURN_VALUE<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python">xxor = <span class="hljs-keyword">lambda</span> x, y: (x ^ y) ^ <span class="hljs-number">11</span><br>xoor = <span class="hljs-keyword">lambda</span> x, y: (xxor(x, y) ^ <span class="hljs-number">45</span>)<br>xorr = <span class="hljs-keyword">lambda</span> x, y: (xoor(x, y) ^ <span class="hljs-number">14</span>)<br><br>length = <span class="hljs-built_in">len</span>(key)<br>ipt = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;&gt;&gt;&gt;input your flag:\n&gt;&gt;&gt;&quot;</span>)<br>flag = <span class="hljs-number">1</span><br><br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(ipt) == length:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length):<br>        <span class="hljs-keyword">if</span> xorr(<span class="hljs-built_in">ord</span>(ipt[i]), i) != key[i]:<br>            flag = <span class="hljs-number">0</span><br>            <span class="hljs-keyword">break</span><br><span class="hljs-keyword">else</span>:<br>    flag = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">if</span> flag == <span class="hljs-number">1</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&gt;&gt;&gt;Right!!&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&gt;&gt;&gt;Wrong!!&quot;</span>)<br><br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><br>xxor = <span class="hljs-keyword">lambda</span> x, y: (x ^ y) ^ <span class="hljs-number">11</span> ^ <span class="hljs-number">45</span> ^ <span class="hljs-number">14</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(key)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(xxor(key[i], i)), end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-comment">#moectf&#123;Pyth0n_M@st3r!!&#125;</span><br></code></pre></td></tr></table></figure>

<h3 id="6-21"><a href="#6-21" class="headerlink" title="6.21"></a>6.21</h3><h4 id="MoeCTF-2021-EinfachRe"><a href="#MoeCTF-2021-EinfachRe" class="headerlink" title="[MoeCTF 2021]EinfachRe"></a>[MoeCTF 2021]EinfachRe</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">EinfachRe</span>():<br>    enflag = [<span class="hljs-number">0x28</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x3a</span>, <span class="hljs-number">0x1b</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">6</span>] <span class="hljs-comment">#在IDA中找到相应值</span><br>    flag = <span class="hljs-string">&#x27;moectf&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(flag[i]) ^ enflag[i]), end=<span class="hljs-string">&#x27;&#x27;</span>)<br>EinfachRe()<br></code></pre></td></tr></table></figure>

<h3 id="6-22"><a href="#6-22" class="headerlink" title="6.22"></a>6.22</h3><h4 id="MoeCTF-2022-Broken-hash"><a href="#MoeCTF-2022-Broken-hash" class="headerlink" title="[MoeCTF 2022]Broken_hash"></a>[MoeCTF 2022]Broken_hash</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">enc = [<span class="hljs-number">1685343386</span>, <span class="hljs-number">75247601</span>, <span class="hljs-number">2732016274</span>, <span class="hljs-number">2243884926</span>, <span class="hljs-number">1897909239</span>, <span class="hljs-number">1721636361</span>, <span class="hljs-number">1807588790</span>, <span class="hljs-number">1765918884</span>, <span class="hljs-number">2976794803</span>, <span class="hljs-number">3727823238</span>, <span class="hljs-number">1381099714</span>, <span class="hljs-number">4220491175</span>, <span class="hljs-number">1897909239</span>, <span class="hljs-number">3411820461</span>, <span class="hljs-number">911641333</span>, <span class="hljs-number">4220491175</span>, <span class="hljs-number">2192374122</span>, <span class="hljs-number">1977406832</span>, <span class="hljs-number">2129661504</span>, <span class="hljs-number">4220491175</span>, <span class="hljs-number">1273573706</span>, <span class="hljs-number">3411820461</span>, <span class="hljs-number">2732016274</span>, <span class="hljs-number">3727823238</span>, <span class="hljs-number">4220491175</span>, <span class="hljs-number">1184006056</span>, <span class="hljs-number">2976794803</span>, <span class="hljs-number">3619791888</span>, <span class="hljs-number">1450407363</span>, <span class="hljs-number">1897909239</span>, <span class="hljs-number">4220491175</span>, <span class="hljs-number">2618945779</span>, <span class="hljs-number">3493194004</span>, <span class="hljs-number">4220491175</span>, <span class="hljs-number">1765918884</span>, <span class="hljs-number">192746389</span>, <span class="hljs-number">3619791888</span>, <span class="hljs-number">3363470462</span>, <span class="hljs-number">4220491175</span>, <span class="hljs-number">3619791888</span>, <span class="hljs-number">3727823238</span>, <span class="hljs-number">1381099714</span>, <span class="hljs-number">4220491175</span>, <span class="hljs-number">3577220178</span>, <span class="hljs-number">3198786875</span>, <span class="hljs-number">3470489938</span>, <span class="hljs-number">4220491175</span>, <span class="hljs-number">1933927200</span>, <span class="hljs-number">3619791888</span>, <span class="hljs-number">3727823238</span>, <span class="hljs-number">4220491175</span>, <span class="hljs-number">1478334949</span>, <span class="hljs-number">2732016274</span>, <span class="hljs-number">1897909239</span>, <span class="hljs-number">4220491175</span>, <span class="hljs-number">104278034</span>, <span class="hljs-number">4220491175</span>, <span class="hljs-number">1933927200</span>, <span class="hljs-number">3470489938</span>, <span class="hljs-number">4015252052</span>, <span class="hljs-number">4220491175</span>, <span class="hljs-number">2668773965</span>, <span class="hljs-number">1721636361</span>, <span class="hljs-number">4220491175</span>, <span class="hljs-number">2618945779</span>, <span class="hljs-number">4275009157</span>, <span class="hljs-number">192746389</span>, <span class="hljs-number">406055089</span>, <span class="hljs-number">4220491175</span>, <span class="hljs-number">2674318596</span>, <span class="hljs-number">2732016274</span>, <span class="hljs-number">3619791888</span>, <span class="hljs-number">4220491175</span>, <span class="hljs-number">1765918884</span>, <span class="hljs-number">2255269711</span>, <span class="hljs-number">75247601</span>, <span class="hljs-number">1685343386</span>, <span class="hljs-number">4220491175</span>, <span class="hljs-number">3577220178</span>, <span class="hljs-number">3470489938</span>, <span class="hljs-number">3727823238</span>, <span class="hljs-number">2168798531</span>, <span class="hljs-number">3411820461</span>, <span class="hljs-number">2976794803</span>, <span class="hljs-number">3313039427</span>, <span class="hljs-number">3470489938</span>, <span class="hljs-number">3727823238</span>, <span class="hljs-number">3817631495</span>, <span class="hljs-number">2342426536</span>, <span class="hljs-number">2413797087</span>, <span class="hljs-number">3515255702</span>, <span class="hljs-number">2477773265</span>, <span class="hljs-number">2374754181</span>, <span class="hljs-number">2560548742</span>, <span class="hljs-number">3750860446</span>, <span class="hljs-number">4123238593</span>]<br>dic=[<span class="hljs-number">0x0BEA99D3B</span>,<span class="hljs-number">0x0B16E48B3</span>,<span class="hljs-number">0x5C6054F</span>,<span class="hljs-number">0x36568AF5</span>,<span class="hljs-number">0x0BEA2375F</span>,<span class="hljs-number">0x567375C3</span>,<span class="hljs-number">0x0BF0FD0CB</span>,<span class="hljs-number">0x4BE9314A</span>,<span class="hljs-number">0x7F2A2EBE</span>,<span class="hljs-number">0x0C87A7C7E</span>,<span class="hljs-number">0x0D7C1A410</span>,<span class="hljs-number">0x9E3919E7</span>,<span class="hljs-number">0x85BEF77E</span>,<span class="hljs-number">0x5251E8C2</span>,<span class="hljs-number">0x0A2D74292</span>,<span class="hljs-number">0x669E1609</span>,<span class="hljs-number">0x5C1DFF11</span>,<span class="hljs-number">0x0CB5C3FAD</span>,<span class="hljs-number">0x0FECF7685</span>,<span class="hljs-number">0x0B0F33A9A</span>,<span class="hljs-number">0x1833E8B1</span>,<span class="hljs-number">0x0B7D1395</span>,<span class="hljs-number">0x64744C9A</span>,<span class="hljs-number">0x0DE321186</span>,<span class="hljs-number">0x47C2FF1</span>,<span class="hljs-number">0x0EF53E254</span>,<span class="hljs-number">0x1902B329</span>,<span class="hljs-number">0x866CAF4F</span>,<span class="hljs-number">0x4A528AE0</span>,<span class="hljs-number">0x711FCBF7</span>,<span class="hljs-number">0x0CEDB7952</span>,<span class="hljs-number">0x352B172C</span>,<span class="hljs-number">0x0AFEA7FF6</span>,<span class="hljs-number">0x3175EDAB</span>,<span class="hljs-number">0x0D035E914</span>,<span class="hljs-number">0x20D324AE</span>,<span class="hljs-number">0x6372812</span>,<span class="hljs-number">0x46927FA8</span>,<span class="hljs-number">0x73456320</span>,<span class="hljs-number">0x4E3F843</span>,<span class="hljs-number">0x75DCD570</span>,<span class="hljs-number">0x6941C8A4</span>,<span class="hljs-number">0x581D99E5</span>,<span class="hljs-number">0x7EF00E40</span>,<span class="hljs-number">0x7A260E4D</span>,<span class="hljs-number">0x0C578F843</span>,<span class="hljs-number">0x17947C53</span>,<span class="hljs-number">0x786C70</span>,<span class="hljs-number">0x9C19F0F3</span>,<span class="hljs-number">0x1D795AC9</span>,<span class="hljs-number">0x9F12424D</span>,<span class="hljs-number">0x0AB021E08</span>,<span class="hljs-number">0x77ACB10</span>,<span class="hljs-number">0x0D1D0F68E</span>,<span class="hljs-number">0x82ACF96A</span>,<span class="hljs-number">0x9F66DD04</span>,<span class="hljs-number">0x8AD9BAF7</span>,<span class="hljs-number">0x0AAE6D8C9</span>,<span class="hljs-number">0x0E73CAEF</span>,<span class="hljs-number">0x0BFC92893</span>,<span class="hljs-number">0x0D5380C52</span>,<span class="hljs-number">0x81453D43</span>,<span class="hljs-number">0x94D2FB03</span>,<span class="hljs-number">0x17AA5D21</span>,<span class="hljs-number">0x359A6F74</span>,<span class="hljs-number">0x0E3FC2922</span>,<span class="hljs-number">0x0B12D13F1</span>,<span class="hljs-number">0x0E3F11899</span>,<span class="hljs-number">0x8BC73EC0</span>,<span class="hljs-number">0x0F9B5524E</span>,<span class="hljs-number">0x3C661DDC</span>,<span class="hljs-number">0x0A4896A25</span>,<span class="hljs-number">0x0EADC6BE1</span>,<span class="hljs-number">0x0C6059399</span>,<span class="hljs-number">0x41274AD3</span>,<span class="hljs-number">0x0CCB1F1EC</span>,<span class="hljs-number">0x717EEA6E</span>,<span class="hljs-number">0x0D9C61FD</span>,<span class="hljs-number">0x0FB8F95A7</span>,<span class="hljs-number">0x6BBD9DB6</span>,<span class="hljs-number">0x0BF9FE524</span>,<span class="hljs-number">0x0E38C6F07</span>,<span class="hljs-number">0x7C710092</span>,<span class="hljs-number">0x0BEA99D3B</span>,<span class="hljs-number">0x0BEA99D3B</span>,<span class="hljs-number">0x0BEA99D3B</span>,<span class="hljs-number">0x0BEA99D3B</span>,<span class="hljs-number">0x0BEA99D3B</span>]<br>dictionary = &#123;<span class="hljs-number">3198786875</span>: <span class="hljs-string">&#x27;0&#x27;</span>, <span class="hljs-number">2976794803</span>: <span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-number">96863567</span>: <span class="hljs-string">&#x27;2&#x27;</span>, <span class="hljs-number">911641333</span>: <span class="hljs-string">&#x27;3&#x27;</span>, <span class="hljs-number">3198302047</span>: <span class="hljs-string">&#x27;4&#x27;</span>, <span class="hljs-number">1450407363</span>: <span class="hljs-string">&#x27;5&#x27;</span>, <span class="hljs-number">3205484747</span>: <span class="hljs-string">&#x27;6&#x27;</span>, <span class="hljs-number">1273573706</span>: <span class="hljs-string">&#x27;7&#x27;</span>, <span class="hljs-number">2133470910</span>: <span class="hljs-string">&#x27;8&#x27;</span>, <span class="hljs-number">3363470462</span>: <span class="hljs-string">&#x27;9&#x27;</span>, <span class="hljs-number">3619791888</span>: <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-number">2654542311</span>: <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-number">2243884926</span>: <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-number">1381099714</span>: <span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-number">2732016274</span>: <span class="hljs-string">&#x27;e&#x27;</span>, <span class="hljs-number">1721636361</span>: <span class="hljs-string">&#x27;f&#x27;</span>, <span class="hljs-number">1545469713</span>: <span class="hljs-string">&#x27;g&#x27;</span>, <span class="hljs-number">3411820461</span>: <span class="hljs-string">&#x27;h&#x27;</span>, <span class="hljs-number">4275009157</span>: <span class="hljs-string">&#x27;i&#x27;</span>, <span class="hljs-number">2968730266</span>: <span class="hljs-string">&#x27;j&#x27;</span>, <span class="hljs-number">406055089</span>: <span class="hljs-string">&#x27;k&#x27;</span>, <span class="hljs-number">192746389</span>: <span class="hljs-string">&#x27;l&#x27;</span>, <span class="hljs-number">1685343386</span>: <span class="hljs-string">&#x27;m&#x27;</span>, <span class="hljs-number">3727823238</span>: <span class="hljs-string">&#x27;n&#x27;</span>, <span class="hljs-number">75247601</span>: <span class="hljs-string">&#x27;o&#x27;</span>, <span class="hljs-number">4015252052</span>: <span class="hljs-string">&#x27;p&#x27;</span>, <span class="hljs-number">419607337</span>: <span class="hljs-string">&#x27;q&#x27;</span>, <span class="hljs-number">2255269711</span>: <span class="hljs-string">&#x27;r&#x27;</span>, <span class="hljs-number">1246923488</span>: <span class="hljs-string">&#x27;s&#x27;</span>, <span class="hljs-number">1897909239</span>: <span class="hljs-string">&#x27;t&#x27;</span>, <span class="hljs-number">3470489938</span>: <span class="hljs-string">&#x27;u&#x27;</span>, <span class="hljs-number">892016428</span>: <span class="hljs-string">&#x27;v&#x27;</span>, <span class="hljs-number">2951380982</span>: <span class="hljs-string">&#x27;w&#x27;</span>, <span class="hljs-number">829812139</span>: <span class="hljs-string">&#x27;x&#x27;</span>, <span class="hljs-number">3493194004</span>: <span class="hljs-string">&#x27;y&#x27;</span>, <span class="hljs-number">550708398</span>: <span class="hljs-string">&#x27;z&#x27;</span>, <span class="hljs-number">104278034</span>: <span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-number">1184006056</span>: <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-number">1933927200</span>: <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-number">82049091</span>: <span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-number">1977406832</span>: <span class="hljs-string">&#x27;E&#x27;</span>, <span class="hljs-number">1765918884</span>: <span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-number">1478334949</span>: <span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-number">2129661504</span>: <span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-number">2049314381</span>: <span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-number">3313039427</span>: <span class="hljs-string">&#x27;J&#x27;</span>, <span class="hljs-number">395607123</span>: <span class="hljs-string">&#x27;K&#x27;</span>, <span class="hljs-number">7892080</span>: <span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-number">2618945779</span>: <span class="hljs-string">&#x27;M&#x27;</span>, <span class="hljs-number">494492361</span>: <span class="hljs-string">&#x27;N&#x27;</span>, <span class="hljs-number">2668773965</span>: <span class="hljs-string">&#x27;O&#x27;</span>, <span class="hljs-number">2869042696</span>: <br><span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-number">125487888</span>: <span class="hljs-string">&#x27;Q&#x27;</span>, <span class="hljs-number">3520132750</span>: <span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-number">2192374122</span>: <span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-number">2674318596</span>: <span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-number">2329524983</span>: <span class="hljs-string">&#x27;U&#x27;</span>, <span class="hljs-number">2867255497</span>: <span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-number">242469615</span>: <span class="hljs-string">&#x27;W&#x27;</span>, <span class="hljs-number">3217631379</span>: <span class="hljs-string">&#x27;X&#x27;</span>, <span class="hljs-number">3577220178</span>: <span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-number">2168798531</span>: <span class="hljs-string">&#x27;Z&#x27;</span>, <span class="hljs-number">2496854787</span>: <span class="hljs-string">&#x27;!&#x27;</span>, <span class="hljs-number">397040929</span>: <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-number">899313524</span>: <span class="hljs-string">&#x27;$&#x27;</span>, <span class="hljs-number">3824953634</span>: <span class="hljs-string">&#x27;%&#x27;</span>, <span class="hljs-number">2972521457</span>: <span class="hljs-string">&#x27;&amp;&#x27;</span>, <span class="hljs-number">3824228505</span>: <span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-number">2345090752</span>: <span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-number">4189409870</span>: <span class="hljs-string">&#x27;&lt;&#x27;</span>, <span class="hljs-number">1013325276</span>: <span class="hljs-string">&#x27;=&#x27;</span>, <span class="hljs-number">2760469029</span>: <span class="hljs-string">&#x27;&gt;&#x27;</span>, <span class="hljs-number">3940314081</span>: <span class="hljs-string">&#x27;?&#x27;</span>, <span class="hljs-number">3322254233</span>: <span class="hljs-string">&#x27;@&#x27;</span>, <span class="hljs-number">1093094099</span>: <span class="hljs-string">&#x27;[&#x27;</span>, <span class="hljs-number">3434213868</span>: <span class="hljs-string">&#x27;\\&#x27;</span>, <span class="hljs-number">1904142958</span>: <span class="hljs-string">&#x27;]&#x27;</span>, <span class="hljs-number">228352509</span>: <span class="hljs-string">&#x27;^&#x27;</span>, <span class="hljs-number">4220491175</span>: <span class="hljs-string">&#x27;_&#x27;</span>, <span class="hljs-number">1807588790</span>: <span class="hljs-string">&#x27;&#123;&#x27;</span>, <span class="hljs-number">3214927140</span>: <span class="hljs-string">&#x27;|&#x27;</span>, <span class="hljs-number">3817631495</span>: <span class="hljs-string">&#x27;&#125;&#x27;</span>, <span class="hljs-number">2087780498</span>: <span class="hljs-string">&#x27;~&#x27;</span>&#125;<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>      <span class="hljs-built_in">print</span>(dictionary[enc[i]],end = <span class="hljs-string">&#x27;&#x27;</span>)<br><br><br></code></pre></td></tr></table></figure>

<h3 id="6-23"><a href="#6-23" class="headerlink" title="6.23"></a>6.23</h3><h4 id="HUBUCTF-2022-新生赛-Anger？Angr"><a href="#HUBUCTF-2022-新生赛-Anger？Angr" class="headerlink" title="[HUBUCTF 2022 新生赛]Anger？Angr"></a>[HUBUCTF 2022 新生赛]Anger？Angr</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><br>a1 =  [BitVec(<span class="hljs-string">&#x27;a1%s&#x27;</span> % i,<span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>) ]<br><span class="hljs-built_in">print</span>(a1)<br>s=Solver()<br>s.add(BV2Int(a1[<span class="hljs-number">10</span>]) &lt;= <span class="hljs-number">40</span> , <span class="hljs-number">24</span> * BV2Int(a1[<span class="hljs-number">30</span>]) % <span class="hljs-number">84</span> == <span class="hljs-number">12</span> , BV2Int(a1[<span class="hljs-number">16</span>]) != <span class="hljs-number">66</span>)<br>s.add(BV2Int(a1[<span class="hljs-number">4</span>]) &gt; <span class="hljs-number">51</span> , BV2Int(a1[<span class="hljs-number">15</span>]) &gt; <span class="hljs-number">90</span> , BV2Int(a1[<span class="hljs-number">18</span>]) != <span class="hljs-number">38</span>)<br><br>s.add(BV2Int(a1[<span class="hljs-number">3</span>]) &lt;= <span class="hljs-number">107</span> , <span class="hljs-number">61</span> * BV2Int(a1[<span class="hljs-number">20</span>]) % <span class="hljs-number">95</span> == <span class="hljs-number">2</span> , BV2Int(a1[<span class="hljs-number">27</span>]) != <span class="hljs-number">67</span>)<br>s.add(BV2Int(a1[<span class="hljs-number">29</span>]) &lt;= <span class="hljs-number">69</span> , <span class="hljs-number">39</span> * BV2Int(a1[<span class="hljs-number">18</span>]) % <span class="hljs-number">57</span> == <span class="hljs-number">27</span> , BV2Int(a1[<span class="hljs-number">29</span>]) &lt;= <span class="hljs-number">90</span>)<br>s.add(a1[<span class="hljs-number">21</span>] &gt; <span class="hljs-number">42</span> , a1[<span class="hljs-number">0</span>] &gt; <span class="hljs-number">35</span> , a1[<span class="hljs-number">7</span>] != <span class="hljs-number">74</span>)<br>s.add(a1[<span class="hljs-number">19</span>] &lt;= <span class="hljs-number">79</span> , a1[<span class="hljs-number">15</span>] &gt; <span class="hljs-number">74</span> , a1[<span class="hljs-number">22</span>] &gt; <span class="hljs-number">92</span>)<br>s.add(a1[<span class="hljs-number">14</span>]&lt;=<span class="hljs-number">89</span>,a1[<span class="hljs-number">24</span>]!=<span class="hljs-number">95</span>)<br>s.add( a1[<span class="hljs-number">26</span>] &gt; <span class="hljs-number">36</span>)<br>s.add(a1[<span class="hljs-number">22</span>]&gt;<span class="hljs-number">53</span>,BV2Int(a1[<span class="hljs-number">12</span>])!=<span class="hljs-number">33</span>)<br>s.add( (<span class="hljs-number">29</span> * BV2Int(a1[<span class="hljs-number">6</span>])) % <span class="hljs-number">33</span> == <span class="hljs-number">24</span>)<br>s.add( <span class="hljs-number">41</span> * BV2Int(a1[<span class="hljs-number">26</span>]) % <span class="hljs-number">31</span> == <span class="hljs-number">27</span>)<br>s.add(BV2Int(a1[<span class="hljs-number">16</span>]) != <span class="hljs-number">71</span>  )<br>s.add( <span class="hljs-number">22</span> * BV2Int(a1[<span class="hljs-number">24</span>]) % <span class="hljs-number">96</span> == <span class="hljs-number">60</span>)<br>s.add(a1[<span class="hljs-number">25</span>] != <span class="hljs-number">102</span>  , a1[<span class="hljs-number">18</span>] != <span class="hljs-number">95</span>)<br>s.add( <span class="hljs-number">38</span> * BV2Int(a1[<span class="hljs-number">6</span>]) % <span class="hljs-number">54</span> == <span class="hljs-number">36</span>)<br>s.add(a1[<span class="hljs-number">4</span>]&gt;<span class="hljs-number">52</span>)<br>s.add(a1[<span class="hljs-number">11</span>]&lt;=<span class="hljs-number">76</span>)<br>s.add( <span class="hljs-number">72</span> * BV2Int(a1[<span class="hljs-number">6</span>]) % <span class="hljs-number">86</span> == <span class="hljs-number">42</span> )<br>s.add(a1[<span class="hljs-number">5</span>] &lt;= <span class="hljs-number">109</span> , a1[<span class="hljs-number">9</span>] &gt; <span class="hljs-number">44</span> , a1[<span class="hljs-number">8</span>] &gt; <span class="hljs-number">77</span>)<br>s.add(a1[<span class="hljs-number">28</span>] != <span class="hljs-number">107</span>  , a1[<span class="hljs-number">17</span>] &gt; <span class="hljs-number">73</span>)<br>s.add( <span class="hljs-number">69</span> * BV2Int(a1[<span class="hljs-number">5</span>]) % <span class="hljs-number">3</span>==<span class="hljs-number">0</span>)<br>s.add(a1[<span class="hljs-number">0</span>] != <span class="hljs-number">70</span> , a1[<span class="hljs-number">13</span>] &gt; <span class="hljs-number">72</span> , a1[<span class="hljs-number">1</span>] &lt;= <span class="hljs-number">108</span>)<br>s.add(a1[<span class="hljs-number">14</span>]!=<span class="hljs-number">97</span>)<br>s.add(a1[<span class="hljs-number">1</span>]&lt;=<span class="hljs-number">90</span>)<br>s.add( <span class="hljs-number">87</span> * BV2Int(a1[<span class="hljs-number">31</span>]) % <span class="hljs-number">69</span> == <span class="hljs-number">45</span>)<br>s.add(a1[<span class="hljs-number">11</span>] &lt;= <span class="hljs-number">99</span> , a1[<span class="hljs-number">24</span>] != <span class="hljs-number">107</span> , a1[<span class="hljs-number">26</span>] &lt;= <span class="hljs-number">111</span>)<br>s.add(a1[<span class="hljs-number">0</span>] &gt; <span class="hljs-number">36</span> , a1[<span class="hljs-number">3</span>] &lt;= <span class="hljs-number">65</span> , a1[<span class="hljs-number">2</span>] &gt; <span class="hljs-number">41</span>)<br>s.add(a1[<span class="hljs-number">23</span>] != <span class="hljs-number">84</span> , a1[<span class="hljs-number">16</span>] != <span class="hljs-number">101</span> , a1[<span class="hljs-number">13</span>] &lt;= <span class="hljs-number">99</span>)<br>s.add(a1[<span class="hljs-number">19</span>] &gt; <span class="hljs-number">33</span> , a1[<span class="hljs-number">25</span>] &lt;= <span class="hljs-number">122</span> , a1[<span class="hljs-number">28</span>] != <span class="hljs-number">67</span>)<br>s.add(<span class="hljs-number">86</span> * BV2Int(a1[<span class="hljs-number">17</span>]) % <span class="hljs-number">74</span> == <span class="hljs-number">64</span> , BV2Int(a1[<span class="hljs-number">10</span>]) != <span class="hljs-number">87</span> , BV2Int(a1[<span class="hljs-number">30</span>]) &lt;= <span class="hljs-number">108</span>)<br>s.add(BV2Int(a1[<span class="hljs-number">8</span>])!=<span class="hljs-number">87</span>)<br>s.add(<span class="hljs-number">46</span> * BV2Int(a1[<span class="hljs-number">12</span>]) % <span class="hljs-number">26</span> == <span class="hljs-number">20</span> , <span class="hljs-number">50</span> * BV2Int(a1[<span class="hljs-number">9</span>]) % <span class="hljs-number">52</span> == <span class="hljs-number">22</span>)<br>s.add(BV2Int(a1[<span class="hljs-number">8</span>]) &gt; <span class="hljs-number">47</span> ,BV2Int(a1[<span class="hljs-number">21</span>]) &lt;= <span class="hljs-number">100</span> , BV2Int(a1[<span class="hljs-number">11</span>]) &gt; <span class="hljs-number">34</span>)<br>s.add(BV2Int(a1[<span class="hljs-number">27</span>]) != <span class="hljs-number">127</span> , BV2Int(a1[<span class="hljs-number">21</span>]) &gt; <span class="hljs-number">42</span> )<br>s.add( <span class="hljs-number">5</span> * BV2Int(a1[<span class="hljs-number">10</span>]) % <span class="hljs-number">32</span> == <span class="hljs-number">20</span>)<br>s.add( BV2Int(a1[<span class="hljs-number">12</span>]) &lt;= <span class="hljs-number">107</span>)<br>s.add(BV2Int(a1[<span class="hljs-number">19</span>]) != <span class="hljs-number">91</span>  , BV2Int(a1[<span class="hljs-number">29</span>]) != <span class="hljs-number">124</span>)<br>s.add( <span class="hljs-number">57</span> * BV2Int(a1[<span class="hljs-number">13</span>]) % <span class="hljs-number">13</span> == <span class="hljs-number">2</span> , BV2Int(a1[<span class="hljs-number">27</span>]) &lt;= <span class="hljs-number">100</span> , <span class="hljs-number">61</span> * BV2Int(a1[<span class="hljs-number">22</span>]) % <span class="hljs-number">67</span> == <span class="hljs-number">66</span>)<br>s.add(BV2Int(a1[<span class="hljs-number">7</span>]) &lt;= <span class="hljs-number">118</span> , BV2Int(a1[<span class="hljs-number">1</span>]) != <span class="hljs-number">64</span> , BV2Int(a1[<span class="hljs-number">30</span>]) &gt; <span class="hljs-number">44</span>)<br>s.add(BV2Int(a1[<span class="hljs-number">5</span>]) != <span class="hljs-number">43</span> , BV2Int(a1[<span class="hljs-number">31</span>]) != <span class="hljs-number">88</span> , BV2Int(a1[<span class="hljs-number">31</span>]) &gt; <span class="hljs-number">35</span>)<br>s.add(BV2Int(a1[<span class="hljs-number">20</span>]) &lt;= <span class="hljs-number">101</span> , BV2Int(a1[<span class="hljs-number">15</span>]) &gt; <span class="hljs-number">64</span> , BV2Int(a1[<span class="hljs-number">4</span>]) != <span class="hljs-number">43</span>)<br><br>s.add(BV2Int(a1[<span class="hljs-number">17</span>])&gt;<span class="hljs-number">56</span>)<br>s.add(BV2Int(a1[<span class="hljs-number">28</span>])&lt;=<span class="hljs-number">115</span>)<br>s.add( (BV2Int(a1[<span class="hljs-number">25</span>]) *<span class="hljs-number">64</span>) % <span class="hljs-number">21</span> == <span class="hljs-number">4</span> )<br>s.add(BV2Int(a1[<span class="hljs-number">20</span>]) != <span class="hljs-number">43</span> , BV2Int(a1[<span class="hljs-number">2</span>]) &lt;= <span class="hljs-number">82</span> , BV2Int(a1[<span class="hljs-number">2</span>]) &gt; <span class="hljs-number">39</span>)<br>s.add(BV2Int(a1[<span class="hljs-number">23</span>]) &gt; <span class="hljs-number">34</span> , BV2Int(a1[<span class="hljs-number">7</span>]) &gt; <span class="hljs-number">52</span> , BV2Int(a1[<span class="hljs-number">14</span>]) &gt; <span class="hljs-number">44</span>)<br>s.add(BV2Int(a1[<span class="hljs-number">3</span>]) &lt;= <span class="hljs-number">83</span> , <span class="hljs-number">59</span> * BV2Int(a1[<span class="hljs-number">9</span>]) % <span class="hljs-number">86</span> == <span class="hljs-number">69</span> , BV2Int(a1[<span class="hljs-number">23</span>]) &lt;= <span class="hljs-number">103</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">32</span>):<br>    s.add(BV2Int(a1[i])&lt;<span class="hljs-number">127</span>)<br>    s.add(BV2Int(a1[i])&gt;<span class="hljs-number">30</span>)<br>s.check()<br>m=s.model()<br><span class="hljs-built_in">print</span>(m)<br>res=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">32</span>):<br>    res+=(<span class="hljs-built_in">chr</span>(m[a1[i]].as_long()))<br><span class="hljs-built_in">print</span>(res)<br></code></pre></td></tr></table></figure>

<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2023/05/04/HDCTF/">← Next HDCTF  逆向wp</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2023/04/17/goductf/">goductf  逆向wp Prev →</a></div></div></div><div id="Valine"></div></div><div id="bottom-btn"><a id="to-index" href="#toc-div" title="INDEX">≡</a><a id="to-top" onClick="scrolls.scrolltop();" title="to top" style="opacity: 0; display: none;">∧</a></div></article><aside><div id="aside-top"><div id="about"><a href="/" id="logo"><img src="https://raw.githubusercontent.com/shimmer123456/img/main/img/touxiang.png" alt="Logo"></a><h1 id="Dr"><a href="/">shimmer</a></h1><div id="description"><p>一</p><p>些</p><p>小</p><p>笔</p><p>记</p><p>或</p><p>是</p><p>小</p><p>感</p><p>悟</p></div></div><div id="aside-block"><div id="toc-div"><h1>INDEX</h1><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3"><span class="toc-number">1.</span> <span class="toc-text">5.3</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#xctf%EF%BC%9A%E6%B5%81%E6%B5%AA%E8%80%85"><span class="toc-number">1.1.</span> <span class="toc-text">xctf：流浪者</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#re2-cpp-is-awesome"><span class="toc-number">1.2.</span> <span class="toc-text">re2-cpp-is-awesome</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4"><span class="toc-number">2.</span> <span class="toc-text">5.4</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#whats-the-hell-500"><span class="toc-number">2.1.</span> <span class="toc-text">whats-the-hell-500</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#easyRE"><span class="toc-number">2.2.</span> <span class="toc-text">easyRE</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5"><span class="toc-number">3.</span> <span class="toc-text">5.5</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CISCN-2022-%E4%B8%9C%E5%8C%97-easycpp"><span class="toc-number">3.1.</span> <span class="toc-text">[CISCN 2022 东北]easycpp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AnCTFxD-3CTF%EF%BC%9Ad3sky"><span class="toc-number">3.2.</span> <span class="toc-text">AnCTFxD^3CTF：d3sky</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6"><span class="toc-number">4.</span> <span class="toc-text">5.6</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Reverse"><span class="toc-number">4.1.</span> <span class="toc-text">Reverse</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bad-python"><span class="toc-number">4.2.</span> <span class="toc-text">bad_python</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-7"><span class="toc-number">5.</span> <span class="toc-text">5.7</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#TEA"><span class="toc-number">5.1.</span> <span class="toc-text">TEA</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#xxxorrr"><span class="toc-number">5.2.</span> <span class="toc-text">xxxorrr</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-8"><span class="toc-number">6.</span> <span class="toc-text">5.8</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ISCC-Convert"><span class="toc-number">6.1.</span> <span class="toc-text">ISCC  Convert</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#testre"><span class="toc-number">6.2.</span> <span class="toc-text">testre</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-9"><span class="toc-number">7.</span> <span class="toc-text">5.9</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ISCC-Pull-the-Wool-Over-People%E2%80%99s-Eyes"><span class="toc-number">7.1.</span> <span class="toc-text">ISCC  Pull the Wool Over People’s Eyes</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CISCN-2022-%E4%B8%9C%E5%8C%97-hana"><span class="toc-number">7.2.</span> <span class="toc-text">[CISCN 2022 东北]hana</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-10"><span class="toc-number">8.</span> <span class="toc-text">5.10</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#HNCTF-2022-WEEK2-e-sy-flower"><span class="toc-number">8.1.</span> <span class="toc-text">[HNCTF 2022 WEEK2]e@sy_flower</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#luck-guy"><span class="toc-number">8.2.</span> <span class="toc-text">luck_guy</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-11"><span class="toc-number">9.</span> <span class="toc-text">5.11</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#hackme"><span class="toc-number">9.1.</span> <span class="toc-text">hackme</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SignIn"><span class="toc-number">9.2.</span> <span class="toc-text">SignIn</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-12"><span class="toc-number">10.</span> <span class="toc-text">5.12</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%BA%E7%BD%91%E6%9D%AF-2022-GameMaster"><span class="toc-number">10.1.</span> <span class="toc-text">[强网杯 2022]GameMaster</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#xctf-babymips"><span class="toc-number">10.2.</span> <span class="toc-text">xctf babymips</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-13"><span class="toc-number">11.</span> <span class="toc-text">5.13</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#litctf-%E9%80%86%E5%90%91wp-shimmer%E2%80%99s-blog-shimmer123456-github-io"><span class="toc-number">11.1.</span> <span class="toc-text">litctf 逆向wp | shimmer’s blog (shimmer123456.github.io)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-14"><span class="toc-number">12.</span> <span class="toc-text">5.14</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%A5%E7%A7%8B%E6%9D%AF-Poisoned-tea-CHELL%EF%BC%88%E5%A3%B3%E6%98%AF%E7%9C%9F%E9%9A%BE%E8%84%B1%E5%95%8A%EF%BC%8C%E8%BF%98%E5%A5%BD%E6%88%91%E8%84%B1%E6%8E%89%E4%BA%86%EF%BC%89"><span class="toc-number">12.1.</span> <span class="toc-text">春秋杯 Poisoned_tea_CHELL（壳是真难脱啊，还好我脱掉了）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%A5%E7%A7%8B%E6%9D%AF-sum"><span class="toc-number">12.2.</span> <span class="toc-text">春秋杯 sum</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-15"><span class="toc-number">13.</span> <span class="toc-text">5.15</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-fakebase"><span class="toc-number">13.1.</span> <span class="toc-text">[SWPUCTF 2021 新生赛]fakebase</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-fakerandom"><span class="toc-number">13.2.</span> <span class="toc-text">[SWPUCTF 2021 新生赛]fakerandom</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-16"><span class="toc-number">14.</span> <span class="toc-text">5.16</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#HGAME-2022-week1-easyasm"><span class="toc-number">14.1.</span> <span class="toc-text">[HGAME 2022 week1]easyasm</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WUSTCTF-2020-level3"><span class="toc-number">14.2.</span> <span class="toc-text">[WUSTCTF 2020]level3</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-17"><span class="toc-number">15.</span> <span class="toc-text">5.17</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#BJDCTF-2020-Easy-AmtuOrRF"><span class="toc-number">15.1.</span> <span class="toc-text">[BJDCTF 2020]Easy AmtuOrRF</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HNCTF-2022-Week1-X0r"><span class="toc-number">15.2.</span> <span class="toc-text">[HNCTF 2022 Week1]X0r</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-19"><span class="toc-number">16.</span> <span class="toc-text">5.19</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2023%E6%98%A5%E7%A7%8B%E6%9D%AF-sum"><span class="toc-number">16.1.</span> <span class="toc-text">[2023春秋杯  sum]</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#GDOUCTF-2023-doublegame"><span class="toc-number">16.2.</span> <span class="toc-text">[GDOUCTF 2023]doublegame</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-20"><span class="toc-number">17.</span> <span class="toc-text">5.20</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#LitCTF-2023-enbase64"><span class="toc-number">17.1.</span> <span class="toc-text">[LitCTF 2023]enbase64</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-21"><span class="toc-number">18.</span> <span class="toc-text">5.21</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#GXYCTF-2019-luck-guy"><span class="toc-number">18.1.</span> <span class="toc-text">[GXYCTF 2019]luck_guy</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-22"><span class="toc-number">19.</span> <span class="toc-text">5.22</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#NISACTF-2022-ezpython"><span class="toc-number">19.1.</span> <span class="toc-text">[NISACTF 2022]ezpython</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-23"><span class="toc-number">20.</span> <span class="toc-text">5.23</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#HNCTF-2022-WEEK2-%E6%9D%A5%E8%A7%A3%E4%B8%AA%E6%96%B9%E7%A8%8B"><span class="toc-number">20.1.</span> <span class="toc-text">[HNCTF 2022 WEEK2]来解个方程?</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-24"><span class="toc-number">21.</span> <span class="toc-text">5.24</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#GDOUCTF-2023-L%EF%BC%81s%EF%BC%81"><span class="toc-number">21.1.</span> <span class="toc-text">[GDOUCTF 2023]L！s！</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-26"><span class="toc-number">22.</span> <span class="toc-text">5.26</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EasyDotnet"><span class="toc-number">22.1.</span> <span class="toc-text">EasyDotnet</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-27-5-28"><span class="toc-number">23.</span> <span class="toc-text">5.27  5.28</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-29"><span class="toc-number">24.</span> <span class="toc-text">5.29</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ciscn-2023-babyRE"><span class="toc-number">24.1.</span> <span class="toc-text">ciscn 2023 babyRE</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-30"><span class="toc-number">25.</span> <span class="toc-text">5.30</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%A5%E7%A7%8B%E6%9D%AF-re-wp-shimmer%E2%80%99s-blog-shimmer123456-github-io"><span class="toc-number">25.1.</span> <span class="toc-text">春秋杯 re wp | shimmer’s blog (shimmer123456.github.io)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-31"><span class="toc-number">26.</span> <span class="toc-text">5.31</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%A5%E7%A7%8B%E6%9D%AF-re-wp-shimmer%E2%80%99s-blog-shimmer123456-github-io-1"><span class="toc-number">26.1.</span> <span class="toc-text">春秋杯 re wp | shimmer’s blog (shimmer123456.github.io)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1"><span class="toc-number">27.</span> <span class="toc-text">6.1</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ciscn-%E9%80%86%E5%90%91wp-shimmer%E2%80%99s-blog-shimmer123456-github-io"><span class="toc-number">27.1.</span> <span class="toc-text">ciscn 逆向wp | shimmer’s blog (shimmer123456.github.io)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2"><span class="toc-number">28.</span> <span class="toc-text">6.2</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ciscn-%E9%80%86%E5%90%91wp-shimmer%E2%80%99s-blog-shimmer123456-github-io-1"><span class="toc-number">28.1.</span> <span class="toc-text">ciscn 逆向wp | shimmer’s blog (shimmer123456.github.io)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3"><span class="toc-number">29.</span> <span class="toc-text">6.3</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MoeCTF-2022-chicken-soup"><span class="toc-number">29.1.</span> <span class="toc-text">[MoeCTF 2022]chicken_soup</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4"><span class="toc-number">30.</span> <span class="toc-text">6.4</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#hsctf-dasctf"><span class="toc-number">30.1.</span> <span class="toc-text">hsctf dasctf</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5"><span class="toc-number">31.</span> <span class="toc-text">6.5</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%99%95%E8%A5%BF%E7%9C%81%E8%B5%9B-%E9%80%86%E5%90%91wp-shimmer%E2%80%99s-blog-shimmer123456-github-io"><span class="toc-number">31.1.</span> <span class="toc-text">陕西省赛 逆向wp | shimmer’s blog (shimmer123456.github.io)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-6"><span class="toc-number">32.</span> <span class="toc-text">6.6</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%99%95%E8%A5%BF%E7%9C%81%E8%B5%9B-%E9%80%86%E5%90%91wp-shimmer%E2%80%99s-blog-shimmer123456-github-io-1"><span class="toc-number">32.1.</span> <span class="toc-text">陕西省赛 逆向wp | shimmer’s blog (shimmer123456.github.io)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-7"><span class="toc-number">33.</span> <span class="toc-text">6.7</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-PYRE"><span class="toc-number">33.1.</span> <span class="toc-text">[SWPUCTF 2021 新生赛]PYRE</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-8"><span class="toc-number">34.</span> <span class="toc-text">6.8</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MoeCTF-2021-Realezpy"><span class="toc-number">34.1.</span> <span class="toc-text">[MoeCTF 2021]Realezpy</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-9"><span class="toc-number">35.</span> <span class="toc-text">6.9</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MTCTF-2021-wow"><span class="toc-number">35.1.</span> <span class="toc-text">[MTCTF 2021]wow</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-10"><span class="toc-number">36.</span> <span class="toc-text">6.10</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#WUSTCTF-2020-level4"><span class="toc-number">36.1.</span> <span class="toc-text">[WUSTCTF 2020]level4</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-11"><span class="toc-number">37.</span> <span class="toc-text">6.11</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%95%BF%E5%9F%8E%E6%9D%AF-2021-%E9%99%A2%E6%A0%A1%E7%BB%84-Just-cmp-re"><span class="toc-number">37.1.</span> <span class="toc-text">[长城杯 2021 院校组]Just_cmp-re</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-12"><span class="toc-number">38.</span> <span class="toc-text">6.12</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MoeCTF-2022-ezTea"><span class="toc-number">38.1.</span> <span class="toc-text">[MoeCTF 2022]ezTea</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-13"><span class="toc-number">39.</span> <span class="toc-text">6.13</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MoeCTF-2021-%E5%A4%A7%E4%BD%AC%E8%AF%B7%E5%96%9Dcoffee"><span class="toc-number">39.1.</span> <span class="toc-text">[MoeCTF 2021]大佬请喝coffee</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-15"><span class="toc-number">40.</span> <span class="toc-text">6.15</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MoeCTF-2022-D-flat"><span class="toc-number">40.1.</span> <span class="toc-text">[MoeCTF 2022]D_flat</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-16"><span class="toc-number">41.</span> <span class="toc-text">6.16</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MoeCTF-2022-fake-key"><span class="toc-number">41.1.</span> <span class="toc-text">[MoeCTF 2022]fake_key</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-17"><span class="toc-number">42.</span> <span class="toc-text">6.17</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#SDCTF-2022-A-Bowl-of-Pythons"><span class="toc-number">42.1.</span> <span class="toc-text">[SDCTF 2022]A Bowl of Pythons</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-18"><span class="toc-number">43.</span> <span class="toc-text">6.18</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MoeCTF-2022-Art"><span class="toc-number">43.1.</span> <span class="toc-text">[MoeCTF 2022]Art</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-19"><span class="toc-number">44.</span> <span class="toc-text">6.19</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%95%BF%E5%9F%8E%E6%9D%AF-2022-%E9%AB%98%E6%A0%A1%E7%BB%84-baby-re"><span class="toc-number">44.1.</span> <span class="toc-text">[长城杯 2022 高校组]baby_re</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-20"><span class="toc-number">45.</span> <span class="toc-text">6.20</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MoeCTF-2021-midpython"><span class="toc-number">45.1.</span> <span class="toc-text">[MoeCTF 2021]midpython</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-21"><span class="toc-number">46.</span> <span class="toc-text">6.21</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MoeCTF-2021-EinfachRe"><span class="toc-number">46.1.</span> <span class="toc-text">[MoeCTF 2021]EinfachRe</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-22"><span class="toc-number">47.</span> <span class="toc-text">6.22</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MoeCTF-2022-Broken-hash"><span class="toc-number">47.1.</span> <span class="toc-text">[MoeCTF 2022]Broken_hash</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-23"><span class="toc-number">48.</span> <span class="toc-text">6.23</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#HUBUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-Anger%EF%BC%9FAngr"><span class="toc-number">48.1.</span> <span class="toc-text">[HUBUCTF 2022 新生赛]Anger？Angr</span></a></li></ol></li></ol></div></div></div><footer><nobr>published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknight</a></nobr><wbr><nobr>by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script class="pjax-js">reset=_=>{new Valine({
 el: '#Valine'
 , appId: 'fvW1eWgLvTdXfECCW1Bu9g6J-gzGzoHsz'
 , appKey: 'stD8FmxHNFFxhkzXholoBHdq' , placeholder: '此条评论委托企鹅物流发送'
});code.findCode();mermaid.init(undefined, ('.mermaid'));}</script><script src="/js/arknights.js"></script><script>window.addEventListener("load",()=>{reset()})</script></body></html>