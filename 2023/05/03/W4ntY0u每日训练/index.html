<!DOCTYPE html><html lang="zh"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>W4ntY0u每日训练 | shimmer's blog</title><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"键入以继续","blurHolder":"数据检索","noResult":"无 $0 相关数据"},"code":{"codeInfo":"$0 共 $1 行","copy":"复制","copyFinish":"完成","expand":"展开"}}</script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><script>mermaid.initialize({
 startOnLoad: true
 , theme: 'dark'
});</script><link rel="stylesheet" href="/css/arknights.css"><link rel="stylesheet" href="//unpkg.com/@highlightjs/cdn-assets@11.6.0/styles/atom-one-dark-reasonable.min.css"><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><meta name="generator" content="Hexo 6.3.0"></head><body style="background-image:url(https://pica.zhimg.com/80/v2-521231b4ebe13d5fbfff75e801045ff2_1440w.webp?source=1940ef5c);"><main><header class="closed"><nav><div class="navBtn hide"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><ol class="navContent"><li class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="数据检索" spellcheck="false" maxlength="50" type="text" id="search-input"></span></li><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li></ol></nav><div class="search-popup"><div id="search-result"></div></div></header><article><div id="post-bg"><div id="post-title"><h1>W4ntY0u每日训练</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2023-05-03T00:03:12.000Z" id="date"> 2023-05-03</time></div></span><br><span>Last Update: <div class="control"><time datetime="2023-05-05T11:51:19.380Z" id="updated"> 2023-05-05</time></div></span></div></div><hr><div id="post-content"><h3 id="5-3"><a href="#5-3" class="headerlink" title="5.3"></a>5.3</h3><h4 id="xctf：流浪者"><a href="#xctf：流浪者" class="headerlink" title="xctf：流浪者"></a>xctf：流浪者</h4><p>一道mfc的逆向，ida打开，利用字符串定位关键函数</p>
<p><img src="https://raw.githubusercontent.com/shimmer123456/img/main/img/202305032022463.png" alt="image-20230503202224316"></p>
<p>定位到sub_4017F0函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">sub_4017F0</span><span class="hljs-params">(<span class="hljs-type">int</span> a1)</span><br>&#123;<br>  <span class="hljs-type">char</span> Str1[<span class="hljs-number">28</span>]; <span class="hljs-comment">// [esp+D8h] [ebp-24h] BYREF</span><br>  <span class="hljs-type">int</span> v3; <span class="hljs-comment">// [esp+F4h] [ebp-8h]</span><br>  <span class="hljs-type">int</span> v4; <span class="hljs-comment">// [esp+F8h] [ebp-4h]</span><br><br>  v4 = <span class="hljs-number">0</span>;<br>  v3 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">while</span> ( *(a1 + <span class="hljs-number">4</span> * v4) &lt;= <span class="hljs-number">0x3D</span>u )<br>  &#123;<br>    Str1[v4] = aAbcdefghiabcde[*(a1 + <span class="hljs-number">4</span> * v4)];<br>    ++v4;<br>  &#125;<br>  Str1[v4] = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">strcmp</span>(Str1, <span class="hljs-string">&quot;KanXueCTF2019JustForhappy&quot;</span>) )<br>    <span class="hljs-keyword">return</span> sub_401770();<br>  <span class="hljs-keyword">else</span><br>    <span class="hljs-keyword">return</span> sub_4017B0();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>主要逻辑就是一个置换加密，再交叉引用查看谁调用了他</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __thiscall <span class="hljs-title function_">sub_401890</span><span class="hljs-params">(CWnd *this)</span><br>&#123;<br>  CWnd *DlgItem; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v2; <span class="hljs-comment">// eax</span><br>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">CString</span> *<span class="hljs-title">v4</span>;</span> <span class="hljs-comment">// [esp-4h] [ebp-C4h]</span><br>  <span class="hljs-type">int</span> v5[<span class="hljs-number">26</span>]; <span class="hljs-comment">// [esp+4Ch] [ebp-74h] BYREF</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [esp+B4h] [ebp-Ch]</span><br>  <span class="hljs-type">char</span> *Str; <span class="hljs-comment">// [esp+B8h] [ebp-8h]</span><br>  CWnd *v8; <span class="hljs-comment">// [esp+BCh] [ebp-4h]</span><br><br>  v8 = this;<br>  v4 = (this + <span class="hljs-number">100</span>);<br>  DlgItem = CWnd::GetDlgItem(this, <span class="hljs-number">1002</span>);<br>  CWnd::GetWindowTextA(DlgItem, v4);<br>  v2 = sub_401A30(v8 + <span class="hljs-number">100</span>);<br>  Str = CString::GetBuffer((v8 + <span class="hljs-number">100</span>), v2);<br>  <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">strlen</span>(Str) )<br>    <span class="hljs-keyword">return</span> CWnd::MessageBoxA(v8, &amp;byte_4035DC, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; Str[i]; ++i )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( Str[i] &gt; <span class="hljs-string">&#x27;9&#x27;</span> || Str[i] &lt; <span class="hljs-string">&#x27;0&#x27;</span> )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( Str[i] &gt; <span class="hljs-string">&#x27;z&#x27;</span> || Str[i] &lt; <span class="hljs-string">&#x27;a&#x27;</span> )<br>      &#123;<br>        <span class="hljs-keyword">if</span> ( Str[i] &gt; <span class="hljs-string">&#x27;Z&#x27;</span> || Str[i] &lt; <span class="hljs-string">&#x27;A&#x27;</span> )<br>          sub_4017B0();<br>        <span class="hljs-keyword">else</span><br>          v5[i] = Str[i] - <span class="hljs-string">&#x27;\x1D&#x27;</span>;<br>      &#125;<br>      <span class="hljs-keyword">else</span><br>      &#123;<br>        v5[i] = Str[i] - <span class="hljs-string">&#x27;W&#x27;</span>;<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      v5[i] = Str[i] - <span class="hljs-string">&#x27;0&#x27;</span>;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> sub_4017F0(v5);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>可以看到对输入的字符进行了三次判断，如果不在该判断范围内，直接错误</p>
<p>那么逆向脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python">KanXue = <span class="hljs-string">&quot;KanXueCTF2019JustForhappy&quot;</span><br>abcdef = <span class="hljs-string">&quot;abcdefghiABCDEFGHIJKLMNjklmn0123456789opqrstuvwxyzOPQRSTUVWXYZ&quot;</span><br>SomeDwordArray = []<br>Key = <span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(KanXue)):<br>    SomeDwordArray.append(abcdef.find(KanXue[i]))<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;SomeDwordArray =&quot;</span>, SomeDwordArray)<br><br><span class="hljs-keyword">for</span> dw <span class="hljs-keyword">in</span> SomeDwordArray:<br>    <span class="hljs-keyword">if</span> dw &lt;= <span class="hljs-number">9</span> <span class="hljs-keyword">and</span> dw &gt;= <span class="hljs-number">0</span>:<br>        Key += <span class="hljs-built_in">chr</span>(dw + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;0&#x27;</span>))<br>    <span class="hljs-keyword">elif</span> dw + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;W&#x27;</span>) &gt;= <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>) <span class="hljs-keyword">and</span> dw + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;W&#x27;</span>) &lt;= <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;z&#x27;</span>):<br>        Key += <span class="hljs-built_in">chr</span>(dw + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;W&#x27;</span>))<br>    <span class="hljs-keyword">else</span>:<br>        Key += <span class="hljs-built_in">chr</span>(dw + <span class="hljs-number">0x1D</span>)<br><br><span class="hljs-built_in">print</span>(Key)<br><span class="hljs-comment">#j0rXI4bTeustBiIGHeCF70DDM</span><br></code></pre></td></tr></table></figure>

<h4 id="re2-cpp-is-awesome"><a href="#re2-cpp-is-awesome" class="headerlink" title="re2-cpp-is-awesome"></a>re2-cpp-is-awesome</h4><p>main函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> a1, <span class="hljs-type">char</span> **a2, <span class="hljs-type">char</span> **a3)</span><br>&#123;<br>  <span class="hljs-type">char</span> *v3; <span class="hljs-comment">// rbx</span><br>  __int64 v4; <span class="hljs-comment">// rax</span><br>  __int64 v5; <span class="hljs-comment">// rdx</span><br>  __int64 v6; <span class="hljs-comment">// rax</span><br>  __int64 v7; <span class="hljs-comment">// rdx</span><br>  _BYTE *v8; <span class="hljs-comment">// rax</span><br>  __int64 v10[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+10h] [rbp-60h] BYREF</span><br>  <span class="hljs-type">char</span> v11[<span class="hljs-number">47</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-50h] BYREF</span><br>  <span class="hljs-type">char</span> v12; <span class="hljs-comment">// [rsp+4Fh] [rbp-21h] BYREF</span><br>  __int64 v13; <span class="hljs-comment">// [rsp+50h] [rbp-20h] BYREF</span><br>  <span class="hljs-type">int</span> v14; <span class="hljs-comment">// [rsp+5Ch] [rbp-14h]</span><br><br>  <span class="hljs-keyword">if</span> ( a1 != <span class="hljs-number">2</span> )<br>  &#123;<br>    v3 = *a2;<br>    v4 = <span class="hljs-built_in">std</span>::operator&lt;&lt;&lt;<span class="hljs-built_in">std</span>::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;(&amp;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span>, <span class="hljs-string">&quot;Usage: &quot;</span>, a3);<br>    v6 = <span class="hljs-built_in">std</span>::operator&lt;&lt;&lt;<span class="hljs-built_in">std</span>::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;(v4, v3, v5);<br>    <span class="hljs-built_in">std</span>::operator&lt;&lt;&lt;<span class="hljs-built_in">std</span>::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;(v6, <span class="hljs-string">&quot; flag\n&quot;</span>, v7);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>  &#125;<br>  <span class="hljs-built_in">std</span>::allocator&lt;<span class="hljs-type">char</span>&gt;::allocator(&amp;v12, a2, a3);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::basic_string(v11, a2[<span class="hljs-number">1</span>], &amp;v12);<br>  <span class="hljs-built_in">std</span>::allocator&lt;<span class="hljs-type">char</span>&gt;::~allocator(&amp;v12);<br>  v14 = <span class="hljs-number">0</span>;<br>  v10[<span class="hljs-number">0</span>] = <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::begin(v11);<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    v13 = <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::end(v11);<br>    <span class="hljs-keyword">if</span> ( !sub_400D3D(v10, &amp;v13) )<br>      <span class="hljs-keyword">break</span>;<br>    v8 = sub_400D9A(v10);<br>    <span class="hljs-keyword">if</span> ( *v8 != off_6020A0[dword_6020C0[v14]] )<br>      sub_400B56();<br>    ++v14;<br>    sub_400D7A(v10);<br>  &#125;<br>  sub_400B73();<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::~<span class="hljs-built_in">string</span>(v11);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>前面的逻辑还算不少，但是关键是最后的比较，直接用了明文，所以前面就都不用管了，直接逆向最后的比较</p>
<p>先idc爬数据：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-keyword">auto</span> addr = <span class="hljs-number">0x00006020C0</span>;<br><span class="hljs-keyword">auto</span> i = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span>(i; addr+i &lt; <span class="hljs-number">0x060213C</span>; i = i+<span class="hljs-number">4</span>)<br>&#123;<br>	<span class="hljs-built_in">Message</span>(<span class="hljs-string">&quot;%d,&quot;</span>,<span class="hljs-built_in">Byte</span>(addr+i));<br>	<span class="hljs-comment">//PatchByte(addr+i,Byte());</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>脚本：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-type">char</span> a[] = <span class="hljs-string">&quot;L3t_ME_T3ll_Y0u_S0m3th1ng_1mp0rtant_A_&#123;FL4G&#125;_W0nt_b3_3X4ctly_th4t_345y_t0_c4ptur3_H0wev3r_1T_w1ll_b3_C00l_1F_Y0u_g0t_1t&quot;</span>;<br>	<span class="hljs-type">int</span> b[] = &#123; <span class="hljs-number">36</span>,<span class="hljs-number">0</span>,<span class="hljs-number">5</span>,<span class="hljs-number">54</span>,<span class="hljs-number">101</span>,<span class="hljs-number">7</span>,<span class="hljs-number">39</span>,<span class="hljs-number">38</span>,<span class="hljs-number">45</span>,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">0</span>,<span class="hljs-number">13</span>,<span class="hljs-number">86</span>,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">101</span>,<span class="hljs-number">3</span>,<span class="hljs-number">45</span>,<span class="hljs-number">22</span>,<span class="hljs-number">2</span>,<span class="hljs-number">21</span>,<span class="hljs-number">3</span>,<span class="hljs-number">101</span>,<span class="hljs-number">0</span>,<span class="hljs-number">41</span>,<span class="hljs-number">68</span>,<span class="hljs-number">68</span>,<span class="hljs-number">1</span>,<span class="hljs-number">68</span>,<span class="hljs-number">43</span>, &#125;;<br>	<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">31</span>; ++i)<br>	&#123;<br>		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, a[b[i]]);<br>	&#125;<br>	<span class="hljs-keyword">return</span>  <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="5-4"><a href="#5-4" class="headerlink" title="5.4"></a>5.4</h3><h4 id="whats-the-hell-500"><a href="#whats-the-hell-500" class="headerlink" title="whats-the-hell-500"></a>whats-the-hell-500</h4><p>题目直接给了源码了，vs打开：（真抽象）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;somelib.hxx&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdlib&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">error</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;Wrong password&quot;</span> &lt;&lt; std::endl;<br>    std::<span class="hljs-built_in">exit</span>(<span class="hljs-number">-1</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">pow</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> n)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">ret</span><span class="hljs-params">(<span class="hljs-number">1</span>)</span></span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i)<br>        ret *= x;<br>    <span class="hljs-keyword">return</span> ret;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">check_password</span><span class="hljs-params">(std::string&amp; p)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (p.<span class="hljs-built_in">size</span>() != <span class="hljs-number">13</span>)<br>    &#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Password must be 13 characters&quot;</span> &lt;&lt; std::endl;<br>        std::<span class="hljs-built_in">exit</span>(<span class="hljs-number">-1</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">0</span>]+p[<span class="hljs-number">1</span>] != <span class="hljs-built_in">pow</span>(I-----I,<span class="hljs-number">2</span>) * <span class="hljs-built_in">pow</span>(I-----------I,<span class="hljs-number">2</span>) + (I---I)) <span class="hljs-built_in">error</span>();<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">1</span>]+p[<span class="hljs-number">2</span>] != <span class="hljs-built_in">pow</span>(I-------I,<span class="hljs-number">2</span>) * <span class="hljs-built_in">pow</span>(I-----I,<span class="hljs-number">4</span>) - (I---I)) <span class="hljs-built_in">error</span>();<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">0</span>]*p[<span class="hljs-number">2</span>] != (<span class="hljs-built_in">pow</span>(<span class="hljs-built_in">pow</span>(I-------I,<span class="hljs-number">2</span>) * <span class="hljs-built_in">pow</span>(I-----I,<span class="hljs-number">3</span>) - (I---I),<span class="hljs-number">2</span>) - (I-----I)*(I-------I))) <span class="hljs-built_in">error</span>();<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">3</span>]+p[<span class="hljs-number">5</span>] != <span class="hljs-built_in">pow</span>((o-------o<br>                          |       !<br>                          !       !<br>                          !       !<br>                          o-------o).A,<span class="hljs-number">2</span>) * (I-----I)+(I---I)) <span class="hljs-built_in">error</span>();<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">3</span>]+p[<span class="hljs-number">4</span>] != <span class="hljs-built_in">pow</span>((o-----------o<br>                          |           !<br>                          !           !<br>                          !           !<br>                          o-----------o).A,<span class="hljs-number">2</span>)+(I---I)) <span class="hljs-built_in">error</span>();<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">4</span>]*p[<span class="hljs-number">5</span>] != (<span class="hljs-built_in">pow</span>((o-------------o<br>                           |             !<br>                           !             !<br>                           !             !<br>                           o-------------o).A,<span class="hljs-number">2</span>)-(I---I))*(I-----I)*<span class="hljs-built_in">pow</span>(I-------I,<span class="hljs-number">2</span>)) <span class="hljs-built_in">error</span>();<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">7</span>]+p[<span class="hljs-number">8</span>] != (o-----------o<br>                      |L           \<br>                      | L           \<br>                      |  L           \<br>                      |   o-----------o|!<br>                      o   |           !<br>                       L  |           !<br>                        L |           !<br>                         L|           !<br>                          o-----------o).V*<span class="hljs-built_in">pow</span>(I-----I,<span class="hljs-number">2</span>) - <span class="hljs-built_in">pow</span>((o-------o<br>                                                                      |       !<br>                                                                      !       !<br>                                                                      o-------o).A,<span class="hljs-number">2</span>) + (I---I)) <span class="hljs-built_in">error</span>();<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">6</span>]+p[<span class="hljs-number">8</span>] != (o-----------o<br>                      |L           \<br>                      | L           \<br>                      |  L           \<br>                      |   L           \<br>                      |    L           \<br>                      |     o-----------o<br>                      |     !           !<br>                      o     |           !<br>                       L    |           !<br>                        L   |           !<br>                         L  |           !<br>                          L |           !<br>                           L|           !<br>                            o-----------o).V - (I-----I)) <span class="hljs-built_in">error</span>();<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">6</span>]*p[<span class="hljs-number">7</span>] != (o---------------------o<br>                      |L                     \<br>                      | L                     \<br>                      |  L                     \<br>                      |   L                     \<br>                      |    L                     \<br>                      |     L                     \<br>                      |      L                     \<br>                      |       L                     \<br>                      |        o---------------------o<br>                      |        !                     !<br>                      !        !                     !<br>                      o        |                     !<br>                       L       |                     !<br>                        L      |                     !<br>                         L     |                     !<br>                          L    |                     !<br>                           L   |                     !<br>                            L  |                     !<br>                             L |                     !<br>                              L|                     !<br>                               o---------------------o).V*(<span class="hljs-built_in">pow</span>(I-------I,<span class="hljs-number">2</span>) + (I-----I)) + <span class="hljs-built_in">pow</span>(I-----I,<span class="hljs-number">6</span>)) <span class="hljs-built_in">error</span>();<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">9</span>]+p[<span class="hljs-number">10</span>]*p[<span class="hljs-number">11</span>] != (o---------o<br>                             |L         \<br>                             | L         \<br>                             |  L         \<br>                             |   L         \<br>                             |    o---------o<br>                             |    !         !<br>                             !    !         !<br>                             o    |         !<br>                              L   |         !<br>                               L  |         !<br>                                L |         !<br>                                 L|         !<br>                                  o---------o).V*(I-------I)*<span class="hljs-built_in">pow</span>(I-----I,<span class="hljs-number">4</span>)-(I---I)) <span class="hljs-built_in">error</span>();<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">10</span>]+p[<span class="hljs-number">9</span>]*p[<span class="hljs-number">11</span>] != (o-----------o<br>                             |L           \<br>                             | L           \<br>                             |  L           \<br>                             |   L           \<br>                             |    L           \<br>                             |     o-----------o<br>                             |     !           !<br>                             o     |           !<br>                              L    |           !<br>                               L   |           !<br>                                L  |           !<br>                                 L |           !<br>                                  L|           !<br>                                   o-----------o).V*<span class="hljs-built_in">pow</span>(I-------I,<span class="hljs-number">3</span>) - (I-----------I)*((I-----I)*(I-----------I)+(I---I))) <span class="hljs-built_in">error</span>();<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">9</span>]+p[<span class="hljs-number">10</span>] != (o-------------o<br>                       |L             \<br>                       | L             \<br>                       |  L             \<br>                       |   L             \<br>                       |    L             \<br>                       |     o-------------o<br>                       |     !             !<br>                       o     |             !<br>                        L    |             !<br>                         L   |             !<br>                          L  |             !<br>                           L |             !<br>                            L|             !<br>                             o-------------o).V-(I-----------I)) <span class="hljs-built_in">error</span>();<br><br>    <span class="hljs-keyword">if</span> (p[<span class="hljs-number">12</span>] != <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-built_in">error</span>();<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;Guess passwd&quot;</span> &lt;&lt; std::endl;<br>    std::string password;<br>    std::cin &gt;&gt; password;<br>    <span class="hljs-built_in">check_password</span>(password);<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;Correct password! It&#x27;s your flag, bruh&quot;</span> &lt;&lt; std::endl;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>这个是调用了一个cxx的库，稍微google一下，可以大概了解到那一坨抽象的东西是等于一个数的，要么继续学怎么计算，这个时候gpt-4就挺好用的了（3.5是傻子），得到12个的结果，然后直接爆破：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#0-2</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x7f</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x7f</span>):<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x7f</span>):<br>                <span class="hljs-keyword">if</span> i+j == <span class="hljs-number">101</span> <span class="hljs-keyword">and</span> j+k==<span class="hljs-number">143</span> <span class="hljs-keyword">and</span> i*k==<span class="hljs-number">5035</span>:<br>                        flag += <span class="hljs-built_in">chr</span>(i)+<span class="hljs-built_in">chr</span>(j)+<span class="hljs-built_in">chr</span>(k)<br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[&#x27;</span>+<span class="hljs-built_in">chr</span>(i)+<span class="hljs-built_in">chr</span>(j)+<span class="hljs-built_in">chr</span>(k) + <span class="hljs-string">&#x27;]&#x27;</span>)<br><span class="hljs-comment">#50_     </span><br><span class="hljs-comment">#3-5</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x7f</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x7f</span>):<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x7f</span>):<br>                <span class="hljs-keyword">if</span> i+j == <span class="hljs-number">226</span> <span class="hljs-keyword">and</span> i+k==<span class="hljs-number">163</span> <span class="hljs-keyword">and</span> j*k==<span class="hljs-number">5814</span>:<br>                        flag += <span class="hljs-built_in">chr</span>(i)+<span class="hljs-built_in">chr</span>(j)+<span class="hljs-built_in">chr</span>(k)<br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[&#x27;</span>+<span class="hljs-built_in">chr</span>(i)+<span class="hljs-built_in">chr</span>(j)+<span class="hljs-built_in">chr</span>(k) + <span class="hljs-string">&#x27;]&#x27;</span>)<br><span class="hljs-comment">#pr3</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x7f</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x7f</span>):<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x7f</span>):<br>                <span class="hljs-keyword">if</span> j+k == <span class="hljs-number">205</span> <span class="hljs-keyword">and</span> i+k==<span class="hljs-number">173</span> <span class="hljs-keyword">and</span> i*j==<span class="hljs-number">9744</span>:<br>                        flag += <span class="hljs-built_in">chr</span>(i)+<span class="hljs-built_in">chr</span>(j)+<span class="hljs-built_in">chr</span>(k)<br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[&#x27;</span>+<span class="hljs-built_in">chr</span>(i)+<span class="hljs-built_in">chr</span>(j)+<span class="hljs-built_in">chr</span>(k) + <span class="hljs-string">&#x27;]&#x27;</span>)<br><span class="hljs-comment">#Tty</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x7f</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x7f</span>):<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x7f</span>):<br>                <span class="hljs-keyword">if</span> i+j*k == <span class="hljs-number">5375</span> <span class="hljs-keyword">and</span> j+i*k==<span class="hljs-number">4670</span> <span class="hljs-keyword">and</span> i+j==<span class="hljs-number">205</span>:<br>                        flag += <span class="hljs-built_in">chr</span>(i)+<span class="hljs-built_in">chr</span>(j)+<span class="hljs-built_in">chr</span>(k)<br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[&#x27;</span>+<span class="hljs-built_in">chr</span>(i)+<span class="hljs-built_in">chr</span>(j)+<span class="hljs-built_in">chr</span>(k) + <span class="hljs-string">&#x27;]&#x27;</span>)<br><span class="hljs-comment">#_n0</span><br>flag +=<span class="hljs-string">&#x27;w&#x27;</span><br><span class="hljs-built_in">print</span>(flag)<br><br><br></code></pre></td></tr></table></figure>

<h4 id="easyRE"><a href="#easyRE" class="headerlink" title="easyRE"></a>easyRE</h4><p>main函数：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function">__int64 <span class="hljs-title">sub_4009C6</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>  __int64 result; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+Ch] [rbp-114h]</span><br>  __int64 v2; <span class="hljs-comment">// [rsp+10h] [rbp-110h]</span><br>  __int64 v3; <span class="hljs-comment">// [rsp+18h] [rbp-108h]</span><br>  __int64 v4; <span class="hljs-comment">// [rsp+20h] [rbp-100h]</span><br>  __int64 v5; <span class="hljs-comment">// [rsp+28h] [rbp-F8h]</span><br>  __int64 v6; <span class="hljs-comment">// [rsp+30h] [rbp-F0h]</span><br>  __int64 v7; <span class="hljs-comment">// [rsp+38h] [rbp-E8h]</span><br>  __int64 v8; <span class="hljs-comment">// [rsp+40h] [rbp-E0h]</span><br>  __int64 v9; <span class="hljs-comment">// [rsp+48h] [rbp-D8h]</span><br>  __int64 v10; <span class="hljs-comment">// [rsp+50h] [rbp-D0h]</span><br>  __int64 v11; <span class="hljs-comment">// [rsp+58h] [rbp-C8h]</span><br>  <span class="hljs-type">char</span> v12[<span class="hljs-number">13</span>]; <span class="hljs-comment">// [rsp+60h] [rbp-C0h] BYREF</span><br>  <span class="hljs-type">char</span> v13[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+6Dh] [rbp-B3h] BYREF</span><br>  <span class="hljs-type">char</span> v14[<span class="hljs-number">19</span>]; <span class="hljs-comment">// [rsp+71h] [rbp-AFh] BYREF</span><br>  <span class="hljs-type">char</span> v15[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+90h] [rbp-90h] BYREF</span><br>  <span class="hljs-type">int</span> v16; <span class="hljs-comment">// [rsp+B0h] [rbp-70h]</span><br>  <span class="hljs-type">char</span> v17; <span class="hljs-comment">// [rsp+B4h] [rbp-6Ch]</span><br>  <span class="hljs-type">char</span> v18[<span class="hljs-number">72</span>]; <span class="hljs-comment">// [rsp+C0h] [rbp-60h] BYREF</span><br>  <span class="hljs-type">unsigned</span> __int64 v19; <span class="hljs-comment">// [rsp+108h] [rbp-18h]</span><br><br>  v19 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>  <span class="hljs-built_in">qmemcpy</span>(v12, <span class="hljs-string">&quot;Iodl&gt;Qnb(ocy&quot;</span>, <span class="hljs-number">12</span>);<br>  v12[<span class="hljs-number">12</span>] = <span class="hljs-number">127</span>;<br>  <span class="hljs-built_in">qmemcpy</span>(v13, <span class="hljs-string">&quot;y.i&quot;</span>, <span class="hljs-number">3</span>);<br>  v13[<span class="hljs-number">3</span>] = <span class="hljs-number">127</span>;<br>  <span class="hljs-built_in">qmemcpy</span>(v14, <span class="hljs-string">&quot;d`3w&#125;wek9&#123;iy=~yL@EC&quot;</span>, <span class="hljs-built_in">sizeof</span>(v14));<br>  <span class="hljs-built_in">memset</span>(v15, <span class="hljs-number">0</span>, <span class="hljs-built_in">sizeof</span>(v15));<br>  v16 = <span class="hljs-number">0</span>;<br>  v17 = <span class="hljs-number">0</span>;<br>  <span class="hljs-built_in">sub_4406E0</span>(<span class="hljs-number">0</span>, v15, <span class="hljs-number">37LL</span>);<br>  v17 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">if</span> ( (sub_424BA0)(v15) == <span class="hljs-number">36</span> )<br>  &#123;<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; (sub_424BA0)(v15); ++i )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( (v15[i] ^ i) != v12[i] )<br>      &#123;<br>        result = <span class="hljs-number">4294967294LL</span>;<br>        <span class="hljs-keyword">goto</span> LABEL_13;<br>      &#125;<br>    &#125;<br>    <span class="hljs-built_in">sub_410CC0</span>(<span class="hljs-string">&quot;continue!&quot;</span>);<br>    <span class="hljs-built_in">memset</span>(v18, <span class="hljs-number">0</span>, <span class="hljs-number">65</span>);<br>    <span class="hljs-built_in">sub_4406E0</span>(<span class="hljs-number">0</span>, v18, <span class="hljs-number">64LL</span>);<br>    v18[<span class="hljs-number">39</span>] = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span> ( (sub_424BA0)(v18) == <span class="hljs-number">39</span> )<br>    &#123;<br>      v2 = <span class="hljs-built_in">sub_400E44</span>(v18);<br>      v3 = <span class="hljs-built_in">sub_400E44</span>(v2);<br>      v4 = <span class="hljs-built_in">sub_400E44</span>(v3);<br>      v5 = <span class="hljs-built_in">sub_400E44</span>(v4);<br>      v6 = <span class="hljs-built_in">sub_400E44</span>(v5);<br>      v7 = <span class="hljs-built_in">sub_400E44</span>(v6);<br>      v8 = <span class="hljs-built_in">sub_400E44</span>(v7);<br>      v9 = <span class="hljs-built_in">sub_400E44</span>(v8);<br>      v10 = <span class="hljs-built_in">sub_400E44</span>(v9);<br>      v11 = <span class="hljs-built_in">sub_400E44</span>(v10);<br>      <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">sub_400360</span>(v11, off_6CC090) )<br>      &#123;<br>        <span class="hljs-built_in">sub_410CC0</span>(<span class="hljs-string">&quot;You found me!!!&quot;</span>);<br>        <span class="hljs-built_in">sub_410CC0</span>(<span class="hljs-string">&quot;bye bye~&quot;</span>);<br>      &#125;<br>      result = <span class="hljs-number">0LL</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      result = <span class="hljs-number">4294967293LL</span>;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    result = <span class="hljs-number">0xFFFFFFFF</span>LL;<br>  &#125;<br>LABEL_13:<br>  <span class="hljs-keyword">if</span> ( __readfsqword(<span class="hljs-number">0x28</span>u) != v19 )<br>    <span class="hljs-built_in">sub_444020</span>();<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>v15存输入的内容，第一段就是将输入异或下标后与已知的v12数组比较（ida分析错了，v12，v13，v14应该是一个数组，地址连在一起的）</p>
<p>脚本解密：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">arr = [<span class="hljs-number">73</span>,<span class="hljs-number">111</span>,<span class="hljs-number">100</span>,<span class="hljs-number">108</span>,<span class="hljs-number">62</span>,<span class="hljs-number">81</span>,<span class="hljs-number">110</span>,<span class="hljs-number">98</span>,<span class="hljs-number">40</span>,<span class="hljs-number">111</span>,<span class="hljs-number">99</span>,<span class="hljs-number">121</span>,<span class="hljs-number">127</span>,<span class="hljs-number">121</span>,<span class="hljs-number">46</span>,<span class="hljs-number">105</span>,<span class="hljs-number">127</span>,<span class="hljs-number">100</span>,<span class="hljs-number">96</span>,<span class="hljs-number">51</span>,<span class="hljs-number">119</span>,<span class="hljs-number">125</span>,<br>       <span class="hljs-number">119</span>,<span class="hljs-number">101</span>,<span class="hljs-number">107</span>,<span class="hljs-number">57</span>,<span class="hljs-number">123</span>,<span class="hljs-number">105</span>,<span class="hljs-number">121</span>,<span class="hljs-number">61</span>,<span class="hljs-number">126</span>,<span class="hljs-number">121</span>,<span class="hljs-number">76</span>,<span class="hljs-number">64</span>,<span class="hljs-number">69</span>,<span class="hljs-number">67</span>]<br><br>dec = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">36</span>):<br>    dec += <span class="hljs-built_in">chr</span>(arr[i]^i)<br><br><span class="hljs-built_in">print</span>(dec)<br><br><span class="hljs-comment">#Info:The first four chars are flag``</span><br></code></pre></td></tr></table></figure>

<p>第二次输入，进行了10次base64加密，解密即可：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">enc = <span class="hljs-string">&quot;Vm0wd2VHUXhTWGhpUm1SWVYwZDRWVll3Wkc5WFJsbDNXa1pPVlUxV2NIcFhhMk0xVmpKS1NHVkdXbFpOYmtKVVZtcEtTMUl5VGtsaVJtUk9ZV3hhZVZadGVHdFRNVTVYVW01T2FGSnRVbGhhVjNoaFZWWmtWMXBFVWxSTmJFcElWbTAxVDJGV1NuTlhia0pXWWxob1dGUnJXbXRXTVZaeVdrWm9hVlpyV1hwV1IzaGhXVmRHVjFOdVVsWmlhMHBZV1ZSR1lWZEdVbFZTYlhSWFRWWndNRlZ0TVc5VWJGcFZWbXR3VjJKSFVYZFdha1pXWlZaT2NtRkhhRk5pVjJoWVYxZDBhMVV3TlhOalJscFlZbGhTY1ZsclduZGxiR1J5VmxSR1ZXSlZjRWhaTUZKaFZqSktWVkZZYUZkV1JWcFlWV3BHYTFkWFRrZFRiV3hvVFVoQ1dsWXhaRFJpTWtsM1RVaG9hbEpYYUhOVmJUVkRZekZhY1ZKcmRGTk5Wa3A2VjJ0U1ExWlhTbFpqUldoYVRVWndkbFpxUmtwbGJVWklZVVprYUdFeGNHOVhXSEJIWkRGS2RGSnJhR2hTYXpWdlZGVm9RMlJzV25STldHUlZUVlpXTlZadE5VOVdiVXBJVld4c1dtSllUWGhXTUZwell6RmFkRkpzVWxOaVNFSktWa1phVTFFeFduUlRhMlJxVWxad1YxWnRlRXRXTVZaSFVsUnNVVlZVTURrPQ==&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    enc = enc.decode(<span class="hljs-string">&#x27;base64&#x27;</span>)<br><span class="hljs-built_in">print</span> (enc)<br></code></pre></td></tr></table></figure>

<p>接下来又是两段异或，第一段可以通过已知的flag反向解出v5，第二段异或根据已知数组和v5异或解出flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">key = <span class="hljs-string">&#x27;&#x27;</span><br>enc1 = <span class="hljs-string">&#x27;flag&#x27;</span><br>dec = <span class="hljs-string">&#x27;&#x27;</span><br>enc = [<span class="hljs-number">0x40</span>,<span class="hljs-number">0x35</span>,<span class="hljs-number">0x20</span>,<span class="hljs-number">0x56</span>,<span class="hljs-number">0x5D</span>,<span class="hljs-number">0x18</span>,<span class="hljs-number">0x22</span>,<span class="hljs-number">0x45</span>,<span class="hljs-number">0x17</span>,<span class="hljs-number">0x2F</span>,<span class="hljs-number">0x24</span>,<span class="hljs-number">0x6E</span>,<span class="hljs-number">0x62</span>,<span class="hljs-number">0x3C</span>,<span class="hljs-number">0x27</span>,<span class="hljs-number">0x54</span>,<span class="hljs-number">0x48</span>,<span class="hljs-number">0x6C</span>,<span class="hljs-number">0x24</span>,<span class="hljs-number">0x6E</span>,<span class="hljs-number">0x72</span>,<span class="hljs-number">0x3C</span>,<span class="hljs-number">0x32</span>,<span class="hljs-number">0x45</span>,<span class="hljs-number">0x5B</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>    key += <span class="hljs-built_in">chr</span>(enc[i] ^ <span class="hljs-built_in">ord</span>(enc1[i]))<br><span class="hljs-built_in">print</span> (key)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    dec += <span class="hljs-built_in">chr</span>(enc[i] ^ <span class="hljs-built_in">ord</span>(key[i%<span class="hljs-number">4</span>]))<br><span class="hljs-built_in">print</span>(dec)<br><br><span class="hljs-comment">#flag&#123;Act1ve_Defen5e_Test&#125;</span><br></code></pre></td></tr></table></figure>

<h3 id="5-5"><a href="#5-5" class="headerlink" title="5.5"></a>5.5</h3><h4 id="CISCN-2022-东北-easycpp"><a href="#CISCN-2022-东北-easycpp" class="headerlink" title="[CISCN 2022 东北]easycpp"></a>[CISCN 2022 东北]easycpp</h4><p>今年的全国大学生信息安全竞赛快开了，做做往年的题</p>
<p>这个应该是一个签到</p>
<p>主程序逻辑非常简单，直接上脚本：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> miwen[] =<br>&#123;<br>  <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x60</span>,<br>  <span class="hljs-number">0x37</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x3C</span>,<br>  <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x62</span>,<br>  <span class="hljs-number">0x65</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x7D</span><br>&#125;;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">37</span>; i &gt;=<span class="hljs-number">3</span>; i--)<br>	&#123;<br>		miwen[i<span class="hljs-number">-1</span>] ^= miwen[i];<br>		miwen[i<span class="hljs-number">-2</span>] ^= miwen[i<span class="hljs-number">-1</span>];<br>		miwen[i<span class="hljs-number">-3</span>] ^= miwen[i<span class="hljs-number">-2</span>];<br>	&#125;<br>	<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">38</span>; i++)<br>	&#123;<br>		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, miwen[i]);<br>	&#125;<br>	<span class="hljs-keyword">return</span>  <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="AnCTFxD-3CTF：d3sky"><a href="#AnCTFxD-3CTF：d3sky" class="headerlink" title="AnCTFxD^3CTF：d3sky"></a>AnCTFxD^3CTF：d3sky</h4><p>还是没看汇编的习惯，人家悄悄把密钥变了都没发现</p>
<p>首先是一个tls反调试，修改标志位跳过，接着就不能看f5的伪代码了，看汇编：</p>
<p><img src="https://raw.githubusercontent.com/shimmer123456/img/main/img/202305051929942.png" alt="image-20230505192948632"></p>
<p>可以看到有try，except的代码，说明<strong>程序通过异常来控制执行流程</strong>，其中就有一个除零异常，但是按理来说动调时候应该是会触发的，但是没有（这里我还没有完全看明白，大概猜测还是与在调试的状态有关），那么先假设他触发了除零异常了，接下来就会跳转到loc_6310EF那里继续执行，在密钥后面又加上了一个字符串（这才是真正的密钥）。利用这个密钥初始化了s盒。</p>
<p>接下来是一个虚拟机还没分析，明天把这里补起来，今天有点事</p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages" style="justify-content: flex-end"><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2023/04/26/HDCTF/">HDCTF  逆向wp Prev →</a></div></div></div><div id="Valine"></div></div><div id="bottom-btn"><a id="to-index" href="#toc-div" title="INDEX">≡</a><a id="to-top" onClick="scrolls.scrolltop();" title="to top" style="opacity: 0; display: none;">∧</a></div></article><aside><div id="aside-top"><div id="about"><a href="/" id="logo"><img src="https://raw.githubusercontent.com/shimmer123456/img/main/img/touxiang.png" alt="Logo"></a><h1 id="Dr"><a href="/">shimmer</a></h1><div id="description"><p>一</p><p>些</p><p>小</p><p>笔</p><p>记</p><p>或</p><p>是</p><p>小</p><p>感</p><p>悟</p></div></div><div id="aside-block"><div id="toc-div"><h1>INDEX</h1><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3"><span class="toc-number">1.</span> <span class="toc-text">5.3</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#xctf%EF%BC%9A%E6%B5%81%E6%B5%AA%E8%80%85"><span class="toc-number">1.1.</span> <span class="toc-text">xctf：流浪者</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#re2-cpp-is-awesome"><span class="toc-number">1.2.</span> <span class="toc-text">re2-cpp-is-awesome</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4"><span class="toc-number">2.</span> <span class="toc-text">5.4</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#whats-the-hell-500"><span class="toc-number">2.1.</span> <span class="toc-text">whats-the-hell-500</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#easyRE"><span class="toc-number">2.2.</span> <span class="toc-text">easyRE</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5"><span class="toc-number">3.</span> <span class="toc-text">5.5</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CISCN-2022-%E4%B8%9C%E5%8C%97-easycpp"><span class="toc-number">3.1.</span> <span class="toc-text">[CISCN 2022 东北]easycpp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AnCTFxD-3CTF%EF%BC%9Ad3sky"><span class="toc-number">3.2.</span> <span class="toc-text">AnCTFxD^3CTF：d3sky</span></a></li></ol></li></ol></div></div></div><footer><nobr>published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknight</a></nobr><wbr><nobr>by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script class="pjax-js">reset=_=>{new Valine({
 el: '#Valine'
 , appId: 'fvW1eWgLvTdXfECCW1Bu9g6J-gzGzoHsz'
 , appKey: 'stD8FmxHNFFxhkzXholoBHdq' , placeholder: '此条评论委托企鹅物流发送'
});code.findCode();mermaid.init(undefined, ('.mermaid'));}</script><script src="/js/arknights.js"></script><script>window.addEventListener("load",()=>{reset()})</script></body></html>